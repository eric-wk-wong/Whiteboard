{"ast":null,"code":"import { createInstance, isUndefined, merge, extend, getValue } from './util';\n/**\n * Returns the Class Object\n * @param {ClassObject} instance - instance of ClassObject\n * @param {string} curKey - key of the current instance\n * @param {Object} defaultValue - default Value\n * @param {Object[]} type\n */\n\nfunction getObject(instance, curKey, defaultValue, type) {\n  if (!instance.properties.hasOwnProperty(curKey) || !(instance.properties[curKey] instanceof type)) {\n    instance.properties[curKey] = createInstance(type, [instance, curKey, defaultValue]);\n  }\n\n  return instance.properties[curKey];\n}\n/**\n * Returns object array\n * @param {ClassObject} instance\n * @param {string} curKey\n * @param {Object[]} defaultValue\n * @param type\n * @param {boolean} isSetter\n * @returns {Object[]}\n */\n\n\nfunction getObjectArray(instance, curKey, defaultValue, type, isSetter, isFactory) {\n  var result = [];\n  var len = defaultValue ? defaultValue.length : 0;\n\n  for (var i = 0; i < len; i++) {\n    var curType = type;\n\n    if (isFactory) {\n      curType = type(defaultValue[i], instance);\n    }\n\n    if (isSetter) {\n      var inst = createInstance(curType, [instance, curKey, {}, true]);\n      inst.setProperties(defaultValue[i], true);\n      result.push(inst);\n    } else {\n      result.push(createInstance(curType, [instance, curKey, defaultValue[i], false]));\n    }\n  }\n\n  return result;\n}\n/**\n * Returns the properties of the object\n * @param {Object} defaultValue\n * @param {string} curKey\n */\n\n\nfunction propertyGetter(defaultValue, curKey) {\n  return function () {\n    if (!this.properties.hasOwnProperty(curKey)) {\n      this.properties[curKey] = defaultValue;\n    }\n\n    return this.properties[curKey];\n  };\n}\n/**\n * Set the properties for the object\n * @param {Object} defaultValue\n * @param {string} curKey\n */\n\n\nfunction propertySetter(defaultValue, curKey) {\n  return function (newValue) {\n    if (this.properties[curKey] !== newValue) {\n      var oldVal = this.properties.hasOwnProperty(curKey) ? this.properties[curKey] : defaultValue;\n      this.saveChanges(curKey, newValue, oldVal);\n      this.properties[curKey] = newValue;\n    }\n  };\n}\n/**\n * Returns complex objects\n */\n\n\nfunction complexGetter(defaultValue, curKey, type) {\n  return function () {\n    return getObject(this, curKey, defaultValue, type);\n  };\n}\n/**\n * Sets complex objects\n */\n\n\nfunction complexSetter(defaultValue, curKey, type) {\n  return function (newValue) {\n    getObject(this, curKey, defaultValue, type).setProperties(newValue);\n  };\n}\n\nfunction complexFactoryGetter(defaultValue, curKey, type) {\n  return function () {\n    var curType = type({});\n\n    if (this.properties.hasOwnProperty(curKey)) {\n      return this.properties[curKey];\n    } else {\n      return getObject(this, curKey, defaultValue, curType);\n    }\n  };\n}\n\nfunction complexFactorySetter(defaultValue, curKey, type) {\n  return function (newValue) {\n    var curType = type(newValue, this);\n    getObject(this, curKey, defaultValue, curType).setProperties(newValue);\n  };\n}\n\nfunction complexArrayGetter(defaultValue, curKey, type) {\n  return function () {\n    var _this = this;\n\n    if (!this.properties.hasOwnProperty(curKey)) {\n      var defCollection = getObjectArray(this, curKey, defaultValue, type, false);\n      this.properties[curKey] = defCollection;\n    }\n\n    var ignore = this.controlParent !== undefined && this.controlParent.ignoreCollectionWatch || this.ignoreCollectionWatch;\n\n    if (!this.properties[curKey].hasOwnProperty('push') && !ignore) {\n      ['push', 'pop'].forEach(function (extendFunc) {\n        var descriptor = {\n          value: complexArrayDefinedCallback(extendFunc, curKey, type, _this.properties[curKey]).bind(_this),\n          configurable: true\n        };\n        Object.defineProperty(_this.properties[curKey], extendFunc, descriptor);\n      });\n    }\n\n    if (!this.properties[curKey].hasOwnProperty('isComplexArray')) {\n      Object.defineProperty(this.properties[curKey], 'isComplexArray', {\n        value: true\n      });\n    }\n\n    return this.properties[curKey];\n  };\n}\n\nfunction complexArraySetter(defaultValue, curKey, type) {\n  return function (newValue) {\n    this.isComplexArraySetter = true;\n    var oldValueCollection = getObjectArray(this, curKey, defaultValue, type, false);\n    var newValCollection = getObjectArray(this, curKey, newValue, type, true);\n    this.isComplexArraySetter = false;\n    this.saveChanges(curKey, newValCollection, oldValueCollection);\n    this.properties[curKey] = newValCollection;\n  };\n}\n\nfunction complexArrayFactorySetter(defaultValue, curKey, type) {\n  return function (newValue) {\n    var oldValueCollection = this.properties.hasOwnProperty(curKey) ? this.properties[curKey] : defaultValue;\n    var newValCollection = getObjectArray(this, curKey, newValue, type, true, true);\n    this.saveChanges(curKey, newValCollection, oldValueCollection);\n    this.properties[curKey] = newValCollection;\n  };\n}\n\nfunction complexArrayFactoryGetter(defaultValue, curKey, type) {\n  return function () {\n    var curType = type({});\n\n    if (!this.properties.hasOwnProperty(curKey)) {\n      var defCollection = getObjectArray(this, curKey, defaultValue, curType, false);\n      this.properties[curKey] = defCollection;\n    }\n\n    return this.properties[curKey];\n  };\n}\n\nfunction complexArrayDefinedCallback(dFunc, curKey, type, prop) {\n  /* tslint:disable no-function-expression */\n  return function () {\n    var newValue = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      newValue[_i] = arguments[_i];\n    }\n\n    var keyString = this.propName ? this.getParentKey() + '.' + curKey + '-' : curKey + '-';\n\n    switch (dFunc) {\n      case 'push':\n        for (var i = 0; i < newValue.length; i++) {\n          Array.prototype[dFunc].apply(prop, [newValue[i]]);\n          var model_1 = getArrayModel(keyString + (prop.length - 1), newValue[i], !this.controlParent, dFunc);\n          this.serverDataBind(model_1, newValue[i], false, dFunc);\n        }\n\n        break;\n\n      case 'pop':\n        Array.prototype[dFunc].apply(prop);\n        var model = getArrayModel(keyString + prop.length, null, !this.controlParent, dFunc);\n        this.serverDataBind(model, {\n          ejsAction: 'pop'\n        }, false, dFunc);\n        break;\n    }\n\n    return prop;\n  };\n  /* tslint:enable no-function-expression */\n}\n\nfunction getArrayModel(keyString, value, isControlParent, arrayFunction) {\n  var modelObject = keyString;\n\n  if (isControlParent) {\n    modelObject = {};\n    modelObject[keyString] = value;\n\n    if (value && typeof value === 'object') {\n      var action = 'ejsAction';\n      modelObject[keyString][action] = arrayFunction;\n    }\n  }\n\n  return modelObject;\n}\n/**\n * Method used to create property. General syntax below.\n * @param  {T} defaultValue? - Specifies the default value of property.\n * ```\n * @Property('TypeScript')\n * propertyName: Type;\n * ```\n * @private\n */\n\n\nexport function Property(defaultValue) {\n  return function (target, key) {\n    var propertyDescriptor = {\n      set: propertySetter(defaultValue, key),\n      get: propertyGetter(defaultValue, key),\n      enumerable: true,\n      configurable: true\n    }; //new property creation\n\n    Object.defineProperty(target, key, propertyDescriptor);\n    addPropertyCollection(target, key, 'prop', defaultValue);\n  };\n}\n/**\n * Method used to create complex property. General syntax below.\n * @param  {T} defaultValue - Specifies the default value of property.\n * @param  {Function} type - Specifies the class type of complex object.\n * ```\n * @Complex<Type>({},Type)\n * propertyName: Type;\n * ```\n * @private\n */\n\nexport function Complex(defaultValue, type) {\n  return function (target, key) {\n    var propertyDescriptor = {\n      set: complexSetter(defaultValue, key, type),\n      get: complexGetter(defaultValue, key, type),\n      enumerable: true,\n      configurable: true\n    }; //new property creation\n\n    Object.defineProperty(target, key, propertyDescriptor);\n    addPropertyCollection(target, key, 'complexProp', defaultValue, type);\n  };\n}\n/**\n * Method used to create complex Factory property. General syntax below.\n * @param  {Function} defaultType - Specifies the default value of property.\n * @param  {Function} type - Specifies the class factory type of complex object.\n * ```\n * @ComplexFactory(defaultType, factoryFunction)\n * propertyName: Type1 | Type2;\n * ```\n * @private\n */\n\nexport function ComplexFactory(type) {\n  return function (target, key) {\n    var propertyDescriptor = {\n      set: complexFactorySetter({}, key, type),\n      get: complexFactoryGetter({}, key, type),\n      enumerable: true,\n      configurable: true\n    }; //new property creation\n\n    Object.defineProperty(target, key, propertyDescriptor);\n    addPropertyCollection(target, key, 'complexProp', {}, type);\n  };\n}\n/**\n * Method used to create complex array property. General syntax below.\n * @param  {T[]} defaultValue - Specifies the default value of property.\n * @param  {Function} type - Specifies the class type of complex object.\n * ```\n * @Collection([], Type);\n * propertyName: Type;\n * ```\n * @private\n */\n\nexport function Collection(defaultValue, type) {\n  return function (target, key) {\n    var propertyDescriptor = {\n      set: complexArraySetter(defaultValue, key, type),\n      get: complexArrayGetter(defaultValue, key, type),\n      enumerable: true,\n      configurable: true\n    }; //new property creation\n\n    Object.defineProperty(target, key, propertyDescriptor);\n    addPropertyCollection(target, key, 'colProp', defaultValue, type);\n  };\n}\n/**\n * Method used to create complex factory array property. General syntax below.\n * @param  {T[]} defaultType - Specifies the default type of property.\n * @param  {Function} type - Specifies the class type of complex object.\n * ```\n * @Collection([], Type);\n * propertyName: Type;\n * ```\n * @private\n */\n\nexport function CollectionFactory(type) {\n  return function (target, key) {\n    var propertyDescriptor = {\n      set: complexArrayFactorySetter([], key, type),\n      get: complexArrayFactoryGetter([], key, type),\n      enumerable: true,\n      configurable: true\n    }; //new property creation\n\n    Object.defineProperty(target, key, propertyDescriptor);\n    addPropertyCollection(target, key, 'colProp', {}, type);\n  };\n}\n/**\n * Method used to create event property. General syntax below.\n * @param  {Function} defaultValue? - Specifies the default value of property.\n * @param  {boolean} isComplex? - Specifies the whether it is complex object.\n * ```\n * @Event(()=>{return true;})\n * ```\n * @private\n */\n\nexport function Event() {\n  return function (target, key) {\n    var eventDescriptor = {\n      set: function (newValue) {\n        var oldValue = this.properties[key];\n\n        if (oldValue !== newValue) {\n          var finalContext = getParentContext(this, key);\n\n          if (isUndefined(oldValue) === false) {\n            finalContext.context.removeEventListener(finalContext.prefix, oldValue);\n          }\n\n          finalContext.context.addEventListener(finalContext.prefix, newValue);\n          this.properties[key] = newValue;\n        }\n      },\n      get: propertyGetter(undefined, key),\n      enumerable: true,\n      configurable: true\n    };\n    Object.defineProperty(target, key, eventDescriptor);\n    addPropertyCollection(target, key, 'event');\n  };\n}\n/**\n * NotifyPropertyChanges is triggers the call back when the property has been changed.\n *\n * ```\n *  @NotifyPropertyChanges\n * class DemoClass implements INotifyPropertyChanged {\n *\n *     @Property()\n *     property1: string;\n *\n *     dataBind: () => void;\n *\n *     constructor() { }\n *\n *     onPropertyChanged(newProp: any, oldProp: any) {\n *         // Called when property changed\n *     }\n * }\n * ```\n * @private\n */\n\nexport function NotifyPropertyChanges(classConstructor) {}\n/** Need to code */\n\n/**\n * Method  used to create the builderObject for the target component.\n * @private\n */\n\nfunction addPropertyCollection(target, key, propertyType, defaultValue, type) {\n  if (isUndefined(target.propList)) {\n    target.propList = {\n      props: [],\n      complexProps: [],\n      colProps: [],\n      events: [],\n      propNames: [],\n      complexPropNames: [],\n      colPropNames: [],\n      eventNames: []\n    };\n  }\n  /* tslint:disable no-any */\n\n\n  target.propList[propertyType + 's'].push({\n    propertyName: key,\n    defaultValue: defaultValue,\n    type: type\n  });\n  target.propList[propertyType + 'Names'].push(key);\n  /* tslint:enable no-any */\n}\n/**\n * Returns an object containing the builder properties\n * @param {Function} component\n * @private\n */\n\n\nfunction getBuilderProperties(component) {\n  if (isUndefined(component.prototype.builderObject)) {\n    component.prototype.builderObject = {\n      properties: {},\n      propCollections: [],\n      add: function () {\n        this.isPropertyArray = true;\n        this.propCollections.push(extend({}, this.properties, {}));\n      }\n    };\n    var rex = /complex/;\n\n    for (var _i = 0, _a = Object.keys(component.prototype.propList); _i < _a.length; _i++) {\n      var key = _a[_i];\n\n      var _loop_1 = function (prop) {\n        if (rex.test(key)) {\n          component.prototype.builderObject[prop.propertyName] = function (value) {\n            var childType = {};\n            merge(childType, getBuilderProperties(prop.type));\n            value(childType);\n            var tempValue;\n\n            if (!childType.isPropertyArray) {\n              tempValue = extend({}, childType.properties, {});\n            } else {\n              tempValue = childType.propCollections;\n            }\n\n            this.properties[prop.propertyName] = tempValue;\n            childType.properties = {};\n            childType.propCollections = [];\n            childType.isPropertyArray = false;\n            return this;\n          };\n        } else {\n          component.prototype.builderObject[prop.propertyName] = function (value) {\n            this.properties[prop.propertyName] = value;\n            return this;\n          };\n        }\n      };\n\n      for (var _b = 0, _c = component.prototype.propList[key]; _b < _c.length; _b++) {\n        var prop = _c[_b];\n\n        _loop_1(prop);\n      }\n    }\n  }\n\n  return component.prototype.builderObject;\n}\n/**\n * Method used to create builder for the components\n * @param {any} component -specifies the target component for which builder to be created.\n * @private\n */\n\n\nexport function CreateBuilder(component) {\n  var builderFunction = function (element) {\n    this.element = element;\n    return this;\n  };\n\n  var instanceFunction = function (element) {\n    if (!builderFunction.prototype.hasOwnProperty('create')) {\n      builderFunction.prototype = getBuilderProperties(component);\n\n      builderFunction.prototype.create = function () {\n        var temp = extend({}, {}, this.properties);\n        this.properties = {};\n        return new component(temp, this.element);\n      };\n    }\n\n    return new builderFunction(element);\n  };\n\n  return instanceFunction;\n}\n/**\n * Returns parent options for the object\n * @param {Object} context\n * @param {string} prefix\n * @private\n */\n\nfunction getParentContext(context, prefix) {\n  if (context.hasOwnProperty('parentObj') === false) {\n    return {\n      context: context,\n      prefix: prefix\n    };\n  } else {\n    var curText = getValue('propName', context);\n\n    if (curText) {\n      prefix = curText + '-' + prefix;\n    }\n\n    return getParentContext(getValue('parentObj', context), prefix);\n  }\n}","map":{"version":3,"sources":["/Users/ewong/Development/Whiteboard/node_modules/@syncfusion/ej2-base/src/notify-property-change.js"],"names":["createInstance","isUndefined","merge","extend","getValue","getObject","instance","curKey","defaultValue","type","properties","hasOwnProperty","getObjectArray","isSetter","isFactory","result","len","length","i","curType","inst","setProperties","push","propertyGetter","propertySetter","newValue","oldVal","saveChanges","complexGetter","complexSetter","complexFactoryGetter","complexFactorySetter","complexArrayGetter","_this","defCollection","ignore","controlParent","undefined","ignoreCollectionWatch","forEach","extendFunc","descriptor","value","complexArrayDefinedCallback","bind","configurable","Object","defineProperty","complexArraySetter","isComplexArraySetter","oldValueCollection","newValCollection","complexArrayFactorySetter","complexArrayFactoryGetter","dFunc","prop","_i","arguments","keyString","propName","getParentKey","Array","prototype","apply","model_1","getArrayModel","serverDataBind","model","ejsAction","isControlParent","arrayFunction","modelObject","action","Property","target","key","propertyDescriptor","set","get","enumerable","addPropertyCollection","Complex","ComplexFactory","Collection","CollectionFactory","Event","eventDescriptor","oldValue","finalContext","getParentContext","context","removeEventListener","prefix","addEventListener","NotifyPropertyChanges","classConstructor","propertyType","propList","props","complexProps","colProps","events","propNames","complexPropNames","colPropNames","eventNames","propertyName","getBuilderProperties","component","builderObject","propCollections","add","isPropertyArray","rex","_a","keys","_loop_1","test","childType","tempValue","_b","_c","CreateBuilder","builderFunction","element","instanceFunction","create","temp","curText"],"mappings":"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","sourcesContent":["import { createInstance, isUndefined, merge, extend, getValue } from './util';\n/**\n * Returns the Class Object\n * @param {ClassObject} instance - instance of ClassObject\n * @param {string} curKey - key of the current instance\n * @param {Object} defaultValue - default Value\n * @param {Object[]} type\n */\nfunction getObject(instance, curKey, defaultValue, type) {\n    if (!instance.properties.hasOwnProperty(curKey) || !(instance.properties[curKey] instanceof type)) {\n        instance.properties[curKey] = createInstance(type, [instance, curKey, defaultValue]);\n    }\n    return instance.properties[curKey];\n}\n/**\n * Returns object array\n * @param {ClassObject} instance\n * @param {string} curKey\n * @param {Object[]} defaultValue\n * @param type\n * @param {boolean} isSetter\n * @returns {Object[]}\n */\nfunction getObjectArray(instance, curKey, defaultValue, type, isSetter, isFactory) {\n    var result = [];\n    var len = defaultValue ? defaultValue.length : 0;\n    for (var i = 0; i < len; i++) {\n        var curType = type;\n        if (isFactory) {\n            curType = type(defaultValue[i], instance);\n        }\n        if (isSetter) {\n            var inst = createInstance(curType, [instance, curKey, {}, true]);\n            inst.setProperties(defaultValue[i], true);\n            result.push(inst);\n        }\n        else {\n            result.push(createInstance(curType, [instance, curKey, defaultValue[i], false]));\n        }\n    }\n    return result;\n}\n/**\n * Returns the properties of the object\n * @param {Object} defaultValue\n * @param {string} curKey\n */\nfunction propertyGetter(defaultValue, curKey) {\n    return function () {\n        if (!this.properties.hasOwnProperty(curKey)) {\n            this.properties[curKey] = defaultValue;\n        }\n        return this.properties[curKey];\n    };\n}\n/**\n * Set the properties for the object\n * @param {Object} defaultValue\n * @param {string} curKey\n */\nfunction propertySetter(defaultValue, curKey) {\n    return function (newValue) {\n        if (this.properties[curKey] !== newValue) {\n            var oldVal = this.properties.hasOwnProperty(curKey) ? this.properties[curKey] : defaultValue;\n            this.saveChanges(curKey, newValue, oldVal);\n            this.properties[curKey] = newValue;\n        }\n    };\n}\n/**\n * Returns complex objects\n */\nfunction complexGetter(defaultValue, curKey, type) {\n    return function () {\n        return getObject(this, curKey, defaultValue, type);\n    };\n}\n/**\n * Sets complex objects\n */\nfunction complexSetter(defaultValue, curKey, type) {\n    return function (newValue) {\n        getObject(this, curKey, defaultValue, type).setProperties(newValue);\n    };\n}\nfunction complexFactoryGetter(defaultValue, curKey, type) {\n    return function () {\n        var curType = type({});\n        if (this.properties.hasOwnProperty(curKey)) {\n            return this.properties[curKey];\n        }\n        else {\n            return getObject(this, curKey, defaultValue, curType);\n        }\n    };\n}\nfunction complexFactorySetter(defaultValue, curKey, type) {\n    return function (newValue) {\n        var curType = type(newValue, this);\n        getObject(this, curKey, defaultValue, curType).setProperties(newValue);\n    };\n}\nfunction complexArrayGetter(defaultValue, curKey, type) {\n    return function () {\n        var _this = this;\n        if (!this.properties.hasOwnProperty(curKey)) {\n            var defCollection = getObjectArray(this, curKey, defaultValue, type, false);\n            this.properties[curKey] = defCollection;\n        }\n        var ignore = ((this.controlParent !== undefined && this.controlParent.ignoreCollectionWatch)\n            || this.ignoreCollectionWatch);\n        if (!this.properties[curKey].hasOwnProperty('push') && !ignore) {\n            ['push', 'pop'].forEach(function (extendFunc) {\n                var descriptor = {\n                    value: complexArrayDefinedCallback(extendFunc, curKey, type, _this.properties[curKey]).bind(_this),\n                    configurable: true\n                };\n                Object.defineProperty(_this.properties[curKey], extendFunc, descriptor);\n            });\n        }\n        if (!this.properties[curKey].hasOwnProperty('isComplexArray')) {\n            Object.defineProperty(this.properties[curKey], 'isComplexArray', { value: true });\n        }\n        return this.properties[curKey];\n    };\n}\nfunction complexArraySetter(defaultValue, curKey, type) {\n    return function (newValue) {\n        this.isComplexArraySetter = true;\n        var oldValueCollection = getObjectArray(this, curKey, defaultValue, type, false);\n        var newValCollection = getObjectArray(this, curKey, newValue, type, true);\n        this.isComplexArraySetter = false;\n        this.saveChanges(curKey, newValCollection, oldValueCollection);\n        this.properties[curKey] = newValCollection;\n    };\n}\nfunction complexArrayFactorySetter(defaultValue, curKey, type) {\n    return function (newValue) {\n        var oldValueCollection = this.properties.hasOwnProperty(curKey) ? this.properties[curKey] : defaultValue;\n        var newValCollection = getObjectArray(this, curKey, newValue, type, true, true);\n        this.saveChanges(curKey, newValCollection, oldValueCollection);\n        this.properties[curKey] = newValCollection;\n    };\n}\nfunction complexArrayFactoryGetter(defaultValue, curKey, type) {\n    return function () {\n        var curType = type({});\n        if (!this.properties.hasOwnProperty(curKey)) {\n            var defCollection = getObjectArray(this, curKey, defaultValue, curType, false);\n            this.properties[curKey] = defCollection;\n        }\n        return this.properties[curKey];\n    };\n}\nfunction complexArrayDefinedCallback(dFunc, curKey, type, prop) {\n    /* tslint:disable no-function-expression */\n    return function () {\n        var newValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            newValue[_i] = arguments[_i];\n        }\n        var keyString = this.propName ? this.getParentKey() + '.' + curKey + '-' : curKey + '-';\n        switch (dFunc) {\n            case 'push':\n                for (var i = 0; i < newValue.length; i++) {\n                    Array.prototype[dFunc].apply(prop, [newValue[i]]);\n                    var model_1 = getArrayModel(keyString + (prop.length - 1), newValue[i], !this.controlParent, dFunc);\n                    this.serverDataBind(model_1, newValue[i], false, dFunc);\n                }\n                break;\n            case 'pop':\n                Array.prototype[dFunc].apply(prop);\n                var model = getArrayModel(keyString + prop.length, null, !this.controlParent, dFunc);\n                this.serverDataBind(model, { ejsAction: 'pop' }, false, dFunc);\n                break;\n        }\n        return prop;\n    };\n    /* tslint:enable no-function-expression */\n}\nfunction getArrayModel(keyString, value, isControlParent, arrayFunction) {\n    var modelObject = keyString;\n    if (isControlParent) {\n        modelObject = {};\n        modelObject[keyString] = value;\n        if (value && typeof value === 'object') {\n            var action = 'ejsAction';\n            modelObject[keyString][action] = arrayFunction;\n        }\n    }\n    return modelObject;\n}\n/**\n * Method used to create property. General syntax below.\n * @param  {T} defaultValue? - Specifies the default value of property.\n * ```\n * @Property('TypeScript')\n * propertyName: Type;\n * ```\n * @private\n */\nexport function Property(defaultValue) {\n    return function (target, key) {\n        var propertyDescriptor = {\n            set: propertySetter(defaultValue, key),\n            get: propertyGetter(defaultValue, key),\n            enumerable: true,\n            configurable: true\n        };\n        //new property creation\n        Object.defineProperty(target, key, propertyDescriptor);\n        addPropertyCollection(target, key, 'prop', defaultValue);\n    };\n}\n/**\n * Method used to create complex property. General syntax below.\n * @param  {T} defaultValue - Specifies the default value of property.\n * @param  {Function} type - Specifies the class type of complex object.\n * ```\n * @Complex<Type>({},Type)\n * propertyName: Type;\n * ```\n * @private\n */\nexport function Complex(defaultValue, type) {\n    return function (target, key) {\n        var propertyDescriptor = {\n            set: complexSetter(defaultValue, key, type),\n            get: complexGetter(defaultValue, key, type),\n            enumerable: true,\n            configurable: true\n        };\n        //new property creation\n        Object.defineProperty(target, key, propertyDescriptor);\n        addPropertyCollection(target, key, 'complexProp', defaultValue, type);\n    };\n}\n/**\n * Method used to create complex Factory property. General syntax below.\n * @param  {Function} defaultType - Specifies the default value of property.\n * @param  {Function} type - Specifies the class factory type of complex object.\n * ```\n * @ComplexFactory(defaultType, factoryFunction)\n * propertyName: Type1 | Type2;\n * ```\n * @private\n */\nexport function ComplexFactory(type) {\n    return function (target, key) {\n        var propertyDescriptor = {\n            set: complexFactorySetter({}, key, type),\n            get: complexFactoryGetter({}, key, type),\n            enumerable: true,\n            configurable: true\n        };\n        //new property creation\n        Object.defineProperty(target, key, propertyDescriptor);\n        addPropertyCollection(target, key, 'complexProp', {}, type);\n    };\n}\n/**\n * Method used to create complex array property. General syntax below.\n * @param  {T[]} defaultValue - Specifies the default value of property.\n * @param  {Function} type - Specifies the class type of complex object.\n * ```\n * @Collection([], Type);\n * propertyName: Type;\n * ```\n * @private\n */\nexport function Collection(defaultValue, type) {\n    return function (target, key) {\n        var propertyDescriptor = {\n            set: complexArraySetter(defaultValue, key, type),\n            get: complexArrayGetter(defaultValue, key, type),\n            enumerable: true,\n            configurable: true\n        };\n        //new property creation\n        Object.defineProperty(target, key, propertyDescriptor);\n        addPropertyCollection(target, key, 'colProp', defaultValue, type);\n    };\n}\n/**\n * Method used to create complex factory array property. General syntax below.\n * @param  {T[]} defaultType - Specifies the default type of property.\n * @param  {Function} type - Specifies the class type of complex object.\n * ```\n * @Collection([], Type);\n * propertyName: Type;\n * ```\n * @private\n */\nexport function CollectionFactory(type) {\n    return function (target, key) {\n        var propertyDescriptor = {\n            set: complexArrayFactorySetter([], key, type),\n            get: complexArrayFactoryGetter([], key, type),\n            enumerable: true,\n            configurable: true\n        };\n        //new property creation\n        Object.defineProperty(target, key, propertyDescriptor);\n        addPropertyCollection(target, key, 'colProp', {}, type);\n    };\n}\n/**\n * Method used to create event property. General syntax below.\n * @param  {Function} defaultValue? - Specifies the default value of property.\n * @param  {boolean} isComplex? - Specifies the whether it is complex object.\n * ```\n * @Event(()=>{return true;})\n * ```\n * @private\n */\nexport function Event() {\n    return function (target, key) {\n        var eventDescriptor = {\n            set: function (newValue) {\n                var oldValue = this.properties[key];\n                if (oldValue !== newValue) {\n                    var finalContext = getParentContext(this, key);\n                    if (isUndefined(oldValue) === false) {\n                        finalContext.context.removeEventListener(finalContext.prefix, oldValue);\n                    }\n                    finalContext.context.addEventListener(finalContext.prefix, newValue);\n                    this.properties[key] = newValue;\n                }\n            },\n            get: propertyGetter(undefined, key),\n            enumerable: true,\n            configurable: true\n        };\n        Object.defineProperty(target, key, eventDescriptor);\n        addPropertyCollection(target, key, 'event');\n    };\n}\n/**\n * NotifyPropertyChanges is triggers the call back when the property has been changed.\n *\n * ```\n *  @NotifyPropertyChanges\n * class DemoClass implements INotifyPropertyChanged {\n *\n *     @Property()\n *     property1: string;\n *\n *     dataBind: () => void;\n *\n *     constructor() { }\n *\n *     onPropertyChanged(newProp: any, oldProp: any) {\n *         // Called when property changed\n *     }\n * }\n * ```\n * @private\n */\nexport function NotifyPropertyChanges(classConstructor) {\n    /** Need to code */\n}\n/**\n * Method  used to create the builderObject for the target component.\n * @private\n */\nfunction addPropertyCollection(target, key, propertyType, defaultValue, type) {\n    if (isUndefined(target.propList)) {\n        target.propList = {\n            props: [],\n            complexProps: [],\n            colProps: [],\n            events: [],\n            propNames: [],\n            complexPropNames: [],\n            colPropNames: [],\n            eventNames: []\n        };\n    }\n    /* tslint:disable no-any */\n    target.propList[propertyType + 's'].push({\n        propertyName: key,\n        defaultValue: defaultValue,\n        type: type\n    });\n    target.propList[propertyType + 'Names'].push(key);\n    /* tslint:enable no-any */\n}\n/**\n * Returns an object containing the builder properties\n * @param {Function} component\n * @private\n */\nfunction getBuilderProperties(component) {\n    if (isUndefined(component.prototype.builderObject)) {\n        component.prototype.builderObject = {\n            properties: {}, propCollections: [], add: function () {\n                this.isPropertyArray = true;\n                this.propCollections.push(extend({}, this.properties, {}));\n            }\n        };\n        var rex = /complex/;\n        for (var _i = 0, _a = Object.keys(component.prototype.propList); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var _loop_1 = function (prop) {\n                if (rex.test(key)) {\n                    component.prototype.builderObject[prop.propertyName] = function (value) {\n                        var childType = {};\n                        merge(childType, getBuilderProperties(prop.type));\n                        value(childType);\n                        var tempValue;\n                        if (!childType.isPropertyArray) {\n                            tempValue = extend({}, childType.properties, {});\n                        }\n                        else {\n                            tempValue = childType.propCollections;\n                        }\n                        this.properties[prop.propertyName] = tempValue;\n                        childType.properties = {};\n                        childType.propCollections = [];\n                        childType.isPropertyArray = false;\n                        return this;\n                    };\n                }\n                else {\n                    component.prototype.builderObject[prop.propertyName] = function (value) {\n                        this.properties[prop.propertyName] = value;\n                        return this;\n                    };\n                }\n            };\n            for (var _b = 0, _c = component.prototype.propList[key]; _b < _c.length; _b++) {\n                var prop = _c[_b];\n                _loop_1(prop);\n            }\n        }\n    }\n    return component.prototype.builderObject;\n}\n/**\n * Method used to create builder for the components\n * @param {any} component -specifies the target component for which builder to be created.\n * @private\n */\nexport function CreateBuilder(component) {\n    var builderFunction = function (element) {\n        this.element = element;\n        return this;\n    };\n    var instanceFunction = function (element) {\n        if (!builderFunction.prototype.hasOwnProperty('create')) {\n            builderFunction.prototype = getBuilderProperties(component);\n            builderFunction.prototype.create = function () {\n                var temp = extend({}, {}, this.properties);\n                this.properties = {};\n                return new component(temp, this.element);\n            };\n        }\n        return new builderFunction(element);\n    };\n    return instanceFunction;\n}\n/**\n * Returns parent options for the object\n * @param {Object} context\n * @param {string} prefix\n * @private\n */\nfunction getParentContext(context, prefix) {\n    if (context.hasOwnProperty('parentObj') === false) {\n        return { context: context, prefix: prefix };\n    }\n    else {\n        var curText = getValue('propName', context);\n        if (curText) {\n            prefix = curText + '-' + prefix;\n        }\n        return getParentContext(getValue('parentObj', context), prefix);\n    }\n}\n"]},"metadata":{},"sourceType":"module"}