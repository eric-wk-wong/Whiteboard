{"ast":null,"code":"import { closest, EventHandler, isNullOrUndefined, formatUnit, append, isBlazor } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, createElement, remove, extend, updateBlazorTemplate, resetBlazorTemplate } from '@syncfusion/ej2-base';\nimport { getElement } from '@syncfusion/ej2-base';\nimport { Dialog, Popup, isCollide } from '@syncfusion/ej2-popups';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { Input } from '@syncfusion/ej2-inputs';\nimport { FieldValidator } from './form-validator';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\nimport * as util from '../base/util';\nvar EVENT_FIELD = 'e-field';\n/**\n * Quick Popups interactions\n */\n\nvar QuickPopups =\n/** @class */\nfunction () {\n  /**\n   * Constructor for QuickPopups\n   */\n  function QuickPopups(parent) {\n    this.isMultipleEventSelect = false;\n    this.isCrudAction = false;\n    this.parent = parent;\n    this.l10n = this.parent.localeObj;\n    this.fieldValidator = new FieldValidator();\n    this.render();\n    this.addEventListener();\n  }\n\n  QuickPopups.prototype.render = function () {\n    this.renderQuickPopup();\n    this.renderMorePopup();\n    this.renderQuickDialog();\n  };\n\n  QuickPopups.prototype.renderQuickPopup = function () {\n    var quickPopupWrapper = createElement('div', {\n      className: cls.POPUP_WRAPPER_CLASS + ' e-popup-close'\n    });\n\n    if (this.parent.isAdaptive) {\n      document.body.appendChild(quickPopupWrapper);\n      addClass([quickPopupWrapper], cls.DEVICE_CLASS);\n    } else {\n      this.parent.element.appendChild(quickPopupWrapper);\n    }\n\n    this.quickPopup = new Popup(quickPopupWrapper, {\n      targetType: this.parent.isAdaptive ? 'container' : 'relative',\n      enableRtl: this.parent.enableRtl,\n      open: this.quickPopupOpen.bind(this),\n      close: this.quickPopupClose.bind(this),\n      hideAnimation: this.parent.isAdaptive ? {\n        name: 'ZoomOut'\n      } : {\n        name: 'FadeOut',\n        duration: 150\n      },\n      showAnimation: this.parent.isAdaptive ? {\n        name: 'ZoomIn'\n      } : {\n        name: 'FadeIn',\n        duration: 150\n      },\n      collision: this.parent.isAdaptive ? {\n        X: 'fit',\n        Y: 'fit'\n      } : this.parent.enableRtl ? {\n        X: 'flip',\n        Y: 'fit'\n      } : {\n        X: 'none',\n        Y: 'fit'\n      },\n      position: this.parent.isAdaptive || this.parent.enableRtl ? {\n        X: 'left',\n        Y: 'top'\n      } : {\n        X: 'right',\n        Y: 'top'\n      },\n      viewPortElement: this.parent.isAdaptive ? document.body : this.parent.element,\n      zIndex: this.parent.isAdaptive ? 1004 : 3\n    });\n    this.quickPopup.isStringTemplate = true;\n  };\n\n  QuickPopups.prototype.renderMorePopup = function () {\n    var moreEventPopup = \"<div class=\\\"\" + cls.MORE_EVENT_POPUP_CLASS + \"\\\"><div class=\\\"\" + cls.MORE_EVENT_HEADER_CLASS + \"\\\">\" + (\"<div class=\\\"\" + cls.MORE_EVENT_CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\" tabindex=\\\"0\\\"></div>\") + (\"<div class=\\\"\" + cls.MORE_EVENT_DATE_HEADER_CLASS + \"\\\"><div class=\\\"\" + cls.MORE_EVENT_HEADER_DAY_CLASS + \"\\\"></div>\") + (\"<div class=\\\"\" + cls.MORE_EVENT_HEADER_DATE_CLASS + \" \" + cls.NAVIGATE_CLASS + \"\\\" tabindex=\\\"0\\\"></div></div></div></div>\");\n    var moreEventWrapper = createElement('div', {\n      className: cls.MORE_POPUP_WRAPPER_CLASS + ' e-popup-close',\n      innerHTML: moreEventPopup\n    });\n\n    if (this.parent.isAdaptive) {\n      document.body.appendChild(moreEventWrapper);\n      addClass([moreEventWrapper], cls.DEVICE_CLASS);\n    } else {\n      this.parent.element.appendChild(moreEventWrapper);\n    }\n\n    this.morePopup = new Popup(moreEventWrapper, {\n      targetType: this.parent.isAdaptive ? 'container' : 'relative',\n      enableRtl: this.parent.enableRtl,\n      hideAnimation: {\n        name: 'ZoomOut',\n        duration: 300\n      },\n      showAnimation: {\n        name: 'ZoomIn',\n        duration: 300\n      },\n      open: this.morePopupOpen.bind(this),\n      close: this.morePopupClose.bind(this),\n      collision: this.parent.isAdaptive ? {\n        X: 'fit',\n        Y: 'fit'\n      } : this.parent.enableRtl ? {\n        X: 'flip',\n        Y: 'fit'\n      } : {\n        X: 'flip',\n        Y: 'flip'\n      },\n      viewPortElement: this.parent.isAdaptive ? document.body : this.parent.element,\n      zIndex: this.parent.isAdaptive ? 1002 : 2\n    });\n    this.morePopup.isStringTemplate = true;\n    var closeButton = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CLOSE_CLASS);\n    this.renderButton('e-round', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeButton, this.closeClick);\n    EventHandler.add(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS), 'click', this.navigationClick, this);\n  };\n\n  QuickPopups.prototype.renderQuickDialog = function () {\n    var buttonModel = [{\n      buttonModel: {\n        cssClass: 'e-quick-alertok e-flat',\n        isPrimary: true\n      },\n      click: this.dialogButtonClick.bind(this)\n    }, {\n      buttonModel: {\n        cssClass: 'e-quick-alertcancel e-flat',\n        isPrimary: false\n      },\n      click: this.dialogButtonClick.bind(this)\n    }, {\n      buttonModel: {\n        cssClass: 'e-quick-dialog-cancel e-disable e-flat',\n        isPrimary: false\n      },\n      click: this.dialogButtonClick.bind(this)\n    }];\n\n    if (this.parent.eventSettings.editFollowingEvents) {\n      var followingSeriesButton = {\n        buttonModel: {\n          cssClass: 'e-quick-alertfollowing e-flat',\n          isPrimary: false\n        },\n        click: this.dialogButtonClick.bind(this)\n      };\n      buttonModel.splice(1, 0, followingSeriesButton);\n    }\n\n    this.quickDialog = new Dialog({\n      animationSettings: {\n        effect: 'Zoom'\n      },\n      buttons: buttonModel,\n      cssClass: cls.QUICK_DIALOG_CLASS,\n      closeOnEscape: true,\n      enableRtl: this.parent.enableRtl,\n      beforeClose: this.beforeQuickDialogClose.bind(this),\n      isModal: true,\n      position: {\n        X: 'center',\n        Y: 'center'\n      },\n      showCloseIcon: true,\n      target: document.body,\n      visible: false,\n      width: 'auto'\n    });\n    var dialogElement = createElement('div', {\n      id: this.parent.element.id + 'QuickDialog'\n    });\n    this.parent.element.appendChild(dialogElement);\n    this.quickDialog.appendTo(dialogElement);\n    this.quickDialog.isStringTemplate = true;\n    var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n\n    if (okButton) {\n      okButton.setAttribute('aria-label', this.l10n.getConstant('occurrence'));\n      okButton.setAttribute('aria-label', okButton.innerHTML);\n    }\n\n    var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n\n    if (cancelButton) {\n      cancelButton.setAttribute('aria-label', this.l10n.getConstant('series'));\n      cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n    }\n\n    if (this.quickDialog.element.querySelector('.e-dlg-closeicon-btn')) {\n      this.quickDialog.element.querySelector('.e-dlg-closeicon-btn').setAttribute('title', this.l10n.getConstant('close'));\n    }\n  };\n\n  QuickPopups.prototype.renderButton = function (className, iconName, isDisabled, element, clickEvent) {\n    var buttonObj = new Button({\n      cssClass: className,\n      disabled: isDisabled,\n      enableRtl: this.parent.enableRtl,\n      iconCss: iconName\n    });\n    buttonObj.appendTo(element);\n    buttonObj.isStringTemplate = true;\n    EventHandler.add(element, 'click', clickEvent, this);\n  };\n\n  QuickPopups.prototype.quickDialogClass = function (action) {\n    var classList = [cls.QUICK_DIALOG_OCCURRENCE_CLASS, cls.QUICK_DIALOG_SERIES_CLASS, cls.QUICK_DIALOG_DELETE_CLASS, cls.QUICK_DIALOG_CANCEL_CLASS, cls.QUICK_DIALOG_ALERT_BTN_CLASS, cls.DISABLE_CLASS];\n    var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n    var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n    var followingEventButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n    removeClass([okButton, cancelButton], classList);\n    addClass([this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_CANCEL_CLASS)], cls.DISABLE_CLASS);\n\n    if (this.parent.eventSettings.editFollowingEvents) {\n      addClass([followingEventButton], cls.DISABLE_CLASS);\n      removeClass([this.quickDialog.element], cls.FOLLOWING_EVENTS_DIALOG);\n    }\n\n    switch (action) {\n      case 'Recurrence':\n        addClass([okButton], cls.QUICK_DIALOG_OCCURRENCE_CLASS);\n        addClass([cancelButton], cls.QUICK_DIALOG_SERIES_CLASS);\n\n        if (this.parent.eventSettings.editFollowingEvents) {\n          removeClass([followingEventButton], cls.DISABLE_CLASS);\n          addClass([this.quickDialog.element], cls.FOLLOWING_EVENTS_DIALOG);\n          addClass([followingEventButton], cls.QUICK_DIALOG_FOLLOWING_EVENTS_CLASS);\n        }\n\n        break;\n\n      case 'Delete':\n        addClass([okButton], cls.QUICK_DIALOG_DELETE_CLASS);\n        addClass([cancelButton], cls.QUICK_DIALOG_CANCEL_CLASS);\n        break;\n\n      case 'Alert':\n        addClass([okButton], [cls.QUICK_DIALOG_ALERT_OK, cls.QUICK_DIALOG_ALERT_BTN_CLASS]);\n        addClass([cancelButton], [cls.QUICK_DIALOG_ALERT_CANCEL, cls.DISABLE_CLASS]);\n        break;\n    }\n  };\n\n  QuickPopups.prototype.applyFormValidation = function () {\n    var form = this.quickPopup.element.querySelector('.' + cls.FORM_CLASS);\n    var rules = {};\n    rules[this.parent.eventSettings.fields.subject.name] = this.parent.eventSettings.fields.subject.validation;\n    this.fieldValidator.renderFormValidator(form, rules, this.quickPopup.element);\n  };\n\n  QuickPopups.prototype.openRecurrenceAlert = function () {\n    var editDeleteOnly = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n\n    if (editDeleteOnly) {\n      editDeleteOnly.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteEvent' : 'editEvent');\n      editDeleteOnly.setAttribute('aria-label', editDeleteOnly.innerHTML);\n    }\n\n    var editFollowingEventsOnly = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n\n    if (editFollowingEventsOnly) {\n      editFollowingEventsOnly.innerHTML = this.l10n.getConstant('editFollowingEvent');\n      editFollowingEventsOnly.setAttribute('aria-label', editFollowingEventsOnly.innerHTML);\n    }\n\n    var editDeleteSeries = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n\n    if (editDeleteSeries) {\n      editDeleteSeries.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteSeries' : 'editSeries');\n      editDeleteSeries.setAttribute('aria-label', editDeleteSeries.innerHTML);\n    }\n\n    this.quickDialog.content = this.l10n.getConstant('editContent');\n    this.quickDialog.header = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteTitle' : 'editTitle');\n    this.quickDialogClass('Recurrence');\n    var activeEvent = this.parent.activeEventData.event;\n\n    if (this.parent.eventSettings.editFollowingEvents && this.parent.currentAction === 'EditOccurrence' && !isNullOrUndefined(activeEvent[this.parent.eventFields.recurrenceID]) && activeEvent[this.parent.eventFields.recurrenceID] !== activeEvent[this.parent.eventFields.id]) {\n      var followingEventButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n      addClass([followingEventButton], cls.DISABLE_CLASS);\n    }\n\n    this.showQuickDialog('RecurrenceAlert');\n  };\n\n  QuickPopups.prototype.openRecurrenceValidationAlert = function (type) {\n    this.quickDialogClass('Alert');\n    var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n    okButton.innerHTML = this.l10n.getConstant('ok');\n    okButton.setAttribute('aria-label', okButton.innerHTML);\n    var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n    cancelButton.innerHTML = this.l10n.getConstant('cancel');\n    cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n    this.quickDialog.header = this.l10n.getConstant('alert');\n\n    switch (type) {\n      case 'wrongPattern':\n        addClass([cancelButton], cls.DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('wrongPattern');\n        break;\n\n      case 'createError':\n        addClass([cancelButton], cls.DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('createError');\n        break;\n\n      case 'sameDayAlert':\n        addClass([cancelButton], cls.DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('sameDayAlert');\n        break;\n\n      case 'seriesChangeAlert':\n        var dialogCancel = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_CANCEL_CLASS);\n        removeClass([cancelButton, dialogCancel], cls.DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('seriesChangeAlert');\n        okButton.innerHTML = this.l10n.getConstant('yes');\n        cancelButton.innerHTML = this.l10n.getConstant('no');\n        dialogCancel.innerHTML = this.l10n.getConstant('cancel');\n        break;\n    }\n\n    if (!this.parent.enableRecurrenceValidation && type === 'wrongPattern' || this.parent.enableRecurrenceValidation) {\n      this.showQuickDialog('RecurrenceValidationAlert');\n    }\n  };\n\n  QuickPopups.prototype.openDeleteAlert = function () {\n    if (this.parent.activeViewOptions.readonly) {\n      return;\n    }\n\n    var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n\n    if (okButton) {\n      okButton.innerHTML = this.l10n.getConstant('delete');\n      okButton.setAttribute('aria-label', okButton.innerHTML);\n    }\n\n    var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n\n    if (cancelButton) {\n      cancelButton.innerHTML = this.l10n.getConstant('cancel');\n      cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n    }\n\n    this.quickDialog.content = this.parent.activeEventData.event.length > 1 ? this.l10n.getConstant('deleteMultipleContent') : this.l10n.getConstant('deleteContent');\n    this.quickDialog.header = this.parent.activeEventData.event.length > 1 ? this.l10n.getConstant('deleteMultipleEvent') : this.l10n.getConstant('deleteEvent');\n    this.quickDialogClass('Delete');\n    this.showQuickDialog('DeleteAlert');\n  };\n\n  QuickPopups.prototype.openValidationError = function (type, eventData) {\n    this.quickDialog.header = this.l10n.getConstant('alert');\n    this.quickDialog.content = this.l10n.getConstant(type);\n    var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n\n    if (okButton) {\n      okButton.innerHTML = this.l10n.getConstant('ok');\n      okButton.setAttribute('aria-label', okButton.innerHTML);\n    }\n\n    var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n\n    if (cancelButton) {\n      cancelButton.innerHTML = this.l10n.getConstant('cancel');\n      okButton.setAttribute('aria-label', cancelButton.innerHTML);\n    }\n\n    this.quickDialogClass('Alert');\n    this.showQuickDialog('ValidationAlert', eventData);\n  };\n\n  QuickPopups.prototype.showQuickDialog = function (popupType, eventData) {\n    var _this = this;\n\n    this.quickDialog.dataBind();\n    var eventProp = {\n      type: popupType,\n      cancel: false,\n      data: extend({}, eventData || this.parent.activeEventData.event, null, true),\n      element: this.quickDialog.element\n    };\n    this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n      if (!popupArgs.cancel) {\n        _this.quickDialog.show();\n      }\n    });\n  };\n\n  QuickPopups.prototype.createMoreEventList = function (eventCollection, groupOrder, groupIndex) {\n    var _this = this;\n\n    var fields = this.parent.eventFields;\n    var moreEventContentEle = createElement('div', {\n      className: cls.MORE_EVENT_CONTENT_CLASS\n    });\n    var moreEventWrapperEle = createElement('div', {\n      className: cls.MORE_EVENT_WRAPPER_CLASS\n    });\n\n    if (eventCollection.length === 0) {\n      moreEventWrapperEle = createElement('div', {\n        className: cls.MORE_EVENT_CONTENT_CLASS,\n        innerHTML: this.l10n.getConstant('emptyContainer')\n      });\n    } else {\n      var _loop_1 = function (eventData) {\n        var eventText = eventData[fields.subject] || this_1.parent.eventSettings.fields.subject.default;\n        var appointmentEle = createElement('div', {\n          className: cls.APPOINTMENT_CLASS,\n          attrs: {\n            'data-id': '' + eventData[fields.id],\n            'data-guid': eventData.Guid,\n            'role': 'button',\n            'tabindex': '0',\n            'aria-readonly': this_1.parent.eventBase.getReadonlyAttribute(eventData),\n            'aria-selected': 'false',\n            'aria-grabbed': 'true',\n            'aria-label': this_1.parent.getAnnocementString(eventData)\n          }\n        });\n        var templateElement = void 0;\n\n        if (!isNullOrUndefined(this_1.parent.activeViewOptions.eventTemplate)) {\n          var tempId = this_1.parent.element.id + '_' + this_1.parent.activeViewOptions.eventTemplateName + 'eventTemplate';\n          var templateArgs = util.addLocalOffsetToEvent(eventData, this_1.parent.eventFields);\n          templateElement = this_1.parent.getAppointmentTemplate()(templateArgs, this_1.parent, 'eventTemplate', tempId, false);\n          append(templateElement, appointmentEle);\n        } else {\n          appointmentEle.appendChild(createElement('div', {\n            className: cls.SUBJECT_CLASS,\n            innerHTML: eventText\n          }));\n        }\n\n        if (this_1.parent.activeViewOptions.group.resources.length > 0) {\n          appointmentEle.setAttribute('data-group-index', groupIndex);\n        }\n\n        if (!isNullOrUndefined(eventData[fields.recurrenceRule])) {\n          var iconClass = eventData[fields.id] === eventData[fields.recurrenceID] ? cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n          appointmentEle.appendChild(createElement('div', {\n            className: cls.ICON + ' ' + iconClass\n          }));\n        }\n\n        var args = {\n          data: eventData,\n          element: appointmentEle,\n          cancel: false\n        };\n        this_1.parent.trigger(event.eventRendered, args, function (eventArgs) {\n          if (!eventArgs.cancel) {\n            moreEventWrapperEle.appendChild(appointmentEle);\n\n            _this.parent.eventBase.wireAppointmentEvents(appointmentEle, eventData, _this.parent.isAdaptive);\n\n            _this.parent.eventBase.applyResourceColor(appointmentEle, eventData, 'backgroundColor', groupOrder);\n          }\n        });\n      };\n\n      var this_1 = this;\n\n      for (var _i = 0, eventCollection_1 = eventCollection; _i < eventCollection_1.length; _i++) {\n        var eventData = eventCollection_1[_i];\n\n        _loop_1(eventData);\n      }\n    }\n\n    moreEventContentEle.appendChild(moreEventWrapperEle);\n    return moreEventContentEle;\n  };\n\n  QuickPopups.prototype.tapHoldEventPopup = function (e) {\n    var target = closest(e.target, '.' + cls.APPOINTMENT_CLASS);\n    this.isMultipleEventSelect = false;\n    this.parent.selectedElements = [];\n    this.isMultipleEventSelect = true;\n    this.parent.eventBase.getSelectedEventElements(target);\n    this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n    var guid = target.getAttribute('data-guid');\n    var eventObj = this.parent.eventBase.getEventByGuid(guid);\n\n    if (isNullOrUndefined(eventObj)) {\n      return;\n    }\n\n    var eventTitle = eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle');\n    var eventTemplate = \"<div class=\\\"\" + cls.MULTIPLE_EVENT_POPUP_CLASS + \"\\\"><div class=\\\"\" + cls.POPUP_HEADER_CLASS + \"\\\">\" + (\"<button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\"></button>\") + (\"<div class=\\\"\" + cls.SUBJECT_CLASS + \"\\\">\" + eventTitle + \"</div>\") + (\"<button class=\\\"\" + cls.EDIT_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\"></button>\") + (\"<button class=\\\"\" + cls.DELETE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\"></button></div></div>\");\n    this.quickPopup.element.innerHTML = eventTemplate;\n    var closeIcon = this.quickPopup.element.querySelector('.' + cls.CLOSE_CLASS);\n    this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.closeClick);\n    var readonly = this.parent.activeViewOptions.readonly || eventObj[this.parent.eventFields.isReadonly];\n    var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n    this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.EDIT_ICON_CLASS, readonly, editIcon, this.editClick);\n    var deleteIcon = this.quickPopup.element.querySelector('.' + cls.DELETE_CLASS);\n    this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.DELETE_ICON_CLASS, readonly, deleteIcon, this.deleteClick);\n    this.beforeQuickPopupOpen(target);\n  };\n\n  QuickPopups.prototype.isCellBlocked = function (args) {\n    var tempObj = {};\n    tempObj[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n    tempObj[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n    tempObj[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      var targetCell = args.element instanceof Array ? args.element[0] : args.element;\n      var groupIndex = parseInt(targetCell.getAttribute('data-group-index'), 10);\n      this.parent.resourceBase.setResourceValues(tempObj, isNaN(groupIndex) ? null : groupIndex);\n    }\n\n    return this.parent.eventBase.isBlockRange(tempObj);\n  }; // tslint:disable-next-line:max-func-body-length\n\n\n  QuickPopups.prototype.cellClick = function (args) {\n    var date = new Date(args.startTime.getTime());\n\n    if (!this.parent.showQuickInfo || !this.parent.eventSettings.allowAdding || this.parent.currentView === 'MonthAgenda' || this.isCellBlocked(args) || !this.parent.isMinMaxDate(new Date(date.setHours(0, 0, 0, 0)))) {\n      this.quickPopupHide();\n      return;\n    }\n\n    var targetEle = args.event.target;\n\n    if (this.parent.isAdaptive) {\n      this.quickPopupHide();\n      var newEventClone = this.parent.element.querySelector('.' + cls.NEW_EVENT_CLASS);\n\n      if (isNullOrUndefined(newEventClone)) {\n        newEventClone = createElement('div', {\n          className: cls.NEW_EVENT_CLASS,\n          innerHTML: \"<div class=\\\"e-title\\\">+ \" + this.l10n.getConstant('newEvent') + \"</div>\"\n        });\n      }\n\n      var targetCell = closest(targetEle, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS);\n\n      if (targetCell) {\n        targetCell.appendChild(newEventClone);\n      }\n\n      return;\n    }\n\n    var target = closest(targetEle, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS + ',.' + cls.HEADER_CELLS_CLASS);\n\n    if (isNullOrUndefined(target) || targetEle.classList.contains(cls.MORE_INDICATOR_CLASS)) {\n      return;\n    }\n\n    var isSameTarget = this.quickPopup.relateTo === target;\n\n    if (isSameTarget && this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n      var subjectElement_1 = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n\n      if (subjectElement_1) {\n        subjectElement_1.focus();\n      }\n\n      return;\n    }\n\n    this.resetQuickPopupTemplates();\n    var temp = {};\n    temp[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n    temp[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n    temp[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n    var quickCellPopup = createElement('div', {\n      className: cls.CELL_POPUP_CLASS\n    });\n    quickCellPopup.appendChild(this.getPopupHeader('Cell', temp));\n    quickCellPopup.appendChild(this.getPopupContent('Cell', args, temp));\n    quickCellPopup.appendChild(this.getPopupFooter('Cell', temp));\n    var subjectElement = quickCellPopup.querySelector('.' + cls.SUBJECT_CLASS);\n\n    if (subjectElement) {\n      Input.createInput({\n        element: subjectElement,\n        properties: {\n          placeholder: this.l10n.getConstant('addTitle')\n        }\n      });\n    }\n\n    var closeIcon = quickCellPopup.querySelector('.' + cls.CLOSE_CLASS);\n\n    if (closeIcon) {\n      this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n    }\n\n    var moreButton = quickCellPopup.querySelector('.' + cls.QUICK_POPUP_EVENT_DETAILS_CLASS);\n\n    if (moreButton) {\n      this.renderButton('e-flat', '', false, moreButton, this.detailsClick);\n    }\n\n    var saveButton = quickCellPopup.querySelector('.' + cls.EVENT_CREATE_CLASS);\n\n    if (saveButton) {\n      this.renderButton('e-flat e-primary', '', this.parent.activeViewOptions.readonly, saveButton, this.saveClick);\n    }\n\n    this.quickPopup.content = quickCellPopup;\n    this.quickPopup.dataBind();\n    this.applyFormValidation();\n\n    if (this.morePopup) {\n      this.morePopup.hide();\n    }\n\n    this.quickPopup.relateTo = target;\n    this.beforeQuickPopupOpen(target);\n  };\n\n  QuickPopups.prototype.isSameEventClick = function (events) {\n    var isSameTarget = this.quickPopup.relateTo === closest(events.element, '.' + cls.APPOINTMENT_CLASS);\n\n    if (isSameTarget && this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n      var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n\n      if (editIcon) {\n        editIcon.focus();\n      }\n\n      if (!this.parent.isAdaptive) {\n        var editButton = this.quickPopup.element.querySelector('.' + cls.EDIT_EVENT_CLASS);\n\n        if (editButton) {\n          editButton.focus();\n        }\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  QuickPopups.prototype.isQuickTemplate = function (type) {\n    return this.parent.quickInfoTemplates.templateType === 'Both' || this.parent.quickInfoTemplates.templateType === type;\n  };\n\n  QuickPopups.prototype.eventClick = function (events) {\n    if (this.parent.eventTooltip) {\n      this.parent.eventTooltip.close();\n    }\n\n    if (!this.parent.showQuickInfo) {\n      return;\n    }\n\n    if (this.parent.isAdaptive && this.isMultipleEventSelect) {\n      this.updateTapHoldEventPopup(closest(events.element, '.' + cls.APPOINTMENT_CLASS));\n    } else {\n      var isSameTarget = this.isSameEventClick(events);\n\n      if (isSameTarget) {\n        return;\n      }\n\n      this.resetQuickPopupTemplates();\n      var eventData = events.event;\n      var quickEventPopup = createElement('div', {\n        className: cls.EVENT_POPUP_CLASS\n      });\n      quickEventPopup.appendChild(this.getPopupHeader('Event', eventData));\n      quickEventPopup.appendChild(this.getPopupContent('Event', events, eventData));\n      quickEventPopup.appendChild(this.getPopupFooter('Event', eventData));\n      var readonly = this.parent.activeViewOptions.readonly || eventData[this.parent.eventFields.isReadonly];\n      var editAction = !this.parent.eventSettings.allowEditing || readonly;\n      var deleteAction = !this.parent.eventSettings.allowDeleting || readonly;\n      var editIcon = quickEventPopup.querySelector('.' + cls.EDIT_CLASS);\n      var buttonClass = 'e-flat e-round e-small';\n\n      if (editIcon) {\n        this.renderButton(buttonClass, cls.ICON + ' ' + cls.EDIT_ICON_CLASS, editAction, editIcon, this.editClick);\n      }\n\n      var deleteIcon = quickEventPopup.querySelector('.' + cls.DELETE_CLASS);\n\n      if (deleteIcon) {\n        this.renderButton(buttonClass, cls.ICON + ' ' + cls.DELETE_ICON_CLASS, deleteAction, deleteIcon, this.deleteClick);\n      }\n\n      var closeIcon = quickEventPopup.querySelector('.' + cls.CLOSE_CLASS);\n\n      if (closeIcon) {\n        this.renderButton(buttonClass, cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n      }\n\n      var editButton = quickEventPopup.querySelector('.' + cls.EDIT_EVENT_CLASS);\n\n      if (editButton) {\n        this.renderButton('e-flat e-primary', '', editAction, editButton, this.editClick);\n      }\n\n      var deleteButton = quickEventPopup.querySelector('.' + cls.DELETE_EVENT_CLASS);\n\n      if (deleteButton) {\n        this.renderButton('e-flat', '', deleteAction, deleteButton, this.deleteClick);\n      }\n\n      this.quickPopup.content = quickEventPopup;\n      this.quickPopup.dataBind();\n\n      if (this.morePopup && !closest(events.element, '.' + cls.MORE_EVENT_WRAPPER_CLASS)) {\n        this.morePopup.hide();\n      }\n\n      this.quickPopup.relateTo = this.parent.isAdaptive ? document.body : closest(events.element, '.' + cls.APPOINTMENT_CLASS);\n      this.beforeQuickPopupOpen(events.element);\n    }\n  };\n\n  QuickPopups.prototype.getPopupHeader = function (headerType, headerData) {\n    var headerTemplate = createElement('div', {\n      className: cls.POPUP_HEADER_CLASS\n    });\n\n    if (this.isQuickTemplate(headerType) && this.parent.quickInfoTemplates.header) {\n      var headerArgs = extend({}, headerData, !isBlazor() ? {\n        elementType: headerType.toLowerCase()\n      } : {\n        elementType: headerType.toLowerCase(),\n        startTimeValue: util.addLocalOffset(headerData[this.parent.eventFields.startTime]),\n        endTimeValue: util.addLocalOffset(headerData[this.parent.eventFields.endTime])\n      }, true);\n      var templateId = this.parent.element.id;\n      var headerTemp = [].slice.call(this.parent.getQuickInfoTemplatesHeader()(headerArgs, this.parent, 'header', templateId + '_headerTemplate', false));\n      append([].slice.call(headerTemp), headerTemplate);\n    } else {\n      var header = void 0;\n\n      switch (headerType) {\n        case 'Cell':\n          header = \"<div class=\\\"\" + cls.POPUP_HEADER_ICON_WRAPPER + \"\\\"><button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\" + (\"\\\"\" + this.l10n.getConstant('close') + \"\\\"></button></div>\");\n          break;\n\n        case 'Event':\n          var args = this.getFormattedString(headerData);\n          header = \"<div class=\\\"\" + cls.POPUP_HEADER_ICON_WRAPPER + \"\\\">\" + (\"<button class=\\\"\" + (cls.EDIT_CLASS + ' ' + cls.ICON) + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\"></button>\") + (\"<button class=\\\"\" + (cls.DELETE_CLASS + ' ' + cls.ICON) + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\"></button>\") + (\"<button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\"></button></div>\") + (\"<div class=\\\"\" + cls.SUBJECT_WRAP + \"\\\"><div class=\\\"\" + cls.SUBJECT_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" \") + (\"title=\\\"\" + args.eventSubject + \"\\\">\" + args.eventSubject + \"</div></div >\");\n          break;\n      }\n\n      var templateWrapper = createElement('div', {\n        innerHTML: header\n      });\n      append([].slice.call(templateWrapper.childNodes), headerTemplate);\n    }\n\n    return headerTemplate;\n  };\n\n  QuickPopups.prototype.getPopupContent = function (type, args, data) {\n    var contentTemplate = createElement('div', {\n      className: cls.POPUP_CONTENT_CLASS\n    });\n\n    if (this.isQuickTemplate(type) && this.parent.quickInfoTemplates.content) {\n      var contentArgs = extend({}, data, !isBlazor() ? {\n        elementType: type.toLowerCase()\n      } : {\n        elementType: type.toLowerCase(),\n        startTimeValue: util.addLocalOffset(data[this.parent.eventFields.startTime]),\n        endTimeValue: util.addLocalOffset(data[this.parent.eventFields.endTime])\n      }, true);\n      var templateId = this.parent.element.id;\n      var contentTemp = [].slice.call(this.parent.getQuickInfoTemplatesContent()(contentArgs, this.parent, 'content', templateId + '_contentTemplate', false));\n      append([].slice.call(contentTemp), contentTemplate);\n    } else {\n      var content = void 0;\n      var resourceText = this.getResourceText(args, type.toLowerCase());\n\n      switch (type) {\n        case 'Cell':\n          var cellDetails = this.getFormattedString(data);\n          content = \"<table class=\\\"\" + cls.POPUP_TABLE_CLASS + \"\\\"><tbody><tr><td><form class=\\\"\" + cls.FORM_CLASS + \"\\\" onsubmit=\" + (\"\\\"return false;\\\"><input class=\\\"\" + cls.SUBJECT_CLASS + \" \" + EVENT_FIELD + \"\\\" type=\\\"text\\\" name=\") + (\"\\\"\" + this.parent.eventFields.subject + \"\\\" /></form></td></tr><tr><td><div class=\\\"\" + cls.DATE_TIME_CLASS + \"\\\">\") + (\"<div class=\\\"\" + cls.DATE_TIME_ICON_CLASS + \" \" + cls.ICON + \"\\\"></div><div class=\\\"\" + cls.DATE_TIME_DETAILS_CLASS + \" \") + (cls.TEXT_ELLIPSIS + \"\\\">\" + cellDetails.details + \"</div></div>\") + ((this.parent.activeViewOptions.group.resources.length > 0 ? \"<div class=\\\"\" + cls.RESOURCE_CLASS + \"\\\">\" + (\"<div class=\\\"\" + cls.RESOURCE_ICON_CLASS + \" \" + cls.ICON + \" \\\"></div><div class=\\\"\" + cls.RESOURCE_DETAILS_CLASS + \" \") + (cls.TEXT_ELLIPSIS + \"\\\">\" + resourceText + \"</div></div>\") : '') + \"</td></tr></tbody></table>\");\n          break;\n\n        case 'Event':\n          var args_1 = this.getFormattedString(data);\n          content = '<div class=\"' + cls.DATE_TIME_CLASS + '\"><div class=\"' + cls.DATE_TIME_ICON_CLASS + ' ' + cls.ICON + '\"></div><div class=\"' + cls.DATE_TIME_WRAPPER_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\"><div class=\"' + cls.DATE_TIME_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + args_1.details + '</div>';\n\n          if (data[this.parent.eventFields.recurrenceRule]) {\n            content += '<div class=\"' + cls.RECURRENCE_SUMMARY_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + this.getRecurrenceSummary(data) + '</div>';\n          }\n\n          content += '</div></div>';\n\n          if (data[this.parent.eventFields.location]) {\n            content += '<div class=\"' + cls.LOCATION_CLASS + '\"><div class=\"' + cls.LOCATION_ICON_CLASS + ' ' + cls.ICON + '\"></div><div class=\"' + cls.LOCATION_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + data[this.parent.eventFields.location] + '</div></div>';\n          }\n\n          if (data[this.parent.eventFields.startTimezone] || data[this.parent.eventFields.endTimezone]) {\n            content += '<div class=\"' + cls.TIME_ZONE_CLASS + '\"><div class=\"' + cls.TIME_ZONE_ICON_CLASS + ' ' + cls.ICON + '\"></div><div class=\"' + cls.TIME_ZONE_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + this.getTimezone(data) + '</div></div>';\n          }\n\n          if (data[this.parent.eventFields.description]) {\n            content += '<div class=\"' + cls.DESCRIPTION_CLASS + '\"><div class=\"' + cls.DESCRIPTION_ICON_CLASS + ' ' + cls.ICON + '\"></div><div class=\"' + cls.DESCRIPTION_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + data[this.parent.eventFields.description] + '</div></div>';\n          }\n\n          if (this.parent.resourceCollection.length > 0) {\n            content += '<div class=\"' + cls.RESOURCE_CLASS + '\"><div class=\"' + cls.RESOURCE_ICON_CLASS + ' ' + cls.ICON + '\"></div><div class=\"' + cls.RESOURCE_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + resourceText + '</div></div>';\n          }\n\n          break;\n      }\n\n      var templateWrapper = createElement('div', {\n        innerHTML: content\n      });\n      append([].slice.call(templateWrapper.childNodes), contentTemplate);\n    }\n\n    return contentTemplate;\n  };\n\n  QuickPopups.prototype.getPopupFooter = function (footerType, footerData) {\n    var footerTemplate = createElement('div', {\n      className: cls.POPUP_FOOTER_CLASS\n    });\n\n    if (this.isQuickTemplate(footerType) && this.parent.quickInfoTemplates.footer) {\n      var footerArgs = extend({}, footerData, !isBlazor() ? {\n        elementType: footerType.toLowerCase()\n      } : {\n        elementType: footerType.toLowerCase(),\n        startTimeValue: util.addLocalOffset(footerData[this.parent.eventFields.startTime]),\n        endTimeValue: util.addLocalOffset(footerData[this.parent.eventFields.endTime])\n      }, true);\n      var templateId = this.parent.element.id;\n      var footerTemp = [].slice.call(this.parent.getQuickInfoTemplatesFooter()(footerArgs, this.parent, 'footer', templateId + '_footerTemplate', false));\n      append([].slice.call(footerTemp), footerTemplate);\n    } else {\n      var footer = void 0;\n\n      switch (footerType) {\n        case 'Cell':\n          footer = \"<button class=\\\"\" + (cls.QUICK_POPUP_EVENT_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS) + \"\\\" title=\" + (\"\\\"\" + this.l10n.getConstant('moreDetails') + \"\\\">\" + this.l10n.getConstant('moreDetails') + \"</button>\") + (\"<button class=\\\"\" + cls.EVENT_CREATE_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('save') + \"\\\">\") + (this.l10n.getConstant('save') + \"</button>\");\n          break;\n\n        case 'Event':\n          footer = \"\" + (this.parent.isAdaptive ? '' : \"<button class=\\\"\" + cls.EDIT_EVENT_CLASS + \" \" + (cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\">\" + this.l10n.getConstant('edit') + \"</button>\") + (\"<button class=\\\"\" + cls.DELETE_EVENT_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\">\") + (this.l10n.getConstant('delete') + \"</button>\"));\n          break;\n      }\n\n      var templateWrapper = createElement('div', {\n        innerHTML: footer\n      });\n      append([].slice.call(templateWrapper.childNodes), footerTemplate);\n    }\n\n    return footerTemplate;\n  };\n\n  QuickPopups.prototype.getResourceText = function (args, type) {\n    if (this.parent.resourceCollection.length === 0) {\n      return null;\n    }\n\n    var resourceValue = '';\n\n    if (this.parent.activeViewOptions.group.resources.length === 0) {\n      var resourceCollection_1 = this.parent.resourceBase.resourceCollection.slice(-1)[0];\n      var resourceData = resourceCollection_1.dataSource;\n      var resourceIndex_1 = 0;\n      var eventData_1 = args.event;\n      resourceData.forEach(function (resource, index) {\n        if (resource[resourceCollection_1.idField] === eventData_1[resourceCollection_1.field]) {\n          resourceIndex_1 = index;\n        }\n      });\n      resourceValue = resourceData[resourceIndex_1][resourceCollection_1.textField];\n    } else {\n      if (type === 'event') {\n        var eventData = args.event;\n        var resourceData = void 0;\n        var lastResource_1;\n\n        for (var i = this.parent.resourceBase.resourceCollection.length - 1; i >= 0; i--) {\n          resourceData = eventData[this.parent.resourceBase.resourceCollection[i].field];\n\n          if (!isNullOrUndefined(resourceData)) {\n            lastResource_1 = this.parent.resourceBase.resourceCollection[i];\n            break;\n          }\n        }\n\n        if (!Array.isArray(resourceData)) {\n          resourceData = [resourceData];\n        }\n\n        var resNames_1 = [];\n        var lastResourceData_1 = lastResource_1.dataSource;\n        resourceData.map(function (value) {\n          var i = util.findIndexInData(lastResourceData_1, lastResource_1.idField, value);\n          var text = lastResourceData_1[i][lastResource_1.textField];\n\n          if (text) {\n            resNames_1.push(text);\n          }\n        });\n        resourceValue = resNames_1.join(', ');\n      } else {\n        var argsData = args;\n        var groupIndex = !isNullOrUndefined(argsData.groupIndex) ? argsData.groupIndex : 0;\n        var resourceDetails = this.parent.resourceBase.lastResourceLevel[groupIndex];\n        resourceValue = resourceDetails.resourceData[resourceDetails.resource.textField];\n      }\n    }\n\n    return resourceValue;\n  };\n\n  QuickPopups.prototype.getFormattedString = function (eventData) {\n    var fields = this.parent.eventFields;\n    var eventSubject = eventData[fields.subject] || this.l10n.getConstant('noTitle');\n    var startDate = eventData[fields.startTime];\n    var endDate = eventData[fields.endTime];\n    var format = 'MMMM d, y';\n    var startDateDetails = this.getDateFormat(startDate, 'long', format);\n    var endDateDetails = eventData[fields.isAllDay] && endDate.getHours() === 0 && endDate.getMinutes() === 0 ? this.getDateFormat(util.addDays(new Date(endDate.getTime()), -1), 'long', format) : this.getDateFormat(endDate, 'long', format);\n    var startTimeDetail = this.parent.getTimeString(startDate);\n    var endTimeDetail = this.parent.getTimeString(endDate);\n    var details = '';\n    var spanLength = endDate.getDate() !== startDate.getDate() && (endDate.getTime() - startDate.getTime()) / (60 * 60 * 1000) < 24 ? 1 : 0;\n\n    if (eventData[fields.isAllDay]) {\n      details = startDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n\n      if ((endDate.getTime() - startDate.getTime()) / util.MS_PER_DAY > 1) {\n        details += '&nbsp;-&nbsp;' + endDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n      }\n    } else if ((endDate.getTime() - startDate.getTime()) / util.MS_PER_DAY >= 1 || spanLength > 0) {\n      details = startDateDetails + ' (' + startTimeDetail + ')' + '&nbsp;-&nbsp;' + endDateDetails + ' (' + endTimeDetail + ')';\n    } else {\n      details = startDateDetails + ' (' + (startTimeDetail + '&nbsp;-&nbsp;' + endTimeDetail) + ')';\n    }\n\n    return {\n      eventSubject: eventSubject,\n      details: details\n    };\n  };\n\n  QuickPopups.prototype.moreEventClick = function (data, endDate, groupIndex) {\n    var _this = this;\n\n    this.quickPopupHide(true);\n    var moreEventContentEle = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CONTENT_CLASS);\n\n    if (moreEventContentEle) {\n      remove(moreEventContentEle);\n    }\n\n    var selectedDate = data.date.getTime().toString();\n    var target = closest(data.element, '.' + cls.MORE_INDICATOR_CLASS + ',.' + cls.WORK_CELLS_CLASS);\n    var day = this.parent.globalize.formatDate(data.date, {\n      format: 'E',\n      calendar: this.parent.getCalendarMode()\n    });\n    this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DAY_CLASS).innerHTML = util.capitalizeFirstWord(day, 'single');\n    var dateElement = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS);\n    dateElement.innerHTML = this.getDateFormat(data.date, 'd', 'd');\n    dateElement.setAttribute('data-date', selectedDate);\n    dateElement.setAttribute('data-end-date', endDate.getTime().toString());\n    var groupOrder;\n\n    if (!isNullOrUndefined(groupIndex)) {\n      dateElement.setAttribute('data-group-index', groupIndex);\n      groupOrder = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)].groupOrder;\n    }\n\n    var moreEventElements = this.createMoreEventList(data.event, groupOrder, groupIndex);\n    this.morePopup.element.querySelector('.' + cls.MORE_EVENT_POPUP_CLASS).appendChild(moreEventElements);\n    removeClass(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_DATE_HEADER_CLASS).childNodes, cls.CURRENTDATE_CLASS);\n\n    if (util.resetTime(data.date).getTime() === util.resetTime(this.parent.getCurrentTime()).getTime()) {\n      addClass(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_DATE_HEADER_CLASS).childNodes, cls.CURRENTDATE_CLASS);\n    }\n\n    if (!this.parent.isAdaptive) {\n      if (this.parent.currentView.indexOf('Timeline') !== -1) {\n        var gIndex = target.getAttribute('data-group-index');\n        var startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n        startDate.setHours(startDate.getHours(), startDate.getMinutes(), 0);\n        var tdDate = this.parent.getMsFromDate(startDate).toString();\n\n        if (isNullOrUndefined(gIndex)) {\n          this.morePopup.relateTo = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' tbody tr td[data-date=\"' + tdDate + '\"]');\n        } else {\n          this.morePopup.relateTo = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' tbody tr td[data-group-index=\"' + gIndex + '\"][data-date=\"' + tdDate + '\"]');\n        }\n      } else {\n        this.morePopup.relateTo = closest(target, '.' + cls.WORK_CELLS_CLASS);\n      }\n    }\n\n    this.parent.updateEventTemplates();\n    var eventProp = {\n      type: 'EventContainer',\n      cancel: false,\n      element: this.morePopup.element\n    };\n\n    if (!isBlazor()) {\n      eventProp.data = data;\n    }\n\n    this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n      if (!popupArgs.cancel) {\n        _this.morePopup.show();\n      }\n    });\n  };\n\n  QuickPopups.prototype.saveClick = function () {\n    this.isCrudAction = true;\n    this.quickPopupHide();\n  };\n\n  QuickPopups.prototype.detailsClick = function () {\n    var subjectEle = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n\n    if (subjectEle && subjectEle.value !== '') {\n      var args = extend(this.parent.activeCellsData, {\n        subject: subjectEle.value\n      });\n    }\n\n    this.isCrudAction = false;\n    this.fieldValidator.destroyToolTip();\n    this.quickPopupHide();\n    this.parent.eventWindow.openEditor(this.parent.activeCellsData, 'Add');\n  };\n\n  QuickPopups.prototype.editClick = function () {\n    this.quickPopupHide(true);\n    var data = this.parent.activeEventData.event;\n    this.parent.currentAction = 'EditSeries';\n\n    if (!isNullOrUndefined(data[this.parent.eventFields.recurrenceRule])) {\n      this.parent.currentAction = 'EditOccurrence';\n      this.openRecurrenceAlert();\n    } else {\n      this.parent.eventWindow.openEditor(data, this.parent.currentAction);\n    }\n  };\n\n  QuickPopups.prototype.deleteClick = function () {\n    this.quickPopupHide(true);\n    this.parent.currentAction = 'Delete';\n\n    if (this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule]) {\n      this.openRecurrenceAlert();\n    } else {\n      this.openDeleteAlert();\n    }\n  };\n\n  QuickPopups.prototype.updateMoreEventContent = function () {\n    if (this.morePopup.element.classList.contains('e-popup-close')) {\n      return;\n    }\n\n    var moreEventContentEle = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CONTENT_CLASS);\n\n    if (moreEventContentEle) {\n      remove(moreEventContentEle);\n    }\n\n    var dateElement = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS);\n    var startDate = new Date(parseInt(dateElement.getAttribute('data-date'), 10));\n    var endDate = new Date(parseInt(dateElement.getAttribute('data-end-date'), 10));\n    var groupIndex = dateElement.getAttribute('data-group-index');\n    var data;\n    var groupOrder;\n\n    if (!isNullOrUndefined(groupIndex)) {\n      data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n      groupOrder = data.groupOrder;\n    }\n\n    var filteredEvents = this.parent.eventBase.filterEvents(startDate, endDate, this.parent.eventsProcessed, data);\n    var moreElement = this.createMoreEventList(filteredEvents, groupOrder, groupIndex);\n    this.morePopup.element.querySelector('.' + cls.MORE_EVENT_POPUP_CLASS).appendChild(moreElement);\n  };\n\n  QuickPopups.prototype.closeClick = function () {\n    this.quickPopupHide();\n    this.morePopup.hide();\n  };\n\n  QuickPopups.prototype.dialogButtonClick = function (event) {\n    this.quickDialog.hide();\n    var target = event.target;\n    var cancelBtn = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n    var eventData = this.parent.activeEventData.event;\n\n    if (target.classList.contains(cls.QUICK_DIALOG_OCCURRENCE_CLASS)) {\n      this.parent.currentAction = this.parent.currentAction === 'Delete' ? 'DeleteOccurrence' : 'EditOccurrence';\n\n      switch (this.parent.currentAction) {\n        case 'EditOccurrence':\n          this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n          break;\n\n        case 'DeleteOccurrence':\n          this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n          break;\n      }\n    } else if (target.classList.contains(cls.QUICK_DIALOG_FOLLOWING_EVENTS_CLASS)) {\n      this.parent.currentAction = this.parent.currentAction === 'Delete' ? 'DeleteFollowingEvents' : 'EditFollowingEvents';\n\n      switch (this.parent.currentAction) {\n        case 'EditFollowingEvents':\n          this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n          break;\n\n        case 'DeleteFollowingEvents':\n          this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n          break;\n      }\n    } else if (target.classList.contains(cls.QUICK_DIALOG_SERIES_CLASS)) {\n      this.parent.currentAction = this.parent.currentAction === 'Delete' ? 'DeleteSeries' : 'EditSeries';\n\n      switch (this.parent.currentAction) {\n        case 'EditSeries':\n          this.parent.eventWindow.openEditor(this.parent.eventBase.getParentEvent(eventData, true), this.parent.currentAction);\n          break;\n\n        case 'DeleteSeries':\n          this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n          break;\n      }\n    } else if (target.classList.contains(cls.QUICK_DIALOG_DELETE_CLASS)) {\n      this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n    } else if (!cancelBtn.classList.contains(cls.DISABLE_CLASS) && (target.classList.contains(cls.QUICK_DIALOG_ALERT_OK) || target.classList.contains(cls.QUICK_DIALOG_ALERT_CANCEL) && !cancelBtn.classList.contains(cls.QUICK_DIALOG_CANCEL_CLASS))) {\n      this.parent.uiStateValues.isIgnoreOccurrence = target.classList.contains(cls.QUICK_DIALOG_ALERT_CANCEL);\n      this.parent.eventWindow.eventSave(this.l10n.getConstant('ok'));\n    }\n  };\n\n  QuickPopups.prototype.updateTapHoldEventPopup = function (target) {\n    var selectedElements = this.parent.eventBase.getSelectedEventElements(target);\n    this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n\n    if (selectedElements.length > 0) {\n      var eventObj = this.parent.eventBase.getEventByGuid(selectedElements[0].getAttribute('data-guid'));\n      var titleContent = selectedElements.length === 1 ? eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle') : '(' + selectedElements.length + ')' + '&nbsp;' + this.l10n.getConstant('selectedItems');\n      this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS).innerHTML = titleContent;\n\n      if (selectedElements.length > 1) {\n        addClass([this.quickPopup.element.querySelector('.' + cls.EDIT_ICON_CLASS)], cls.HIDDEN_CLASS);\n      } else {\n        removeClass([this.quickPopup.element.querySelector('.' + cls.EDIT_ICON_CLASS)], cls.HIDDEN_CLASS);\n      }\n    } else {\n      this.parent.selectedElements = [];\n      this.quickPopupHide();\n    }\n  };\n\n  QuickPopups.prototype.getTimezone = function (event) {\n    var zoneDetails = '';\n    zoneDetails += event[this.parent.eventFields.startTimezone] || '';\n    zoneDetails += zoneDetails === '' ? '' : ' - ';\n    zoneDetails += event[this.parent.eventFields.endTimezone] || '';\n    return zoneDetails;\n  };\n\n  QuickPopups.prototype.getRecurrenceSummary = function (event) {\n    var recurrenceEditor = this.parent.eventWindow.getRecurrenceEditorInstance();\n\n    if (recurrenceEditor) {\n      var ruleSummary = recurrenceEditor.getRuleSummary(event[this.parent.eventFields.recurrenceRule]);\n      return ruleSummary.charAt(0).toUpperCase() + ruleSummary.slice(1);\n    }\n\n    return '';\n  };\n\n  QuickPopups.prototype.getDateFormat = function (date, skeletonString, formatString) {\n    return util.capitalizeFirstWord(isBlazor() ? this.parent.globalize.formatDate(date, {\n      format: formatString,\n      calendar: this.parent.getCalendarMode()\n    }) : this.parent.globalize.formatDate(date, {\n      skeleton: skeletonString,\n      calendar: this.parent.getCalendarMode()\n    }), 'single');\n  };\n\n  QuickPopups.prototype.getDataFromTarget = function (target) {\n    if (target.classList.contains(cls.APPOINTMENT_CLASS)) {\n      return this.parent.activeEventData.event;\n    } // Depricated cells data in quick popups\n\n\n    var eventObj = {\n      startTime: this.parent.activeCellsData.startTime,\n      endTime: this.parent.activeCellsData.endTime,\n      isAllDay: this.parent.activeCellsData.isAllDay,\n      groupIndex: this.parent.activeCellsData.groupIndex\n    };\n    var cellsData = this.parent.activeCellsData;\n    this.parent.eventWindow.convertToEventData(cellsData, eventObj);\n    return eventObj;\n  };\n\n  QuickPopups.prototype.beforeQuickDialogClose = function () {\n    var _this = this;\n\n    var args = {\n      type: isNullOrUndefined(this.parent.activeEventData.event) ? 'ValidationAlert' : !isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule]) ? 'RecurrenceAlert' : 'DeleteAlert',\n      cancel: false,\n      data: this.parent.activeEventData.event,\n      element: this.quickDialog.element\n    };\n    this.parent.trigger(event.popupClose, args, function (popupCloseArgs) {\n      popupCloseArgs = _this.serializingData(popupCloseArgs);\n\n      if (!popupCloseArgs.cancel) {\n        _this.parent.eventBase.focusElement();\n      }\n    });\n  };\n\n  QuickPopups.prototype.beforeQuickPopupOpen = function (target, success) {\n    var _this = this;\n\n    if (isBlazor() && this.isQuickInfoTemplates() && isNullOrUndefined(success)) {\n      this.updateQuickPopupTemplates(target);\n      return;\n    }\n\n    var isEventPopup = this.quickPopup.element.querySelector('.' + cls.EVENT_POPUP_CLASS);\n    var popupType = this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo';\n    var eventProp = {\n      type: popupType,\n      cancel: false,\n      data: extend({}, this.getDataFromTarget(target), null, true),\n      target: target,\n      element: this.quickPopup.element\n    };\n    this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n      if (popupArgs.cancel) {\n        _this.quickPopupHide();\n\n        _this.destroyButtons();\n\n        if (popupArgs.element.classList.contains(cls.POPUP_OPEN)) {\n          _this.quickPopupClose();\n        }\n\n        _this.resetQuickPopupTemplates();\n\n        util.removeChildren(_this.quickPopup.element);\n        _this.isMultipleEventSelect = false;\n      } else {\n        var display = _this.quickPopup.element.style.display;\n        _this.quickPopup.element.style.display = 'block';\n\n        if (_this.parent.isAdaptive) {\n          _this.quickPopup.element.removeAttribute('style');\n\n          _this.quickPopup.element.style.display = 'block';\n          _this.quickPopup.element.style.height = formatUnit(popupType === 'EditEventInfo' ? 65 : window.innerHeight);\n        } else {\n          _this.quickPopup.offsetX = 10;\n          _this.quickPopup.collision = {\n            X: _this.parent.enableRtl ? 'flip' : 'none',\n            Y: 'fit'\n          };\n          _this.quickPopup.position = {\n            X: _this.parent.enableRtl ? 'left' : 'right',\n            Y: 'top'\n          };\n\n          _this.quickPopup.dataBind();\n\n          _this.quickPopup.refreshPosition(null, true);\n\n          var collide = isCollide(_this.quickPopup.element, _this.parent.element);\n\n          if (collide.indexOf(_this.parent.enableRtl ? 'left' : 'right') > -1) {\n            _this.quickPopup.offsetX = -target.offsetWidth - 10 - _this.quickPopup.element.offsetWidth;\n\n            _this.quickPopup.dataBind();\n\n            var leftCollide = isCollide(_this.quickPopup.element, _this.parent.element);\n\n            if (leftCollide.indexOf('left') > -1) {\n              _this.quickPopup.position = {\n                X: 'center',\n                Y: 'center'\n              };\n              _this.quickPopup.collision = {\n                X: 'fit',\n                Y: 'fit'\n              };\n              _this.quickPopup.offsetX = -(_this.quickPopup.element.offsetWidth / 2);\n\n              _this.quickPopup.dataBind();\n            }\n          }\n\n          if (_this.parent.virtualScrollModule && (collide.indexOf('top') > -1 || collide.indexOf('bottom') > -1)) {\n            var element = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' table');\n\n            var translateY = util.getTranslateY(element);\n            _this.quickPopup.offsetY = translateY;\n\n            _this.quickPopup.dataBind();\n          }\n        }\n\n        if (isEventPopup) {\n          _this.applyEventColor();\n        }\n\n        _this.quickPopup.element.style.display = display;\n\n        _this.quickPopup.dataBind();\n\n        _this.quickPopup.show();\n      }\n    });\n  };\n\n  QuickPopups.prototype.isQuickInfoTemplates = function () {\n    if (!isNullOrUndefined(this.parent.quickInfoTemplates.header || this.parent.quickInfoTemplates.content || this.parent.quickInfoTemplates.footer)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  QuickPopups.prototype.applyEventColor = function () {\n    var colorField = '';\n\n    if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n      colorField = this.parent.enableRtl ? 'border-right-color' : 'border-left-color';\n    } else {\n      colorField = 'background-color';\n    } // tslint:disable-next-line:no-any\n\n\n    var color = this.parent.activeEventData.element.style[colorField];\n\n    if (color === '') {\n      return;\n    }\n\n    var colorEle = this.quickPopup.element.querySelector('.' + cls.POPUP_HEADER_CLASS);\n    var footerEle = this.quickPopup.element.querySelector('.' + cls.POPUP_FOOTER_CLASS);\n\n    if (footerEle && footerEle.offsetParent) {\n      colorEle = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n\n      if (colorEle) {\n        colorEle.style.borderLeftColor = color;\n        color = \"rgba(\" + color.match(/\\d+/g).join() + \",0.3)\";\n      }\n    }\n\n    if (colorEle) {\n      colorEle.style.backgroundColor = color;\n    }\n  };\n\n  QuickPopups.prototype.quickPopupOpen = function () {\n    if (this.parent.isAdaptive) {\n      this.quickPopup.element.style.top = '0px';\n      return;\n    }\n\n    if (this.quickPopup.element.querySelector('.' + cls.CELL_POPUP_CLASS)) {\n      var subjectElement = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n\n      if (subjectElement) {\n        subjectElement.focus();\n      }\n    } else {\n      var editElement = this.quickPopup.element.querySelector('.' + cls.EDIT_EVENT_CLASS);\n\n      if (editElement) {\n        editElement.focus();\n      }\n\n      var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n\n      if (editIcon) {\n        editIcon.focus();\n      }\n    }\n  };\n\n  QuickPopups.prototype.updateQuickPopupTemplates = function (target) {\n    var _this = this;\n\n    var templateReady = {\n      header: this.parent.quickInfoTemplates.header ? false : true,\n      content: this.parent.quickInfoTemplates.content ? false : true,\n      footer: this.parent.quickInfoTemplates.footer ? false : true\n    };\n\n    if (this.parent.quickInfoTemplates.header) {\n      updateBlazorTemplate(this.parent.element.id + '_headerTemplate', 'HeaderTemplate', this.parent.quickInfoTemplates, null, function () {\n        templateReady.header = true;\n\n        _this.quickPopupShow(templateReady, target);\n      });\n    }\n\n    if (this.parent.quickInfoTemplates.content) {\n      updateBlazorTemplate(this.parent.element.id + '_contentTemplate', 'ContentTemplate', this.parent.quickInfoTemplates, null, function () {\n        templateReady.content = true;\n\n        _this.quickPopupShow(templateReady, target);\n      });\n    }\n\n    if (this.parent.quickInfoTemplates.footer) {\n      updateBlazorTemplate(this.parent.element.id + '_footerTemplate', 'FooterTemplate', this.parent.quickInfoTemplates, null, function () {\n        templateReady.footer = true;\n\n        _this.quickPopupShow(templateReady, target);\n      });\n    }\n  };\n\n  QuickPopups.prototype.quickPopupShow = function (templateReady, target) {\n    if (templateReady.header && templateReady.content && templateReady.footer) {\n      this.beforeQuickPopupOpen(target, true);\n    }\n  };\n\n  QuickPopups.prototype.resetQuickPopupTemplates = function () {\n    if (isBlazor() && this.isQuickInfoTemplates()) {\n      removeClass([this.quickPopup.element], cls.POPUP_OPEN);\n      addClass([this.quickPopup.element], cls.POPUP_CLOSE);\n\n      if (this.parent.quickInfoTemplates.header) {\n        resetBlazorTemplate(this.parent.element.id + '_headerTemplate', 'HeaderTemplate');\n      }\n\n      if (this.parent.quickInfoTemplates.content) {\n        resetBlazorTemplate(this.parent.element.id + '_contentTemplate', 'ContentTemplate');\n      }\n\n      if (this.parent.quickInfoTemplates.footer) {\n        resetBlazorTemplate(this.parent.element.id + '_footerTemplate', 'FooterTemplate');\n      }\n    }\n  };\n\n  QuickPopups.prototype.quickPopupClose = function () {\n    this.resetQuickPopupTemplates();\n    this.parent.eventBase.focusElement();\n    this.quickPopup.relateTo = cls.WORK_CELLS_CLASS;\n    this.fieldValidator.destroyToolTip();\n\n    if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n      this.fieldValidator.destroy();\n    }\n\n    this.destroyButtons();\n    util.removeChildren(this.quickPopup.element);\n  };\n\n  QuickPopups.prototype.morePopupOpen = function () {\n    if (this.parent.isAdaptive) {\n      this.morePopup.element.style.top = '0px';\n      this.morePopup.element.style.left = '0px';\n      this.morePopup.element.style.height = formatUnit(window.innerHeight);\n      return;\n    }\n\n    this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS).focus();\n    this.morePopup.refreshPosition();\n  };\n\n  QuickPopups.prototype.morePopupClose = function () {\n    var moreWrapper = this.parent.element.querySelector('.' + cls.MORE_EVENT_WRAPPER_CLASS);\n\n    if (moreWrapper) {\n      remove(moreWrapper);\n    }\n  };\n\n  QuickPopups.prototype.popupClose = function () {\n    this.isCrudAction = false;\n    this.quickPopupHide(true);\n  };\n\n  QuickPopups.prototype.quickPopupHide = function (hideAnimation) {\n    var _this = this;\n\n    if (!this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n      return;\n    }\n\n    var isCellPopup = this.quickPopup.element.querySelector('.' + cls.CELL_POPUP_CLASS);\n    var popupData;\n\n    if (isCellPopup) {\n      var formvalidator = this.quickPopup.element.querySelector('.e-formvalidator');\n\n      if (this.isCrudAction && formvalidator && !formvalidator.ej2_instances[0].validate()) {\n        return;\n      }\n\n      var fields = this.parent.eventFields;\n      var saveObj = this.parent.eventWindow.getObjectFromFormData(cls.POPUP_WRAPPER_CLASS);\n      this.parent.eventWindow.setDefaultValueToObject(saveObj);\n      saveObj[fields.id] = this.parent.eventBase.getEventMaxID();\n      saveObj[fields.startTime] = this.parent.activeCellsData.startTime;\n      saveObj[fields.endTime] = this.parent.activeCellsData.endTime;\n      saveObj[fields.isAllDay] = this.parent.activeCellsData.isAllDay;\n\n      if (this.parent.resourceBase) {\n        this.parent.resourceBase.setResourceValues(saveObj);\n      }\n\n      popupData = saveObj;\n    } else {\n      popupData = this.parent.activeEventData.event;\n    }\n\n    var isEventPopup = this.quickPopup.element.querySelector('.' + cls.EVENT_POPUP_CLASS);\n    var args = {\n      type: this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo',\n      cancel: false,\n      data: popupData,\n      element: this.quickPopup.element,\n      target: isCellPopup ? this.parent.activeCellsData.element : this.parent.activeEventData.element\n    };\n    this.parent.trigger(event.popupClose, args, function (popupCloseArgs) {\n      popupCloseArgs = _this.serializingData(popupCloseArgs);\n\n      if (!popupCloseArgs.cancel) {\n        if (_this.quickPopup.element.classList.contains('e-popup-open')) {\n          if (isCellPopup && _this.isCrudAction) {\n            _this.parent.currentAction = 'Add';\n\n            _this.parent.crudModule.addEvent(popupCloseArgs.data);\n          }\n\n          if (hideAnimation) {\n            var animation = _this.quickPopup.hideAnimation;\n            _this.quickPopup.hideAnimation = null;\n\n            _this.quickPopup.hide();\n\n            _this.quickPopup.hideAnimation = animation;\n          } else {\n            _this.quickPopup.hide();\n          }\n\n          _this.isMultipleEventSelect = false;\n          _this.isCrudAction = false;\n        }\n      }\n    });\n  };\n\n  QuickPopups.prototype.serializingData = function (popupCloseArgs) {\n    if (isBlazor()) {\n      var eventFields = this.parent.eventFields;\n\n      if (popupCloseArgs.data) {\n        var eventObj = popupCloseArgs.data;\n        eventObj[eventFields.startTime] = this.parent.getDateTime(eventObj[eventFields.startTime]);\n        eventObj[eventFields.endTime] = this.parent.getDateTime(eventObj[eventFields.endTime]);\n      }\n\n      if (popupCloseArgs.element) {\n        popupCloseArgs.element = getElement(popupCloseArgs.element);\n      }\n\n      if (popupCloseArgs.target) {\n        popupCloseArgs.target = getElement(popupCloseArgs.target);\n      }\n    }\n\n    return popupCloseArgs;\n  };\n\n  QuickPopups.prototype.navigationClick = function (e) {\n    var navigateEle = closest(e.target, '.' + cls.NAVIGATE_CLASS);\n\n    if (!isNullOrUndefined(navigateEle)) {\n      var date = this.parent.getDateFromElement(e.currentTarget);\n\n      if (this.parent.isServerRenderer()) {\n        date = new Date(+date - date.getTimezoneOffset() * 60000);\n      }\n\n      if (!isNullOrUndefined(date)) {\n        this.closeClick();\n        this.parent.setScheduleProperties({\n          selectedDate: date\n        });\n        this.parent.changeView(this.parent.getNavigateView(), e);\n      }\n    }\n  };\n\n  QuickPopups.prototype.documentClick = function (e) {\n    var target = e.event.target;\n    var classNames = '.' + cls.POPUP_WRAPPER_CLASS + ',.' + cls.HEADER_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS + ',.' + cls.WORK_CELLS_CLASS + ',.' + cls.APPOINTMENT_CLASS + ',.e-popup';\n\n    if (closest(target, '.' + cls.APPOINTMENT_CLASS + ',.' + cls.HEADER_CELLS_CLASS)) {\n      this.parent.removeNewEventElement();\n    }\n\n    if (!closest(target, classNames)) {\n      this.quickPopupHide();\n      this.parent.removeNewEventElement();\n    }\n\n    if (!closest(target, '.' + cls.MORE_POPUP_WRAPPER_CLASS) && !target.classList.contains(cls.MORE_INDICATOR_CLASS) && !closest(target, '.' + cls.POPUP_OPEN) && !closest(target, '.' + cls.WORK_CELLS_CLASS)) {\n      this.morePopup.hide();\n    }\n  };\n\n  QuickPopups.prototype.onClosePopup = function () {\n    this.quickPopupHide();\n    this.parent.eventBase.focusElement();\n  };\n\n  QuickPopups.prototype.addEventListener = function () {\n    this.parent.on(event.cellClick, this.cellClick, this);\n    this.parent.on(event.eventClick, this.eventClick, this);\n    this.parent.on(event.documentClick, this.documentClick, this);\n    this.parent.on(event.dataReady, this.updateMoreEventContent, this);\n  };\n\n  QuickPopups.prototype.removeEventListner = function () {\n    this.parent.off(event.cellClick, this.cellClick);\n    this.parent.off(event.eventClick, this.eventClick);\n    this.parent.off(event.documentClick, this.documentClick);\n    this.parent.off(event.dataReady, this.updateMoreEventContent);\n  };\n\n  QuickPopups.prototype.destroyButtons = function () {\n    var buttonCollections = [].slice.call(this.quickPopup.element.querySelectorAll('.e-control.e-btn'));\n    buttonCollections.forEach(function (button) {\n      var instance = button.ej2_instances[0];\n\n      if (instance) {\n        instance.destroy();\n      }\n    });\n  };\n\n  QuickPopups.prototype.refreshQuickDialog = function () {\n    if (this.quickDialog.element) {\n      this.quickDialog.destroy();\n      remove(this.quickDialog.element);\n      this.quickDialog.element = null;\n    }\n\n    this.renderQuickDialog();\n  };\n\n  QuickPopups.prototype.refreshQuickPopup = function () {\n    if (this.quickPopup.element) {\n      this.quickPopup.destroy();\n      remove(this.quickPopup.element);\n      this.quickPopup.element = null;\n    }\n\n    this.renderQuickPopup();\n  };\n\n  QuickPopups.prototype.refreshMorePopup = function () {\n    if (this.morePopup.element) {\n      this.morePopup.destroy();\n      remove(this.morePopup.element);\n      this.morePopup.element = null;\n    }\n\n    this.renderMorePopup();\n  };\n\n  QuickPopups.prototype.destroy = function () {\n    if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n      this.fieldValidator.destroy();\n    }\n\n    this.removeEventListner();\n    this.destroyButtons();\n    this.quickPopup.destroy();\n    remove(this.quickPopup.element);\n    this.morePopup.destroy();\n    remove(this.morePopup.element);\n\n    if (this.quickDialog.element) {\n      this.quickDialog.destroy();\n      remove(this.quickDialog.element);\n      this.quickDialog.element = null;\n    }\n  };\n\n  return QuickPopups;\n}();\n\nexport { QuickPopups };","map":{"version":3,"sources":["D:/developing/projects/whiteboard/node_modules/@syncfusion/ej2-schedule/src/schedule/popups/quick-popups.js"],"names":["closest","EventHandler","isNullOrUndefined","formatUnit","append","isBlazor","addClass","removeClass","createElement","remove","extend","updateBlazorTemplate","resetBlazorTemplate","getElement","Dialog","Popup","isCollide","Button","Input","FieldValidator","event","cls","util","EVENT_FIELD","QuickPopups","parent","isMultipleEventSelect","isCrudAction","l10n","localeObj","fieldValidator","render","addEventListener","prototype","renderQuickPopup","renderMorePopup","renderQuickDialog","quickPopupWrapper","className","POPUP_WRAPPER_CLASS","isAdaptive","document","body","appendChild","DEVICE_CLASS","element","quickPopup","targetType","enableRtl","open","quickPopupOpen","bind","close","quickPopupClose","hideAnimation","name","duration","showAnimation","collision","X","Y","position","viewPortElement","zIndex","isStringTemplate","moreEventPopup","MORE_EVENT_POPUP_CLASS","MORE_EVENT_HEADER_CLASS","MORE_EVENT_CLOSE_CLASS","getConstant","MORE_EVENT_DATE_HEADER_CLASS","MORE_EVENT_HEADER_DAY_CLASS","MORE_EVENT_HEADER_DATE_CLASS","NAVIGATE_CLASS","moreEventWrapper","MORE_POPUP_WRAPPER_CLASS","innerHTML","morePopup","morePopupOpen","morePopupClose","closeButton","querySelector","renderButton","ICON","CLOSE_ICON_CLASS","closeClick","add","navigationClick","buttonModel","cssClass","isPrimary","click","dialogButtonClick","eventSettings","editFollowingEvents","followingSeriesButton","splice","quickDialog","animationSettings","effect","buttons","QUICK_DIALOG_CLASS","closeOnEscape","beforeClose","beforeQuickDialogClose","isModal","showCloseIcon","target","visible","width","dialogElement","id","appendTo","okButton","QUICK_DIALOG_ALERT_OK","setAttribute","cancelButton","QUICK_DIALOG_ALERT_CANCEL","iconName","isDisabled","clickEvent","buttonObj","disabled","iconCss","quickDialogClass","action","classList","QUICK_DIALOG_OCCURRENCE_CLASS","QUICK_DIALOG_SERIES_CLASS","QUICK_DIALOG_DELETE_CLASS","QUICK_DIALOG_CANCEL_CLASS","QUICK_DIALOG_ALERT_BTN_CLASS","DISABLE_CLASS","followingEventButton","QUICK_DIALOG_ALERT_FOLLOWING","FOLLOWING_EVENTS_DIALOG","QUICK_DIALOG_FOLLOWING_EVENTS_CLASS","applyFormValidation","form","FORM_CLASS","rules","fields","subject","validation","renderFormValidator","openRecurrenceAlert","editDeleteOnly","currentAction","editFollowingEventsOnly","editDeleteSeries","content","header","activeEvent","activeEventData","eventFields","recurrenceID","showQuickDialog","openRecurrenceValidationAlert","type","dialogCancel","enableRecurrenceValidation","openDeleteAlert","activeViewOptions","readonly","length","openValidationError","eventData","popupType","_this","dataBind","eventProp","cancel","data","trigger","popupOpen","popupArgs","show","createMoreEventList","eventCollection","groupOrder","groupIndex","moreEventContentEle","MORE_EVENT_CONTENT_CLASS","moreEventWrapperEle","MORE_EVENT_WRAPPER_CLASS","_loop_1","eventText","this_1","default","appointmentEle","APPOINTMENT_CLASS","attrs","Guid","eventBase","getReadonlyAttribute","getAnnocementString","templateElement","eventTemplate","tempId","eventTemplateName","templateArgs","addLocalOffsetToEvent","getAppointmentTemplate","SUBJECT_CLASS","group","resources","recurrenceRule","iconClass","EVENT_RECURRENCE_ICON_CLASS","EVENT_RECURRENCE_EDIT_ICON_CLASS","args","eventRendered","eventArgs","wireAppointmentEvents","applyResourceColor","_i","eventCollection_1","tapHoldEventPopup","e","selectedElements","getSelectedEventElements","getSelectedEvents","guid","getAttribute","eventObj","getEventByGuid","eventTitle","MULTIPLE_EVENT_POPUP_CLASS","POPUP_HEADER_CLASS","CLOSE_CLASS","EDIT_CLASS","DELETE_CLASS","closeIcon","isReadonly","editIcon","EDIT_ICON_CLASS","editClick","deleteIcon","DELETE_ICON_CLASS","deleteClick","beforeQuickPopupOpen","isCellBlocked","tempObj","startTime","activeCellsData","endTime","isAllDay","targetCell","Array","parseInt","resourceBase","setResourceValues","isNaN","isBlockRange","cellClick","date","Date","getTime","showQuickInfo","allowAdding","currentView","isMinMaxDate","setHours","quickPopupHide","targetEle","newEventClone","NEW_EVENT_CLASS","WORK_CELLS_CLASS","ALLDAY_CELLS_CLASS","HEADER_CELLS_CLASS","contains","MORE_INDICATOR_CLASS","isSameTarget","relateTo","POPUP_OPEN","subjectElement_1","focus","resetQuickPopupTemplates","temp","quickCellPopup","CELL_POPUP_CLASS","getPopupHeader","getPopupContent","getPopupFooter","subjectElement","createInput","properties","placeholder","popupClose","moreButton","QUICK_POPUP_EVENT_DETAILS_CLASS","detailsClick","saveButton","EVENT_CREATE_CLASS","saveClick","hide","isSameEventClick","events","editButton","EDIT_EVENT_CLASS","isQuickTemplate","quickInfoTemplates","templateType","eventClick","eventTooltip","updateTapHoldEventPopup","quickEventPopup","EVENT_POPUP_CLASS","editAction","allowEditing","deleteAction","allowDeleting","buttonClass","deleteButton","DELETE_EVENT_CLASS","headerType","headerData","headerTemplate","headerArgs","elementType","toLowerCase","startTimeValue","addLocalOffset","endTimeValue","templateId","headerTemp","slice","call","getQuickInfoTemplatesHeader","POPUP_HEADER_ICON_WRAPPER","getFormattedString","SUBJECT_WRAP","TEXT_ELLIPSIS","eventSubject","templateWrapper","childNodes","contentTemplate","POPUP_CONTENT_CLASS","contentArgs","contentTemp","getQuickInfoTemplatesContent","resourceText","getResourceText","cellDetails","POPUP_TABLE_CLASS","DATE_TIME_CLASS","DATE_TIME_ICON_CLASS","DATE_TIME_DETAILS_CLASS","details","RESOURCE_CLASS","RESOURCE_ICON_CLASS","RESOURCE_DETAILS_CLASS","args_1","DATE_TIME_WRAPPER_CLASS","RECURRENCE_SUMMARY_CLASS","getRecurrenceSummary","location","LOCATION_CLASS","LOCATION_ICON_CLASS","LOCATION_DETAILS_CLASS","startTimezone","endTimezone","TIME_ZONE_CLASS","TIME_ZONE_ICON_CLASS","TIME_ZONE_DETAILS_CLASS","getTimezone","description","DESCRIPTION_CLASS","DESCRIPTION_ICON_CLASS","DESCRIPTION_DETAILS_CLASS","resourceCollection","footerType","footerData","footerTemplate","POPUP_FOOTER_CLASS","footer","footerArgs","footerTemp","getQuickInfoTemplatesFooter","resourceValue","resourceCollection_1","resourceData","dataSource","resourceIndex_1","eventData_1","forEach","resource","index","idField","field","textField","lastResource_1","i","isArray","resNames_1","lastResourceData_1","map","value","findIndexInData","text","push","join","argsData","resourceDetails","lastResourceLevel","startDate","endDate","format","startDateDetails","getDateFormat","endDateDetails","getHours","getMinutes","addDays","startTimeDetail","getTimeString","endTimeDetail","spanLength","getDate","MS_PER_DAY","moreEventClick","selectedDate","toString","day","globalize","formatDate","calendar","getCalendarMode","capitalizeFirstWord","dateElement","moreEventElements","CURRENTDATE_CLASS","resetTime","getCurrentTime","indexOf","gIndex","tdDate","getMsFromDate","CONTENT_WRAP_CLASS","updateEventTemplates","subjectEle","destroyToolTip","eventWindow","openEditor","updateMoreEventContent","filteredEvents","filterEvents","eventsProcessed","moreElement","cancelBtn","crudModule","deleteEvent","getParentEvent","uiStateValues","isIgnoreOccurrence","eventSave","titleContent","HIDDEN_CLASS","zoneDetails","recurrenceEditor","getRecurrenceEditorInstance","ruleSummary","getRuleSummary","charAt","toUpperCase","skeletonString","formatString","skeleton","getDataFromTarget","cellsData","convertToEventData","popupCloseArgs","serializingData","focusElement","success","isQuickInfoTemplates","updateQuickPopupTemplates","isEventPopup","destroyButtons","removeChildren","display","style","removeAttribute","height","window","innerHeight","offsetX","refreshPosition","collide","offsetWidth","leftCollide","virtualScrollModule","translateY","getTranslateY","offsetY","applyEventColor","colorField","color","colorEle","footerEle","offsetParent","borderLeftColor","match","backgroundColor","top","editElement","templateReady","quickPopupShow","POPUP_CLOSE","querySelectorAll","destroy","left","moreWrapper","isCellPopup","popupData","formvalidator","ej2_instances","validate","saveObj","getObjectFromFormData","setDefaultValueToObject","getEventMaxID","addEvent","animation","getDateTime","navigateEle","getDateFromElement","currentTarget","isServerRenderer","getTimezoneOffset","setScheduleProperties","changeView","getNavigateView","documentClick","classNames","removeNewEventElement","onClosePopup","on","dataReady","removeEventListner","off","buttonCollections","button","instance","refreshQuickDialog","refreshQuickPopup","refreshMorePopup"],"mappings":"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","sourcesContent":["import { closest, EventHandler, isNullOrUndefined, formatUnit, append, isBlazor } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, createElement, remove, extend, updateBlazorTemplate, resetBlazorTemplate } from '@syncfusion/ej2-base';\nimport { getElement } from '@syncfusion/ej2-base';\nimport { Dialog, Popup, isCollide } from '@syncfusion/ej2-popups';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { Input } from '@syncfusion/ej2-inputs';\nimport { FieldValidator } from './form-validator';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\nimport * as util from '../base/util';\nvar EVENT_FIELD = 'e-field';\n/**\n * Quick Popups interactions\n */\nvar QuickPopups = /** @class */ (function () {\n    /**\n     * Constructor for QuickPopups\n     */\n    function QuickPopups(parent) {\n        this.isMultipleEventSelect = false;\n        this.isCrudAction = false;\n        this.parent = parent;\n        this.l10n = this.parent.localeObj;\n        this.fieldValidator = new FieldValidator();\n        this.render();\n        this.addEventListener();\n    }\n    QuickPopups.prototype.render = function () {\n        this.renderQuickPopup();\n        this.renderMorePopup();\n        this.renderQuickDialog();\n    };\n    QuickPopups.prototype.renderQuickPopup = function () {\n        var quickPopupWrapper = createElement('div', { className: cls.POPUP_WRAPPER_CLASS + ' e-popup-close' });\n        if (this.parent.isAdaptive) {\n            document.body.appendChild(quickPopupWrapper);\n            addClass([quickPopupWrapper], cls.DEVICE_CLASS);\n        }\n        else {\n            this.parent.element.appendChild(quickPopupWrapper);\n        }\n        this.quickPopup = new Popup(quickPopupWrapper, {\n            targetType: (this.parent.isAdaptive ? 'container' : 'relative'),\n            enableRtl: this.parent.enableRtl,\n            open: this.quickPopupOpen.bind(this),\n            close: this.quickPopupClose.bind(this),\n            hideAnimation: (this.parent.isAdaptive ? { name: 'ZoomOut' } : { name: 'FadeOut', duration: 150 }),\n            showAnimation: (this.parent.isAdaptive ? { name: 'ZoomIn' } : { name: 'FadeIn', duration: 150 }),\n            collision: (this.parent.isAdaptive ? { X: 'fit', Y: 'fit' } :\n                (this.parent.enableRtl ? { X: 'flip', Y: 'fit' } : { X: 'none', Y: 'fit' })),\n            position: (this.parent.isAdaptive || this.parent.enableRtl ? { X: 'left', Y: 'top' } : { X: 'right', Y: 'top' }),\n            viewPortElement: (this.parent.isAdaptive ? document.body : this.parent.element),\n            zIndex: (this.parent.isAdaptive ? 1004 : 3)\n        });\n        this.quickPopup.isStringTemplate = true;\n    };\n    QuickPopups.prototype.renderMorePopup = function () {\n        var moreEventPopup = \"<div class=\\\"\" + cls.MORE_EVENT_POPUP_CLASS + \"\\\"><div class=\\\"\" + cls.MORE_EVENT_HEADER_CLASS + \"\\\">\" +\n            (\"<div class=\\\"\" + cls.MORE_EVENT_CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\" tabindex=\\\"0\\\"></div>\") +\n            (\"<div class=\\\"\" + cls.MORE_EVENT_DATE_HEADER_CLASS + \"\\\"><div class=\\\"\" + cls.MORE_EVENT_HEADER_DAY_CLASS + \"\\\"></div>\") +\n            (\"<div class=\\\"\" + cls.MORE_EVENT_HEADER_DATE_CLASS + \" \" + cls.NAVIGATE_CLASS + \"\\\" tabindex=\\\"0\\\"></div></div></div></div>\");\n        var moreEventWrapper = createElement('div', {\n            className: cls.MORE_POPUP_WRAPPER_CLASS + ' e-popup-close',\n            innerHTML: moreEventPopup\n        });\n        if (this.parent.isAdaptive) {\n            document.body.appendChild(moreEventWrapper);\n            addClass([moreEventWrapper], cls.DEVICE_CLASS);\n        }\n        else {\n            this.parent.element.appendChild(moreEventWrapper);\n        }\n        this.morePopup = new Popup(moreEventWrapper, {\n            targetType: (this.parent.isAdaptive ? 'container' : 'relative'),\n            enableRtl: this.parent.enableRtl,\n            hideAnimation: { name: 'ZoomOut', duration: 300 },\n            showAnimation: { name: 'ZoomIn', duration: 300 },\n            open: this.morePopupOpen.bind(this),\n            close: this.morePopupClose.bind(this),\n            collision: (this.parent.isAdaptive ? { X: 'fit', Y: 'fit' } :\n                (this.parent.enableRtl ? { X: 'flip', Y: 'fit' } : { X: 'flip', Y: 'flip' })),\n            viewPortElement: (this.parent.isAdaptive ? document.body : this.parent.element),\n            zIndex: (this.parent.isAdaptive ? 1002 : 2)\n        });\n        this.morePopup.isStringTemplate = true;\n        var closeButton = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CLOSE_CLASS);\n        this.renderButton('e-round', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeButton, this.closeClick);\n        EventHandler.add(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS), 'click', this.navigationClick, this);\n    };\n    QuickPopups.prototype.renderQuickDialog = function () {\n        var buttonModel = [\n            { buttonModel: { cssClass: 'e-quick-alertok e-flat', isPrimary: true }, click: this.dialogButtonClick.bind(this) },\n            { buttonModel: { cssClass: 'e-quick-alertcancel e-flat', isPrimary: false }, click: this.dialogButtonClick.bind(this) },\n            {\n                buttonModel: { cssClass: 'e-quick-dialog-cancel e-disable e-flat', isPrimary: false },\n                click: this.dialogButtonClick.bind(this)\n            }\n        ];\n        if (this.parent.eventSettings.editFollowingEvents) {\n            var followingSeriesButton = {\n                buttonModel: { cssClass: 'e-quick-alertfollowing e-flat', isPrimary: false }, click: this.dialogButtonClick.bind(this)\n            };\n            buttonModel.splice(1, 0, followingSeriesButton);\n        }\n        this.quickDialog = new Dialog({\n            animationSettings: { effect: 'Zoom' },\n            buttons: buttonModel,\n            cssClass: cls.QUICK_DIALOG_CLASS,\n            closeOnEscape: true,\n            enableRtl: this.parent.enableRtl,\n            beforeClose: this.beforeQuickDialogClose.bind(this),\n            isModal: true,\n            position: { X: 'center', Y: 'center' },\n            showCloseIcon: true,\n            target: document.body,\n            visible: false,\n            width: 'auto'\n        });\n        var dialogElement = createElement('div', { id: this.parent.element.id + 'QuickDialog' });\n        this.parent.element.appendChild(dialogElement);\n        this.quickDialog.appendTo(dialogElement);\n        this.quickDialog.isStringTemplate = true;\n        var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        if (okButton) {\n            okButton.setAttribute('aria-label', this.l10n.getConstant('occurrence'));\n            okButton.setAttribute('aria-label', okButton.innerHTML);\n        }\n        var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        if (cancelButton) {\n            cancelButton.setAttribute('aria-label', this.l10n.getConstant('series'));\n            cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n        }\n        if (this.quickDialog.element.querySelector('.e-dlg-closeicon-btn')) {\n            this.quickDialog.element.querySelector('.e-dlg-closeicon-btn').setAttribute('title', this.l10n.getConstant('close'));\n        }\n    };\n    QuickPopups.prototype.renderButton = function (className, iconName, isDisabled, element, clickEvent) {\n        var buttonObj = new Button({\n            cssClass: className,\n            disabled: isDisabled,\n            enableRtl: this.parent.enableRtl,\n            iconCss: iconName\n        });\n        buttonObj.appendTo(element);\n        buttonObj.isStringTemplate = true;\n        EventHandler.add(element, 'click', clickEvent, this);\n    };\n    QuickPopups.prototype.quickDialogClass = function (action) {\n        var classList = [\n            cls.QUICK_DIALOG_OCCURRENCE_CLASS, cls.QUICK_DIALOG_SERIES_CLASS, cls.QUICK_DIALOG_DELETE_CLASS,\n            cls.QUICK_DIALOG_CANCEL_CLASS, cls.QUICK_DIALOG_ALERT_BTN_CLASS, cls.DISABLE_CLASS\n        ];\n        var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        var followingEventButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n        removeClass([okButton, cancelButton], classList);\n        addClass([this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_CANCEL_CLASS)], cls.DISABLE_CLASS);\n        if (this.parent.eventSettings.editFollowingEvents) {\n            addClass([followingEventButton], cls.DISABLE_CLASS);\n            removeClass([this.quickDialog.element], cls.FOLLOWING_EVENTS_DIALOG);\n        }\n        switch (action) {\n            case 'Recurrence':\n                addClass([okButton], cls.QUICK_DIALOG_OCCURRENCE_CLASS);\n                addClass([cancelButton], cls.QUICK_DIALOG_SERIES_CLASS);\n                if (this.parent.eventSettings.editFollowingEvents) {\n                    removeClass([followingEventButton], cls.DISABLE_CLASS);\n                    addClass([this.quickDialog.element], cls.FOLLOWING_EVENTS_DIALOG);\n                    addClass([followingEventButton], cls.QUICK_DIALOG_FOLLOWING_EVENTS_CLASS);\n                }\n                break;\n            case 'Delete':\n                addClass([okButton], cls.QUICK_DIALOG_DELETE_CLASS);\n                addClass([cancelButton], cls.QUICK_DIALOG_CANCEL_CLASS);\n                break;\n            case 'Alert':\n                addClass([okButton], [cls.QUICK_DIALOG_ALERT_OK, cls.QUICK_DIALOG_ALERT_BTN_CLASS]);\n                addClass([cancelButton], [cls.QUICK_DIALOG_ALERT_CANCEL, cls.DISABLE_CLASS]);\n                break;\n        }\n    };\n    QuickPopups.prototype.applyFormValidation = function () {\n        var form = this.quickPopup.element.querySelector('.' + cls.FORM_CLASS);\n        var rules = {};\n        rules[this.parent.eventSettings.fields.subject.name] = this.parent.eventSettings.fields.subject.validation;\n        this.fieldValidator.renderFormValidator(form, rules, this.quickPopup.element);\n    };\n    QuickPopups.prototype.openRecurrenceAlert = function () {\n        var editDeleteOnly = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        if (editDeleteOnly) {\n            editDeleteOnly.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteEvent' : 'editEvent');\n            editDeleteOnly.setAttribute('aria-label', editDeleteOnly.innerHTML);\n        }\n        var editFollowingEventsOnly = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n        if (editFollowingEventsOnly) {\n            editFollowingEventsOnly.innerHTML = this.l10n.getConstant('editFollowingEvent');\n            editFollowingEventsOnly.setAttribute('aria-label', editFollowingEventsOnly.innerHTML);\n        }\n        var editDeleteSeries = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        if (editDeleteSeries) {\n            editDeleteSeries.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteSeries' : 'editSeries');\n            editDeleteSeries.setAttribute('aria-label', editDeleteSeries.innerHTML);\n        }\n        this.quickDialog.content = this.l10n.getConstant('editContent');\n        this.quickDialog.header = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteTitle' : 'editTitle');\n        this.quickDialogClass('Recurrence');\n        var activeEvent = this.parent.activeEventData.event;\n        if (this.parent.eventSettings.editFollowingEvents && this.parent.currentAction === 'EditOccurrence'\n            && !isNullOrUndefined(activeEvent[this.parent.eventFields.recurrenceID]) && activeEvent[this.parent.eventFields.recurrenceID]\n            !== activeEvent[this.parent.eventFields.id]) {\n            var followingEventButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_FOLLOWING);\n            addClass([followingEventButton], cls.DISABLE_CLASS);\n        }\n        this.showQuickDialog('RecurrenceAlert');\n    };\n    QuickPopups.prototype.openRecurrenceValidationAlert = function (type) {\n        this.quickDialogClass('Alert');\n        var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        okButton.innerHTML = this.l10n.getConstant('ok');\n        okButton.setAttribute('aria-label', okButton.innerHTML);\n        var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        cancelButton.innerHTML = this.l10n.getConstant('cancel');\n        cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n        this.quickDialog.header = this.l10n.getConstant('alert');\n        switch (type) {\n            case 'wrongPattern':\n                addClass([cancelButton], cls.DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('wrongPattern');\n                break;\n            case 'createError':\n                addClass([cancelButton], cls.DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('createError');\n                break;\n            case 'sameDayAlert':\n                addClass([cancelButton], cls.DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('sameDayAlert');\n                break;\n            case 'seriesChangeAlert':\n                var dialogCancel = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_CANCEL_CLASS);\n                removeClass([cancelButton, dialogCancel], cls.DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('seriesChangeAlert');\n                okButton.innerHTML = this.l10n.getConstant('yes');\n                cancelButton.innerHTML = this.l10n.getConstant('no');\n                dialogCancel.innerHTML = this.l10n.getConstant('cancel');\n                break;\n        }\n        if ((!this.parent.enableRecurrenceValidation && type === 'wrongPattern') || this.parent.enableRecurrenceValidation) {\n            this.showQuickDialog('RecurrenceValidationAlert');\n        }\n    };\n    QuickPopups.prototype.openDeleteAlert = function () {\n        if (this.parent.activeViewOptions.readonly) {\n            return;\n        }\n        var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        if (okButton) {\n            okButton.innerHTML = this.l10n.getConstant('delete');\n            okButton.setAttribute('aria-label', okButton.innerHTML);\n        }\n        var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        if (cancelButton) {\n            cancelButton.innerHTML = this.l10n.getConstant('cancel');\n            cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n        }\n        this.quickDialog.content = (this.parent.activeEventData.event.length > 1) ?\n            this.l10n.getConstant('deleteMultipleContent') : this.l10n.getConstant('deleteContent');\n        this.quickDialog.header = (this.parent.activeEventData.event.length > 1) ?\n            this.l10n.getConstant('deleteMultipleEvent') : this.l10n.getConstant('deleteEvent');\n        this.quickDialogClass('Delete');\n        this.showQuickDialog('DeleteAlert');\n    };\n    QuickPopups.prototype.openValidationError = function (type, eventData) {\n        this.quickDialog.header = this.l10n.getConstant('alert');\n        this.quickDialog.content = this.l10n.getConstant(type);\n        var okButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_OK);\n        if (okButton) {\n            okButton.innerHTML = this.l10n.getConstant('ok');\n            okButton.setAttribute('aria-label', okButton.innerHTML);\n        }\n        var cancelButton = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        if (cancelButton) {\n            cancelButton.innerHTML = this.l10n.getConstant('cancel');\n            okButton.setAttribute('aria-label', cancelButton.innerHTML);\n        }\n        this.quickDialogClass('Alert');\n        this.showQuickDialog('ValidationAlert', eventData);\n    };\n    QuickPopups.prototype.showQuickDialog = function (popupType, eventData) {\n        var _this = this;\n        this.quickDialog.dataBind();\n        var eventProp = {\n            type: popupType, cancel: false, data: extend({}, (eventData || this.parent.activeEventData.event), null, true),\n            element: this.quickDialog.element\n        };\n        this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n            if (!popupArgs.cancel) {\n                _this.quickDialog.show();\n            }\n        });\n    };\n    QuickPopups.prototype.createMoreEventList = function (eventCollection, groupOrder, groupIndex) {\n        var _this = this;\n        var fields = this.parent.eventFields;\n        var moreEventContentEle = createElement('div', { className: cls.MORE_EVENT_CONTENT_CLASS });\n        var moreEventWrapperEle = createElement('div', { className: cls.MORE_EVENT_WRAPPER_CLASS });\n        if (eventCollection.length === 0) {\n            moreEventWrapperEle = createElement('div', {\n                className: cls.MORE_EVENT_CONTENT_CLASS,\n                innerHTML: this.l10n.getConstant('emptyContainer')\n            });\n        }\n        else {\n            var _loop_1 = function (eventData) {\n                var eventText = (eventData[fields.subject] || this_1.parent.eventSettings.fields.subject.default);\n                var appointmentEle = createElement('div', {\n                    className: cls.APPOINTMENT_CLASS,\n                    attrs: {\n                        'data-id': '' + eventData[fields.id],\n                        'data-guid': eventData.Guid, 'role': 'button', 'tabindex': '0',\n                        'aria-readonly': this_1.parent.eventBase.getReadonlyAttribute(eventData),\n                        'aria-selected': 'false', 'aria-grabbed': 'true', 'aria-label': this_1.parent.getAnnocementString(eventData)\n                    }\n                });\n                var templateElement = void 0;\n                if (!isNullOrUndefined(this_1.parent.activeViewOptions.eventTemplate)) {\n                    var tempId = this_1.parent.element.id + '_' + this_1.parent.activeViewOptions.eventTemplateName + 'eventTemplate';\n                    var templateArgs = util.addLocalOffsetToEvent(eventData, this_1.parent.eventFields);\n                    templateElement = this_1.parent.getAppointmentTemplate()(templateArgs, this_1.parent, 'eventTemplate', tempId, false);\n                    append(templateElement, appointmentEle);\n                }\n                else {\n                    appointmentEle.appendChild(createElement('div', { className: cls.SUBJECT_CLASS, innerHTML: eventText }));\n                }\n                if (this_1.parent.activeViewOptions.group.resources.length > 0) {\n                    appointmentEle.setAttribute('data-group-index', groupIndex);\n                }\n                if (!isNullOrUndefined(eventData[fields.recurrenceRule])) {\n                    var iconClass = (eventData[fields.id] === eventData[fields.recurrenceID]) ?\n                        cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n                    appointmentEle.appendChild(createElement('div', { className: cls.ICON + ' ' + iconClass }));\n                }\n                var args = { data: eventData, element: appointmentEle, cancel: false };\n                this_1.parent.trigger(event.eventRendered, args, function (eventArgs) {\n                    if (!eventArgs.cancel) {\n                        moreEventWrapperEle.appendChild(appointmentEle);\n                        _this.parent.eventBase.wireAppointmentEvents(appointmentEle, eventData, _this.parent.isAdaptive);\n                        _this.parent.eventBase.applyResourceColor(appointmentEle, eventData, 'backgroundColor', groupOrder);\n                    }\n                });\n            };\n            var this_1 = this;\n            for (var _i = 0, eventCollection_1 = eventCollection; _i < eventCollection_1.length; _i++) {\n                var eventData = eventCollection_1[_i];\n                _loop_1(eventData);\n            }\n        }\n        moreEventContentEle.appendChild(moreEventWrapperEle);\n        return moreEventContentEle;\n    };\n    QuickPopups.prototype.tapHoldEventPopup = function (e) {\n        var target = closest(e.target, '.' + cls.APPOINTMENT_CLASS);\n        this.isMultipleEventSelect = false;\n        this.parent.selectedElements = [];\n        this.isMultipleEventSelect = true;\n        this.parent.eventBase.getSelectedEventElements(target);\n        this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n        var guid = target.getAttribute('data-guid');\n        var eventObj = this.parent.eventBase.getEventByGuid(guid);\n        if (isNullOrUndefined(eventObj)) {\n            return;\n        }\n        var eventTitle = (eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle'));\n        var eventTemplate = \"<div class=\\\"\" + cls.MULTIPLE_EVENT_POPUP_CLASS + \"\\\"><div class=\\\"\" + cls.POPUP_HEADER_CLASS + \"\\\">\" +\n            (\"<button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\"></button>\") +\n            (\"<div class=\\\"\" + cls.SUBJECT_CLASS + \"\\\">\" + eventTitle + \"</div>\") +\n            (\"<button class=\\\"\" + cls.EDIT_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\"></button>\") +\n            (\"<button class=\\\"\" + cls.DELETE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\"></button></div></div>\");\n        this.quickPopup.element.innerHTML = eventTemplate;\n        var closeIcon = this.quickPopup.element.querySelector('.' + cls.CLOSE_CLASS);\n        this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.closeClick);\n        var readonly = this.parent.activeViewOptions.readonly || eventObj[this.parent.eventFields.isReadonly];\n        var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n        this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.EDIT_ICON_CLASS, readonly, editIcon, this.editClick);\n        var deleteIcon = this.quickPopup.element.querySelector('.' + cls.DELETE_CLASS);\n        this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.DELETE_ICON_CLASS, readonly, deleteIcon, this.deleteClick);\n        this.beforeQuickPopupOpen(target);\n    };\n    QuickPopups.prototype.isCellBlocked = function (args) {\n        var tempObj = {};\n        tempObj[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n        tempObj[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n        tempObj[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            var targetCell = args.element instanceof Array ? args.element[0] : args.element;\n            var groupIndex = parseInt(targetCell.getAttribute('data-group-index'), 10);\n            this.parent.resourceBase.setResourceValues(tempObj, isNaN(groupIndex) ? null : groupIndex);\n        }\n        return this.parent.eventBase.isBlockRange(tempObj);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    QuickPopups.prototype.cellClick = function (args) {\n        var date = new Date(args.startTime.getTime());\n        if (!this.parent.showQuickInfo || !this.parent.eventSettings.allowAdding ||\n            this.parent.currentView === 'MonthAgenda' || this.isCellBlocked(args) ||\n            !this.parent.isMinMaxDate(new Date(date.setHours(0, 0, 0, 0)))) {\n            this.quickPopupHide();\n            return;\n        }\n        var targetEle = args.event.target;\n        if (this.parent.isAdaptive) {\n            this.quickPopupHide();\n            var newEventClone = this.parent.element.querySelector('.' + cls.NEW_EVENT_CLASS);\n            if (isNullOrUndefined(newEventClone)) {\n                newEventClone = createElement('div', {\n                    className: cls.NEW_EVENT_CLASS,\n                    innerHTML: \"<div class=\\\"e-title\\\">+ \" + this.l10n.getConstant('newEvent') + \"</div>\"\n                });\n            }\n            var targetCell = closest(targetEle, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS);\n            if (targetCell) {\n                targetCell.appendChild(newEventClone);\n            }\n            return;\n        }\n        var target = closest(targetEle, '.' + cls.WORK_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS + ',.' +\n            cls.HEADER_CELLS_CLASS);\n        if (isNullOrUndefined(target) || targetEle.classList.contains(cls.MORE_INDICATOR_CLASS)) {\n            return;\n        }\n        var isSameTarget = this.quickPopup.relateTo === target;\n        if (isSameTarget && this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n            var subjectElement_1 = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n            if (subjectElement_1) {\n                subjectElement_1.focus();\n            }\n            return;\n        }\n        this.resetQuickPopupTemplates();\n        var temp = {};\n        temp[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n        temp[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n        temp[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n        var quickCellPopup = createElement('div', { className: cls.CELL_POPUP_CLASS });\n        quickCellPopup.appendChild(this.getPopupHeader('Cell', temp));\n        quickCellPopup.appendChild(this.getPopupContent('Cell', args, temp));\n        quickCellPopup.appendChild(this.getPopupFooter('Cell', temp));\n        var subjectElement = quickCellPopup.querySelector('.' + cls.SUBJECT_CLASS);\n        if (subjectElement) {\n            Input.createInput({ element: subjectElement, properties: { placeholder: this.l10n.getConstant('addTitle') } });\n        }\n        var closeIcon = quickCellPopup.querySelector('.' + cls.CLOSE_CLASS);\n        if (closeIcon) {\n            this.renderButton('e-flat e-round e-small', cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n        }\n        var moreButton = quickCellPopup.querySelector('.' + cls.QUICK_POPUP_EVENT_DETAILS_CLASS);\n        if (moreButton) {\n            this.renderButton('e-flat', '', false, moreButton, this.detailsClick);\n        }\n        var saveButton = quickCellPopup.querySelector('.' + cls.EVENT_CREATE_CLASS);\n        if (saveButton) {\n            this.renderButton('e-flat e-primary', '', this.parent.activeViewOptions.readonly, saveButton, this.saveClick);\n        }\n        this.quickPopup.content = quickCellPopup;\n        this.quickPopup.dataBind();\n        this.applyFormValidation();\n        if (this.morePopup) {\n            this.morePopup.hide();\n        }\n        this.quickPopup.relateTo = target;\n        this.beforeQuickPopupOpen(target);\n    };\n    QuickPopups.prototype.isSameEventClick = function (events) {\n        var isSameTarget = this.quickPopup.relateTo === closest(events.element, '.' + cls.APPOINTMENT_CLASS);\n        if (isSameTarget && this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n            var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n            if (editIcon) {\n                editIcon.focus();\n            }\n            if (!this.parent.isAdaptive) {\n                var editButton = this.quickPopup.element.querySelector('.' + cls.EDIT_EVENT_CLASS);\n                if (editButton) {\n                    editButton.focus();\n                }\n            }\n            return true;\n        }\n        return false;\n    };\n    QuickPopups.prototype.isQuickTemplate = function (type) {\n        return this.parent.quickInfoTemplates.templateType === 'Both' || this.parent.quickInfoTemplates.templateType === type;\n    };\n    QuickPopups.prototype.eventClick = function (events) {\n        if (this.parent.eventTooltip) {\n            this.parent.eventTooltip.close();\n        }\n        if (!this.parent.showQuickInfo) {\n            return;\n        }\n        if (this.parent.isAdaptive && this.isMultipleEventSelect) {\n            this.updateTapHoldEventPopup(closest(events.element, '.' + cls.APPOINTMENT_CLASS));\n        }\n        else {\n            var isSameTarget = this.isSameEventClick(events);\n            if (isSameTarget) {\n                return;\n            }\n            this.resetQuickPopupTemplates();\n            var eventData = events.event;\n            var quickEventPopup = createElement('div', { className: cls.EVENT_POPUP_CLASS });\n            quickEventPopup.appendChild(this.getPopupHeader('Event', eventData));\n            quickEventPopup.appendChild(this.getPopupContent('Event', events, eventData));\n            quickEventPopup.appendChild(this.getPopupFooter('Event', eventData));\n            var readonly = this.parent.activeViewOptions.readonly || eventData[this.parent.eventFields.isReadonly];\n            var editAction = !this.parent.eventSettings.allowEditing || readonly;\n            var deleteAction = !this.parent.eventSettings.allowDeleting || readonly;\n            var editIcon = quickEventPopup.querySelector('.' + cls.EDIT_CLASS);\n            var buttonClass = 'e-flat e-round e-small';\n            if (editIcon) {\n                this.renderButton(buttonClass, cls.ICON + ' ' + cls.EDIT_ICON_CLASS, editAction, editIcon, this.editClick);\n            }\n            var deleteIcon = quickEventPopup.querySelector('.' + cls.DELETE_CLASS);\n            if (deleteIcon) {\n                this.renderButton(buttonClass, cls.ICON + ' ' + cls.DELETE_ICON_CLASS, deleteAction, deleteIcon, this.deleteClick);\n            }\n            var closeIcon = quickEventPopup.querySelector('.' + cls.CLOSE_CLASS);\n            if (closeIcon) {\n                this.renderButton(buttonClass, cls.ICON + ' ' + cls.CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n            }\n            var editButton = quickEventPopup.querySelector('.' + cls.EDIT_EVENT_CLASS);\n            if (editButton) {\n                this.renderButton('e-flat e-primary', '', editAction, editButton, this.editClick);\n            }\n            var deleteButton = quickEventPopup.querySelector('.' + cls.DELETE_EVENT_CLASS);\n            if (deleteButton) {\n                this.renderButton('e-flat', '', deleteAction, deleteButton, this.deleteClick);\n            }\n            this.quickPopup.content = quickEventPopup;\n            this.quickPopup.dataBind();\n            if (this.morePopup && !closest(events.element, '.' + cls.MORE_EVENT_WRAPPER_CLASS)) {\n                this.morePopup.hide();\n            }\n            this.quickPopup.relateTo = this.parent.isAdaptive ? document.body :\n                closest(events.element, '.' + cls.APPOINTMENT_CLASS);\n            this.beforeQuickPopupOpen(events.element);\n        }\n    };\n    QuickPopups.prototype.getPopupHeader = function (headerType, headerData) {\n        var headerTemplate = createElement('div', { className: cls.POPUP_HEADER_CLASS });\n        if (this.isQuickTemplate(headerType) && this.parent.quickInfoTemplates.header) {\n            var headerArgs = extend({}, headerData, !isBlazor() ? { elementType: headerType.toLowerCase() } :\n                { elementType: headerType.toLowerCase(),\n                    startTimeValue: util.addLocalOffset(headerData[this.parent.eventFields.startTime]),\n                    endTimeValue: util.addLocalOffset(headerData[this.parent.eventFields.endTime])\n                }, true);\n            var templateId = this.parent.element.id;\n            var headerTemp = [].slice.call(this.parent.getQuickInfoTemplatesHeader()(headerArgs, this.parent, 'header', templateId + '_headerTemplate', false));\n            append([].slice.call(headerTemp), headerTemplate);\n        }\n        else {\n            var header = void 0;\n            switch (headerType) {\n                case 'Cell':\n                    header = \"<div class=\\\"\" + cls.POPUP_HEADER_ICON_WRAPPER + \"\\\"><button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\" +\n                        (\"\\\"\" + this.l10n.getConstant('close') + \"\\\"></button></div>\");\n                    break;\n                case 'Event':\n                    var args = this.getFormattedString(headerData);\n                    header = \"<div class=\\\"\" + cls.POPUP_HEADER_ICON_WRAPPER + \"\\\">\" +\n                        (\"<button class=\\\"\" + (cls.EDIT_CLASS + ' ' + cls.ICON) + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\"></button>\") +\n                        (\"<button class=\\\"\" + (cls.DELETE_CLASS + ' ' + cls.ICON) + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\"></button>\") +\n                        (\"<button class=\\\"\" + cls.CLOSE_CLASS + \"\\\" title=\\\"\" + this.l10n.getConstant('close') + \"\\\"></button></div>\") +\n                        (\"<div class=\\\"\" + cls.SUBJECT_WRAP + \"\\\"><div class=\\\"\" + cls.SUBJECT_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" \") +\n                        (\"title=\\\"\" + args.eventSubject + \"\\\">\" + args.eventSubject + \"</div></div >\");\n                    break;\n            }\n            var templateWrapper = createElement('div', { innerHTML: header });\n            append([].slice.call(templateWrapper.childNodes), headerTemplate);\n        }\n        return headerTemplate;\n    };\n    QuickPopups.prototype.getPopupContent = function (type, args, data) {\n        var contentTemplate = createElement('div', { className: cls.POPUP_CONTENT_CLASS });\n        if (this.isQuickTemplate(type) && this.parent.quickInfoTemplates.content) {\n            var contentArgs = extend({}, data, !isBlazor() ? { elementType: type.toLowerCase() } :\n                { elementType: type.toLowerCase(),\n                    startTimeValue: util.addLocalOffset(data[this.parent.eventFields.startTime]),\n                    endTimeValue: util.addLocalOffset(data[this.parent.eventFields.endTime])\n                }, true);\n            var templateId = this.parent.element.id;\n            var contentTemp = [].slice.call(this.parent.getQuickInfoTemplatesContent()(contentArgs, this.parent, 'content', templateId + '_contentTemplate', false));\n            append([].slice.call(contentTemp), contentTemplate);\n        }\n        else {\n            var content = void 0;\n            var resourceText = this.getResourceText(args, type.toLowerCase());\n            switch (type) {\n                case 'Cell':\n                    var cellDetails = this.getFormattedString(data);\n                    content = \"<table class=\\\"\" + cls.POPUP_TABLE_CLASS + \"\\\"><tbody><tr><td><form class=\\\"\" + cls.FORM_CLASS + \"\\\" onsubmit=\" +\n                        (\"\\\"return false;\\\"><input class=\\\"\" + cls.SUBJECT_CLASS + \" \" + EVENT_FIELD + \"\\\" type=\\\"text\\\" name=\") +\n                        (\"\\\"\" + this.parent.eventFields.subject + \"\\\" /></form></td></tr><tr><td><div class=\\\"\" + cls.DATE_TIME_CLASS + \"\\\">\") +\n                        (\"<div class=\\\"\" + cls.DATE_TIME_ICON_CLASS + \" \" + cls.ICON + \"\\\"></div><div class=\\\"\" + cls.DATE_TIME_DETAILS_CLASS + \" \") +\n                        (cls.TEXT_ELLIPSIS + \"\\\">\" + cellDetails.details + \"</div></div>\") +\n                        ((this.parent.activeViewOptions.group.resources.length > 0 ? \"<div class=\\\"\" + cls.RESOURCE_CLASS + \"\\\">\" +\n                            (\"<div class=\\\"\" + cls.RESOURCE_ICON_CLASS + \" \" + cls.ICON + \" \\\"></div><div class=\\\"\" + cls.RESOURCE_DETAILS_CLASS + \" \") +\n                            (cls.TEXT_ELLIPSIS + \"\\\">\" + resourceText + \"</div></div>\") : '') + \"</td></tr></tbody></table>\");\n                    break;\n                case 'Event':\n                    var args_1 = this.getFormattedString(data);\n                    content = '<div class=\"' + cls.DATE_TIME_CLASS + '\"><div class=\"' + cls.DATE_TIME_ICON_CLASS + ' ' + cls.ICON +\n                        '\"></div><div class=\"' + cls.DATE_TIME_WRAPPER_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\"><div class=\"' +\n                        cls.DATE_TIME_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' + args_1.details + '</div>';\n                    if (data[this.parent.eventFields.recurrenceRule]) {\n                        content += '<div class=\"' + cls.RECURRENCE_SUMMARY_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' +\n                            this.getRecurrenceSummary(data) + '</div>';\n                    }\n                    content += '</div></div>';\n                    if (data[this.parent.eventFields.location]) {\n                        content += '<div class=\"' + cls.LOCATION_CLASS + '\"><div class=\"' + cls.LOCATION_ICON_CLASS + ' ' +\n                            cls.ICON + '\"></div><div class=\"' + cls.LOCATION_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' +\n                            data[this.parent.eventFields.location] + '</div></div>';\n                    }\n                    if (data[this.parent.eventFields.startTimezone] || data[this.parent.eventFields.endTimezone]) {\n                        content += '<div class=\"' + cls.TIME_ZONE_CLASS + '\"><div class=\"' + cls.TIME_ZONE_ICON_CLASS + ' ' + cls.ICON +\n                            '\"></div><div class=\"' + cls.TIME_ZONE_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' +\n                            this.getTimezone(data) + '</div></div>';\n                    }\n                    if (data[this.parent.eventFields.description]) {\n                        content += '<div class=\"' + cls.DESCRIPTION_CLASS + '\"><div class=\"' + cls.DESCRIPTION_ICON_CLASS + ' ' + cls.ICON +\n                            '\"></div><div class=\"' + cls.DESCRIPTION_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' +\n                            data[this.parent.eventFields.description] + '</div></div>';\n                    }\n                    if (this.parent.resourceCollection.length > 0) {\n                        content += '<div class=\"' + cls.RESOURCE_CLASS + '\"><div class=\"' + cls.RESOURCE_ICON_CLASS + ' ' + cls.ICON +\n                            '\"></div><div class=\"' + cls.RESOURCE_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS + '\">' +\n                            resourceText + '</div></div>';\n                    }\n                    break;\n            }\n            var templateWrapper = createElement('div', { innerHTML: content });\n            append([].slice.call(templateWrapper.childNodes), contentTemplate);\n        }\n        return contentTemplate;\n    };\n    QuickPopups.prototype.getPopupFooter = function (footerType, footerData) {\n        var footerTemplate = createElement('div', { className: cls.POPUP_FOOTER_CLASS });\n        if (this.isQuickTemplate(footerType) && this.parent.quickInfoTemplates.footer) {\n            var footerArgs = extend({}, footerData, !isBlazor() ? { elementType: footerType.toLowerCase() } :\n                { elementType: footerType.toLowerCase(),\n                    startTimeValue: util.addLocalOffset(footerData[this.parent.eventFields.startTime]),\n                    endTimeValue: util.addLocalOffset(footerData[this.parent.eventFields.endTime])\n                }, true);\n            var templateId = this.parent.element.id;\n            var footerTemp = [].slice.call(this.parent.getQuickInfoTemplatesFooter()(footerArgs, this.parent, 'footer', templateId + '_footerTemplate', false));\n            append([].slice.call(footerTemp), footerTemplate);\n        }\n        else {\n            var footer = void 0;\n            switch (footerType) {\n                case 'Cell':\n                    footer = \"<button class=\\\"\" + (cls.QUICK_POPUP_EVENT_DETAILS_CLASS + ' ' + cls.TEXT_ELLIPSIS) + \"\\\" title=\" +\n                        (\"\\\"\" + this.l10n.getConstant('moreDetails') + \"\\\">\" + this.l10n.getConstant('moreDetails') + \"</button>\") +\n                        (\"<button class=\\\"\" + cls.EVENT_CREATE_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('save') + \"\\\">\") +\n                        (this.l10n.getConstant('save') + \"</button>\");\n                    break;\n                case 'Event':\n                    footer = \"\" + (this.parent.isAdaptive ? '' : \"<button class=\\\"\" + cls.EDIT_EVENT_CLASS + \" \" +\n                        (cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('edit') + \"\\\">\" + this.l10n.getConstant('edit') + \"</button>\") +\n                        (\"<button class=\\\"\" + cls.DELETE_EVENT_CLASS + \" \" + cls.TEXT_ELLIPSIS + \"\\\" title=\\\"\" + this.l10n.getConstant('delete') + \"\\\">\") +\n                        (this.l10n.getConstant('delete') + \"</button>\"));\n                    break;\n            }\n            var templateWrapper = createElement('div', { innerHTML: footer });\n            append([].slice.call(templateWrapper.childNodes), footerTemplate);\n        }\n        return footerTemplate;\n    };\n    QuickPopups.prototype.getResourceText = function (args, type) {\n        if (this.parent.resourceCollection.length === 0) {\n            return null;\n        }\n        var resourceValue = '';\n        if (this.parent.activeViewOptions.group.resources.length === 0) {\n            var resourceCollection_1 = this.parent.resourceBase.resourceCollection.slice(-1)[0];\n            var resourceData = resourceCollection_1.dataSource;\n            var resourceIndex_1 = 0;\n            var eventData_1 = args.event;\n            resourceData.forEach(function (resource, index) {\n                if (resource[resourceCollection_1.idField] === eventData_1[resourceCollection_1.field]) {\n                    resourceIndex_1 = index;\n                }\n            });\n            resourceValue = resourceData[resourceIndex_1][resourceCollection_1.textField];\n        }\n        else {\n            if (type === 'event') {\n                var eventData = args.event;\n                var resourceData = void 0;\n                var lastResource_1;\n                for (var i = this.parent.resourceBase.resourceCollection.length - 1; i >= 0; i--) {\n                    resourceData = eventData[this.parent.resourceBase.resourceCollection[i].field];\n                    if (!isNullOrUndefined(resourceData)) {\n                        lastResource_1 = this.parent.resourceBase.resourceCollection[i];\n                        break;\n                    }\n                }\n                if (!Array.isArray(resourceData)) {\n                    resourceData = [resourceData];\n                }\n                var resNames_1 = [];\n                var lastResourceData_1 = lastResource_1.dataSource;\n                resourceData.map(function (value) {\n                    var i = util.findIndexInData(lastResourceData_1, lastResource_1.idField, value);\n                    var text = lastResourceData_1[i][lastResource_1.textField];\n                    if (text) {\n                        resNames_1.push(text);\n                    }\n                });\n                resourceValue = resNames_1.join(', ');\n            }\n            else {\n                var argsData = args;\n                var groupIndex = !isNullOrUndefined(argsData.groupIndex) ? argsData.groupIndex : 0;\n                var resourceDetails = this.parent.resourceBase.lastResourceLevel[groupIndex];\n                resourceValue = resourceDetails.resourceData[resourceDetails.resource.textField];\n            }\n        }\n        return resourceValue;\n    };\n    QuickPopups.prototype.getFormattedString = function (eventData) {\n        var fields = this.parent.eventFields;\n        var eventSubject = (eventData[fields.subject] || this.l10n.getConstant('noTitle'));\n        var startDate = eventData[fields.startTime];\n        var endDate = eventData[fields.endTime];\n        var format = 'MMMM d, y';\n        var startDateDetails = this.getDateFormat(startDate, 'long', format);\n        var endDateDetails = (eventData[fields.isAllDay] && endDate.getHours() === 0 && endDate.getMinutes() === 0) ?\n            this.getDateFormat(util.addDays(new Date(endDate.getTime()), -1), 'long', format) :\n            this.getDateFormat(endDate, 'long', format);\n        var startTimeDetail = this.parent.getTimeString(startDate);\n        var endTimeDetail = this.parent.getTimeString(endDate);\n        var details = '';\n        var spanLength = endDate.getDate() !== startDate.getDate() &&\n            (endDate.getTime() - startDate.getTime()) / (60 * 60 * 1000) < 24 ? 1 : 0;\n        if (eventData[fields.isAllDay]) {\n            details = startDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n            if (((endDate.getTime() - startDate.getTime()) / util.MS_PER_DAY) > 1) {\n                details += '&nbsp;-&nbsp;' + endDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n            }\n        }\n        else if ((((endDate.getTime() - startDate.getTime()) / util.MS_PER_DAY) >= 1) || spanLength > 0) {\n            details = startDateDetails + ' (' + startTimeDetail + ')' + '&nbsp;-&nbsp;' + endDateDetails + ' (' + endTimeDetail + ')';\n        }\n        else {\n            details = startDateDetails + ' (' + (startTimeDetail + '&nbsp;-&nbsp;' + endTimeDetail) + ')';\n        }\n        return { eventSubject: eventSubject, details: details };\n    };\n    QuickPopups.prototype.moreEventClick = function (data, endDate, groupIndex) {\n        var _this = this;\n        this.quickPopupHide(true);\n        var moreEventContentEle = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CONTENT_CLASS);\n        if (moreEventContentEle) {\n            remove(moreEventContentEle);\n        }\n        var selectedDate = ((data.date).getTime()).toString();\n        var target = closest(data.element, '.' + cls.MORE_INDICATOR_CLASS + ',.' + cls.WORK_CELLS_CLASS);\n        var day = this.parent.globalize.formatDate(data.date, { format: 'E', calendar: this.parent.getCalendarMode() });\n        this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DAY_CLASS).innerHTML = util.capitalizeFirstWord(day, 'single');\n        var dateElement = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS);\n        dateElement.innerHTML = this.getDateFormat(data.date, 'd', 'd');\n        dateElement.setAttribute('data-date', selectedDate);\n        dateElement.setAttribute('data-end-date', endDate.getTime().toString());\n        var groupOrder;\n        if (!isNullOrUndefined(groupIndex)) {\n            dateElement.setAttribute('data-group-index', groupIndex);\n            groupOrder = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)].groupOrder;\n        }\n        var moreEventElements = this.createMoreEventList(data.event, groupOrder, groupIndex);\n        this.morePopup.element.querySelector('.' + cls.MORE_EVENT_POPUP_CLASS).appendChild(moreEventElements);\n        removeClass(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_DATE_HEADER_CLASS).childNodes, cls.CURRENTDATE_CLASS);\n        if (util.resetTime(data.date).getTime() === util.resetTime(this.parent.getCurrentTime()).getTime()) {\n            addClass(this.morePopup.element.querySelector('.' + cls.MORE_EVENT_DATE_HEADER_CLASS).childNodes, cls.CURRENTDATE_CLASS);\n        }\n        if (!this.parent.isAdaptive) {\n            if (this.parent.currentView.indexOf('Timeline') !== -1) {\n                var gIndex = target.getAttribute('data-group-index');\n                var startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n                startDate.setHours(startDate.getHours(), startDate.getMinutes(), 0);\n                var tdDate = this.parent.getMsFromDate(startDate).toString();\n                if (isNullOrUndefined(gIndex)) {\n                    this.morePopup.relateTo = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS +\n                        ' tbody tr td[data-date=\"' + tdDate + '\"]');\n                }\n                else {\n                    this.morePopup.relateTo = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS +\n                        ' tbody tr td[data-group-index=\"' + gIndex + '\"][data-date=\"' + tdDate + '\"]');\n                }\n            }\n            else {\n                this.morePopup.relateTo = closest(target, '.' + cls.WORK_CELLS_CLASS);\n            }\n        }\n        this.parent.updateEventTemplates();\n        var eventProp = { type: 'EventContainer', cancel: false, element: this.morePopup.element };\n        if (!isBlazor()) {\n            eventProp.data = data;\n        }\n        this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n            if (!popupArgs.cancel) {\n                _this.morePopup.show();\n            }\n        });\n    };\n    QuickPopups.prototype.saveClick = function () {\n        this.isCrudAction = true;\n        this.quickPopupHide();\n    };\n    QuickPopups.prototype.detailsClick = function () {\n        var subjectEle = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n        if (subjectEle && subjectEle.value !== '') {\n            var args = extend(this.parent.activeCellsData, { subject: subjectEle.value });\n        }\n        this.isCrudAction = false;\n        this.fieldValidator.destroyToolTip();\n        this.quickPopupHide();\n        this.parent.eventWindow.openEditor(this.parent.activeCellsData, 'Add');\n    };\n    QuickPopups.prototype.editClick = function () {\n        this.quickPopupHide(true);\n        var data = this.parent.activeEventData.event;\n        this.parent.currentAction = 'EditSeries';\n        if (!isNullOrUndefined(data[this.parent.eventFields.recurrenceRule])) {\n            this.parent.currentAction = 'EditOccurrence';\n            this.openRecurrenceAlert();\n        }\n        else {\n            this.parent.eventWindow.openEditor(data, this.parent.currentAction);\n        }\n    };\n    QuickPopups.prototype.deleteClick = function () {\n        this.quickPopupHide(true);\n        this.parent.currentAction = 'Delete';\n        if (this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule]) {\n            this.openRecurrenceAlert();\n        }\n        else {\n            this.openDeleteAlert();\n        }\n    };\n    QuickPopups.prototype.updateMoreEventContent = function () {\n        if (this.morePopup.element.classList.contains('e-popup-close')) {\n            return;\n        }\n        var moreEventContentEle = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_CONTENT_CLASS);\n        if (moreEventContentEle) {\n            remove(moreEventContentEle);\n        }\n        var dateElement = this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS);\n        var startDate = new Date(parseInt(dateElement.getAttribute('data-date'), 10));\n        var endDate = new Date(parseInt(dateElement.getAttribute('data-end-date'), 10));\n        var groupIndex = dateElement.getAttribute('data-group-index');\n        var data;\n        var groupOrder;\n        if (!isNullOrUndefined(groupIndex)) {\n            data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n            groupOrder = data.groupOrder;\n        }\n        var filteredEvents = this.parent.eventBase.filterEvents(startDate, endDate, this.parent.eventsProcessed, data);\n        var moreElement = this.createMoreEventList(filteredEvents, groupOrder, groupIndex);\n        this.morePopup.element.querySelector('.' + cls.MORE_EVENT_POPUP_CLASS).appendChild(moreElement);\n    };\n    QuickPopups.prototype.closeClick = function () {\n        this.quickPopupHide();\n        this.morePopup.hide();\n    };\n    QuickPopups.prototype.dialogButtonClick = function (event) {\n        this.quickDialog.hide();\n        var target = event.target;\n        var cancelBtn = this.quickDialog.element.querySelector('.' + cls.QUICK_DIALOG_ALERT_CANCEL);\n        var eventData = this.parent.activeEventData.event;\n        if (target.classList.contains(cls.QUICK_DIALOG_OCCURRENCE_CLASS)) {\n            this.parent.currentAction = (this.parent.currentAction === 'Delete') ? 'DeleteOccurrence' : 'EditOccurrence';\n            switch (this.parent.currentAction) {\n                case 'EditOccurrence':\n                    this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n                    break;\n                case 'DeleteOccurrence':\n                    this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n                    break;\n            }\n        }\n        else if (target.classList.contains(cls.QUICK_DIALOG_FOLLOWING_EVENTS_CLASS)) {\n            this.parent.currentAction = (this.parent.currentAction === 'Delete') ? 'DeleteFollowingEvents' : 'EditFollowingEvents';\n            switch (this.parent.currentAction) {\n                case 'EditFollowingEvents':\n                    this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n                    break;\n                case 'DeleteFollowingEvents':\n                    this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n                    break;\n            }\n        }\n        else if (target.classList.contains(cls.QUICK_DIALOG_SERIES_CLASS)) {\n            this.parent.currentAction = (this.parent.currentAction === 'Delete') ? 'DeleteSeries' : 'EditSeries';\n            switch (this.parent.currentAction) {\n                case 'EditSeries':\n                    this.parent.eventWindow.openEditor(this.parent.eventBase.getParentEvent(eventData, true), this.parent.currentAction);\n                    break;\n                case 'DeleteSeries':\n                    this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n                    break;\n            }\n        }\n        else if (target.classList.contains(cls.QUICK_DIALOG_DELETE_CLASS)) {\n            this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n        }\n        else if (!cancelBtn.classList.contains(cls.DISABLE_CLASS) && (target.classList.contains(cls.QUICK_DIALOG_ALERT_OK) ||\n            (target.classList.contains(cls.QUICK_DIALOG_ALERT_CANCEL) && !cancelBtn.classList.contains(cls.QUICK_DIALOG_CANCEL_CLASS)))) {\n            this.parent.uiStateValues.isIgnoreOccurrence = target.classList.contains(cls.QUICK_DIALOG_ALERT_CANCEL);\n            this.parent.eventWindow.eventSave(this.l10n.getConstant('ok'));\n        }\n    };\n    QuickPopups.prototype.updateTapHoldEventPopup = function (target) {\n        var selectedElements = this.parent.eventBase.getSelectedEventElements(target);\n        this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n        if (selectedElements.length > 0) {\n            var eventObj = this.parent.eventBase.getEventByGuid(selectedElements[0].getAttribute('data-guid'));\n            var titleContent = (selectedElements.length === 1) ?\n                (eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle')) :\n                '(' + selectedElements.length + ')' + '&nbsp;' + this.l10n.getConstant('selectedItems');\n            this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS).innerHTML = titleContent;\n            if (selectedElements.length > 1) {\n                addClass([this.quickPopup.element.querySelector('.' + cls.EDIT_ICON_CLASS)], cls.HIDDEN_CLASS);\n            }\n            else {\n                removeClass([this.quickPopup.element.querySelector('.' + cls.EDIT_ICON_CLASS)], cls.HIDDEN_CLASS);\n            }\n        }\n        else {\n            this.parent.selectedElements = [];\n            this.quickPopupHide();\n        }\n    };\n    QuickPopups.prototype.getTimezone = function (event) {\n        var zoneDetails = '';\n        zoneDetails += event[this.parent.eventFields.startTimezone] || '';\n        zoneDetails += zoneDetails === '' ? '' : ' - ';\n        zoneDetails += event[this.parent.eventFields.endTimezone] || '';\n        return zoneDetails;\n    };\n    QuickPopups.prototype.getRecurrenceSummary = function (event) {\n        var recurrenceEditor = this.parent.eventWindow.getRecurrenceEditorInstance();\n        if (recurrenceEditor) {\n            var ruleSummary = recurrenceEditor.getRuleSummary(event[this.parent.eventFields.recurrenceRule]);\n            return ruleSummary.charAt(0).toUpperCase() + ruleSummary.slice(1);\n        }\n        return '';\n    };\n    QuickPopups.prototype.getDateFormat = function (date, skeletonString, formatString) {\n        return util.capitalizeFirstWord(isBlazor() ? this.parent.globalize.formatDate(date, { format: formatString, calendar: this.parent.getCalendarMode() }) :\n            this.parent.globalize.formatDate(date, { skeleton: skeletonString, calendar: this.parent.getCalendarMode() }), 'single');\n    };\n    QuickPopups.prototype.getDataFromTarget = function (target) {\n        if (target.classList.contains(cls.APPOINTMENT_CLASS)) {\n            return this.parent.activeEventData.event;\n        }\n        // Depricated cells data in quick popups\n        var eventObj = {\n            startTime: this.parent.activeCellsData.startTime,\n            endTime: this.parent.activeCellsData.endTime,\n            isAllDay: this.parent.activeCellsData.isAllDay,\n            groupIndex: this.parent.activeCellsData.groupIndex\n        };\n        var cellsData = this.parent.activeCellsData;\n        this.parent.eventWindow.convertToEventData(cellsData, eventObj);\n        return eventObj;\n    };\n    QuickPopups.prototype.beforeQuickDialogClose = function () {\n        var _this = this;\n        var args = {\n            type: (isNullOrUndefined(this.parent.activeEventData.event)) ? 'ValidationAlert' :\n                !isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule]) ? 'RecurrenceAlert' : 'DeleteAlert',\n            cancel: false, data: this.parent.activeEventData.event, element: this.quickDialog.element\n        };\n        this.parent.trigger(event.popupClose, args, function (popupCloseArgs) {\n            popupCloseArgs = _this.serializingData(popupCloseArgs);\n            if (!popupCloseArgs.cancel) {\n                _this.parent.eventBase.focusElement();\n            }\n        });\n    };\n    QuickPopups.prototype.beforeQuickPopupOpen = function (target, success) {\n        var _this = this;\n        if (isBlazor() && this.isQuickInfoTemplates() && isNullOrUndefined(success)) {\n            this.updateQuickPopupTemplates(target);\n            return;\n        }\n        var isEventPopup = this.quickPopup.element.querySelector('.' + cls.EVENT_POPUP_CLASS);\n        var popupType = this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo';\n        var eventProp = {\n            type: popupType, cancel: false, data: extend({}, this.getDataFromTarget(target), null, true),\n            target: target, element: this.quickPopup.element\n        };\n        this.parent.trigger(event.popupOpen, eventProp, function (popupArgs) {\n            if (popupArgs.cancel) {\n                _this.quickPopupHide();\n                _this.destroyButtons();\n                if (popupArgs.element.classList.contains(cls.POPUP_OPEN)) {\n                    _this.quickPopupClose();\n                }\n                _this.resetQuickPopupTemplates();\n                util.removeChildren(_this.quickPopup.element);\n                _this.isMultipleEventSelect = false;\n            }\n            else {\n                var display = _this.quickPopup.element.style.display;\n                _this.quickPopup.element.style.display = 'block';\n                if (_this.parent.isAdaptive) {\n                    _this.quickPopup.element.removeAttribute('style');\n                    _this.quickPopup.element.style.display = 'block';\n                    _this.quickPopup.element.style.height = formatUnit((popupType === 'EditEventInfo') ? 65 : window.innerHeight);\n                }\n                else {\n                    _this.quickPopup.offsetX = 10;\n                    _this.quickPopup.collision = { X: _this.parent.enableRtl ? 'flip' : 'none', Y: 'fit' };\n                    _this.quickPopup.position = { X: _this.parent.enableRtl ? 'left' : 'right', Y: 'top' };\n                    _this.quickPopup.dataBind();\n                    _this.quickPopup.refreshPosition(null, true);\n                    var collide = isCollide(_this.quickPopup.element, _this.parent.element);\n                    if (collide.indexOf(_this.parent.enableRtl ? 'left' : 'right') > -1) {\n                        _this.quickPopup.offsetX = -target.offsetWidth - 10 - _this.quickPopup.element.offsetWidth;\n                        _this.quickPopup.dataBind();\n                        var leftCollide = isCollide(_this.quickPopup.element, _this.parent.element);\n                        if (leftCollide.indexOf('left') > -1) {\n                            _this.quickPopup.position = { X: 'center', Y: 'center' };\n                            _this.quickPopup.collision = { X: 'fit', Y: 'fit' };\n                            _this.quickPopup.offsetX = -(_this.quickPopup.element.offsetWidth / 2);\n                            _this.quickPopup.dataBind();\n                        }\n                    }\n                    if (_this.parent.virtualScrollModule && (collide.indexOf('top') > -1 || collide.indexOf('bottom') > -1)) {\n                        var element = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' table');\n                        var translateY = util.getTranslateY(element);\n                        _this.quickPopup.offsetY = translateY;\n                        _this.quickPopup.dataBind();\n                    }\n                }\n                if (isEventPopup) {\n                    _this.applyEventColor();\n                }\n                _this.quickPopup.element.style.display = display;\n                _this.quickPopup.dataBind();\n                _this.quickPopup.show();\n            }\n        });\n    };\n    QuickPopups.prototype.isQuickInfoTemplates = function () {\n        if (!isNullOrUndefined(this.parent.quickInfoTemplates.header || this.parent.quickInfoTemplates.content\n            || this.parent.quickInfoTemplates.footer)) {\n            return true;\n        }\n        return false;\n    };\n    QuickPopups.prototype.applyEventColor = function () {\n        var colorField = '';\n        if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            colorField = this.parent.enableRtl ? 'border-right-color' : 'border-left-color';\n        }\n        else {\n            colorField = 'background-color';\n        }\n        // tslint:disable-next-line:no-any\n        var color = this.parent.activeEventData.element.style[colorField];\n        if (color === '') {\n            return;\n        }\n        var colorEle = this.quickPopup.element.querySelector('.' + cls.POPUP_HEADER_CLASS);\n        var footerEle = this.quickPopup.element.querySelector('.' + cls.POPUP_FOOTER_CLASS);\n        if (footerEle && footerEle.offsetParent) {\n            colorEle = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n            if (colorEle) {\n                colorEle.style.borderLeftColor = color;\n                color = \"rgba(\" + color.match(/\\d+/g).join() + \",0.3)\";\n            }\n        }\n        if (colorEle) {\n            colorEle.style.backgroundColor = color;\n        }\n    };\n    QuickPopups.prototype.quickPopupOpen = function () {\n        if (this.parent.isAdaptive) {\n            this.quickPopup.element.style.top = '0px';\n            return;\n        }\n        if (this.quickPopup.element.querySelector('.' + cls.CELL_POPUP_CLASS)) {\n            var subjectElement = this.quickPopup.element.querySelector('.' + cls.SUBJECT_CLASS);\n            if (subjectElement) {\n                subjectElement.focus();\n            }\n        }\n        else {\n            var editElement = this.quickPopup.element.querySelector('.' + cls.EDIT_EVENT_CLASS);\n            if (editElement) {\n                editElement.focus();\n            }\n            var editIcon = this.quickPopup.element.querySelector('.' + cls.EDIT_CLASS);\n            if (editIcon) {\n                editIcon.focus();\n            }\n        }\n    };\n    QuickPopups.prototype.updateQuickPopupTemplates = function (target) {\n        var _this = this;\n        var templateReady = {\n            header: this.parent.quickInfoTemplates.header ? false : true,\n            content: this.parent.quickInfoTemplates.content ? false : true,\n            footer: this.parent.quickInfoTemplates.footer ? false : true\n        };\n        if (this.parent.quickInfoTemplates.header) {\n            updateBlazorTemplate(this.parent.element.id + '_headerTemplate', 'HeaderTemplate', this.parent.quickInfoTemplates, null, function () {\n                templateReady.header = true;\n                _this.quickPopupShow(templateReady, target);\n            });\n        }\n        if (this.parent.quickInfoTemplates.content) {\n            updateBlazorTemplate(this.parent.element.id + '_contentTemplate', 'ContentTemplate', this.parent.quickInfoTemplates, null, function () {\n                templateReady.content = true;\n                _this.quickPopupShow(templateReady, target);\n            });\n        }\n        if (this.parent.quickInfoTemplates.footer) {\n            updateBlazorTemplate(this.parent.element.id + '_footerTemplate', 'FooterTemplate', this.parent.quickInfoTemplates, null, function () {\n                templateReady.footer = true;\n                _this.quickPopupShow(templateReady, target);\n            });\n        }\n    };\n    QuickPopups.prototype.quickPopupShow = function (templateReady, target) {\n        if (templateReady.header && templateReady.content && templateReady.footer) {\n            this.beforeQuickPopupOpen(target, true);\n        }\n    };\n    QuickPopups.prototype.resetQuickPopupTemplates = function () {\n        if (isBlazor() && this.isQuickInfoTemplates()) {\n            removeClass([this.quickPopup.element], cls.POPUP_OPEN);\n            addClass([this.quickPopup.element], cls.POPUP_CLOSE);\n            if (this.parent.quickInfoTemplates.header) {\n                resetBlazorTemplate(this.parent.element.id + '_headerTemplate', 'HeaderTemplate');\n            }\n            if (this.parent.quickInfoTemplates.content) {\n                resetBlazorTemplate(this.parent.element.id + '_contentTemplate', 'ContentTemplate');\n            }\n            if (this.parent.quickInfoTemplates.footer) {\n                resetBlazorTemplate(this.parent.element.id + '_footerTemplate', 'FooterTemplate');\n            }\n        }\n    };\n    QuickPopups.prototype.quickPopupClose = function () {\n        this.resetQuickPopupTemplates();\n        this.parent.eventBase.focusElement();\n        this.quickPopup.relateTo = cls.WORK_CELLS_CLASS;\n        this.fieldValidator.destroyToolTip();\n        if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n            this.fieldValidator.destroy();\n        }\n        this.destroyButtons();\n        util.removeChildren(this.quickPopup.element);\n    };\n    QuickPopups.prototype.morePopupOpen = function () {\n        if (this.parent.isAdaptive) {\n            this.morePopup.element.style.top = '0px';\n            this.morePopup.element.style.left = '0px';\n            this.morePopup.element.style.height = formatUnit(window.innerHeight);\n            return;\n        }\n        this.morePopup.element.querySelector('.' + cls.MORE_EVENT_HEADER_DATE_CLASS).focus();\n        this.morePopup.refreshPosition();\n    };\n    QuickPopups.prototype.morePopupClose = function () {\n        var moreWrapper = this.parent.element.querySelector('.' + cls.MORE_EVENT_WRAPPER_CLASS);\n        if (moreWrapper) {\n            remove(moreWrapper);\n        }\n    };\n    QuickPopups.prototype.popupClose = function () {\n        this.isCrudAction = false;\n        this.quickPopupHide(true);\n    };\n    QuickPopups.prototype.quickPopupHide = function (hideAnimation) {\n        var _this = this;\n        if (!this.quickPopup.element.classList.contains(cls.POPUP_OPEN)) {\n            return;\n        }\n        var isCellPopup = this.quickPopup.element.querySelector('.' + cls.CELL_POPUP_CLASS);\n        var popupData;\n        if (isCellPopup) {\n            var formvalidator = this.quickPopup.element.querySelector('.e-formvalidator');\n            if (this.isCrudAction && formvalidator && !formvalidator.ej2_instances[0].validate()) {\n                return;\n            }\n            var fields = this.parent.eventFields;\n            var saveObj = this.parent.eventWindow.getObjectFromFormData(cls.POPUP_WRAPPER_CLASS);\n            this.parent.eventWindow.setDefaultValueToObject(saveObj);\n            saveObj[fields.id] = this.parent.eventBase.getEventMaxID();\n            saveObj[fields.startTime] = this.parent.activeCellsData.startTime;\n            saveObj[fields.endTime] = this.parent.activeCellsData.endTime;\n            saveObj[fields.isAllDay] = this.parent.activeCellsData.isAllDay;\n            if (this.parent.resourceBase) {\n                this.parent.resourceBase.setResourceValues(saveObj);\n            }\n            popupData = saveObj;\n        }\n        else {\n            popupData = this.parent.activeEventData.event;\n        }\n        var isEventPopup = this.quickPopup.element.querySelector('.' + cls.EVENT_POPUP_CLASS);\n        var args = {\n            type: this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo',\n            cancel: false, data: popupData, element: this.quickPopup.element,\n            target: (isCellPopup ? this.parent.activeCellsData.element : this.parent.activeEventData.element)\n        };\n        this.parent.trigger(event.popupClose, args, function (popupCloseArgs) {\n            popupCloseArgs = _this.serializingData(popupCloseArgs);\n            if (!popupCloseArgs.cancel) {\n                if (_this.quickPopup.element.classList.contains('e-popup-open')) {\n                    if (isCellPopup && _this.isCrudAction) {\n                        _this.parent.currentAction = 'Add';\n                        _this.parent.crudModule.addEvent(popupCloseArgs.data);\n                    }\n                    if (hideAnimation) {\n                        var animation = _this.quickPopup.hideAnimation;\n                        _this.quickPopup.hideAnimation = null;\n                        _this.quickPopup.hide();\n                        _this.quickPopup.hideAnimation = animation;\n                    }\n                    else {\n                        _this.quickPopup.hide();\n                    }\n                    _this.isMultipleEventSelect = false;\n                    _this.isCrudAction = false;\n                }\n            }\n        });\n    };\n    QuickPopups.prototype.serializingData = function (popupCloseArgs) {\n        if (isBlazor()) {\n            var eventFields = this.parent.eventFields;\n            if (popupCloseArgs.data) {\n                var eventObj = popupCloseArgs.data;\n                eventObj[eventFields.startTime] = this.parent.getDateTime(eventObj[eventFields.startTime]);\n                eventObj[eventFields.endTime] = this.parent.getDateTime(eventObj[eventFields.endTime]);\n            }\n            if (popupCloseArgs.element) {\n                popupCloseArgs.element = getElement(popupCloseArgs.element);\n            }\n            if (popupCloseArgs.target) {\n                popupCloseArgs.target = getElement(popupCloseArgs.target);\n            }\n        }\n        return popupCloseArgs;\n    };\n    QuickPopups.prototype.navigationClick = function (e) {\n        var navigateEle = closest(e.target, '.' + cls.NAVIGATE_CLASS);\n        if (!isNullOrUndefined(navigateEle)) {\n            var date = this.parent.getDateFromElement(e.currentTarget);\n            if (this.parent.isServerRenderer()) {\n                date = new Date(+date - (date.getTimezoneOffset() * 60000));\n            }\n            if (!isNullOrUndefined(date)) {\n                this.closeClick();\n                this.parent.setScheduleProperties({ selectedDate: date });\n                this.parent.changeView(this.parent.getNavigateView(), e);\n            }\n        }\n    };\n    QuickPopups.prototype.documentClick = function (e) {\n        var target = e.event.target;\n        var classNames = '.' + cls.POPUP_WRAPPER_CLASS + ',.' + cls.HEADER_CELLS_CLASS + ',.' + cls.ALLDAY_CELLS_CLASS +\n            ',.' + cls.WORK_CELLS_CLASS + ',.' + cls.APPOINTMENT_CLASS + ',.e-popup';\n        if (closest(target, '.' + cls.APPOINTMENT_CLASS + ',.' + cls.HEADER_CELLS_CLASS)) {\n            this.parent.removeNewEventElement();\n        }\n        if (!closest(target, classNames)) {\n            this.quickPopupHide();\n            this.parent.removeNewEventElement();\n        }\n        if (!closest(target, '.' + cls.MORE_POPUP_WRAPPER_CLASS) && !target.classList.contains(cls.MORE_INDICATOR_CLASS)\n            && (!closest(target, '.' + cls.POPUP_OPEN)) && !closest(target, '.' + cls.WORK_CELLS_CLASS)) {\n            this.morePopup.hide();\n        }\n    };\n    QuickPopups.prototype.onClosePopup = function () {\n        this.quickPopupHide();\n        this.parent.eventBase.focusElement();\n    };\n    QuickPopups.prototype.addEventListener = function () {\n        this.parent.on(event.cellClick, this.cellClick, this);\n        this.parent.on(event.eventClick, this.eventClick, this);\n        this.parent.on(event.documentClick, this.documentClick, this);\n        this.parent.on(event.dataReady, this.updateMoreEventContent, this);\n    };\n    QuickPopups.prototype.removeEventListner = function () {\n        this.parent.off(event.cellClick, this.cellClick);\n        this.parent.off(event.eventClick, this.eventClick);\n        this.parent.off(event.documentClick, this.documentClick);\n        this.parent.off(event.dataReady, this.updateMoreEventContent);\n    };\n    QuickPopups.prototype.destroyButtons = function () {\n        var buttonCollections = [].slice.call(this.quickPopup.element.querySelectorAll('.e-control.e-btn'));\n        buttonCollections.forEach(function (button) {\n            var instance = button.ej2_instances[0];\n            if (instance) {\n                instance.destroy();\n            }\n        });\n    };\n    QuickPopups.prototype.refreshQuickDialog = function () {\n        if (this.quickDialog.element) {\n            this.quickDialog.destroy();\n            remove(this.quickDialog.element);\n            this.quickDialog.element = null;\n        }\n        this.renderQuickDialog();\n    };\n    QuickPopups.prototype.refreshQuickPopup = function () {\n        if (this.quickPopup.element) {\n            this.quickPopup.destroy();\n            remove(this.quickPopup.element);\n            this.quickPopup.element = null;\n        }\n        this.renderQuickPopup();\n    };\n    QuickPopups.prototype.refreshMorePopup = function () {\n        if (this.morePopup.element) {\n            this.morePopup.destroy();\n            remove(this.morePopup.element);\n            this.morePopup.element = null;\n        }\n        this.renderMorePopup();\n    };\n    QuickPopups.prototype.destroy = function () {\n        if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n            this.fieldValidator.destroy();\n        }\n        this.removeEventListner();\n        this.destroyButtons();\n        this.quickPopup.destroy();\n        remove(this.quickPopup.element);\n        this.morePopup.destroy();\n        remove(this.morePopup.element);\n        if (this.quickDialog.element) {\n            this.quickDialog.destroy();\n            remove(this.quickDialog.element);\n            this.quickDialog.element = null;\n        }\n    };\n    return QuickPopups;\n}());\nexport { QuickPopups };\n"]},"metadata":{},"sourceType":"module"}