{"ast":null,"code":"import { isNullOrUndefined, extend, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { EventTooltip } from '../popups/event-tooltip';\nimport * as events from '../base/constant';\nimport * as cls from '../base/css-constant';\nimport { VirtualScroll } from '../actions/virtual-scroll';\n/**\n * Schedule DOM rendering\n */\n\nvar Render =\n/** @class */\nfunction () {\n  /**\n   * Constructor for render\n   */\n  function Render(parent) {\n    this.parent = parent;\n  }\n\n  Render.prototype.render = function (viewName, isDataRefresh) {\n    if (isDataRefresh === void 0) {\n      isDataRefresh = true;\n    }\n\n    this.initializeLayout(viewName);\n\n    if (isDataRefresh && !this.parent.isServerRenderer()) {\n      this.refreshDataManager();\n    }\n  };\n\n  Render.prototype.initializeLayout = function (viewName) {\n    if (this.parent.activeView) {\n      this.parent.activeView.removeEventListener();\n      this.parent.activeView.destroy();\n    }\n\n    switch (viewName) {\n      case 'Day':\n        this.parent.activeView = this.parent.dayModule;\n        break;\n\n      case 'Week':\n        this.parent.activeView = this.parent.weekModule;\n        break;\n\n      case 'WorkWeek':\n        this.parent.activeView = this.parent.workWeekModule;\n        break;\n\n      case 'Month':\n        this.parent.activeView = this.parent.monthModule;\n        break;\n      // case 'Year':\n      //     this.parent.activeView = this.parent.yearModule;\n      //     break;\n\n      case 'Agenda':\n        this.parent.activeView = this.parent.agendaModule;\n        break;\n\n      case 'MonthAgenda':\n        this.parent.activeView = this.parent.monthAgendaModule;\n        break;\n\n      case 'TimelineDay':\n        this.parent.activeView = this.parent.timelineViewsModule;\n        this.parent.activeView.viewClass = 'e-timeline-day-view';\n        break;\n\n      case 'TimelineWorkWeek':\n        this.parent.activeView = this.parent.timelineViewsModule;\n        this.parent.activeView.viewClass = 'e-timeline-work-week-view';\n        break;\n\n      case 'TimelineWeek':\n        this.parent.activeView = this.parent.timelineViewsModule;\n        this.parent.activeView.viewClass = 'e-timeline-week-view';\n        break;\n\n      case 'TimelineMonth':\n        this.parent.activeView = this.parent.timelineMonthModule;\n        break;\n\n      case 'TimelineYear':\n        this.parent.activeView = this.parent.timelineYearModule;\n        break;\n    }\n\n    if (isNullOrUndefined(this.parent.activeView)) {\n      var firstView = this.parent.viewCollections[0].option;\n\n      if (firstView) {\n        this.parent.setScheduleProperties({\n          currentView: firstView\n        });\n        this.parent.onServerDataBind();\n\n        if (this.parent.headerModule) {\n          this.parent.headerModule.updateActiveView();\n          this.parent.headerModule.setCalendarView();\n        }\n\n        return this.initializeLayout(firstView);\n      }\n\n      throw Error('Inject required modules');\n    }\n\n    this.parent.activeView.viewIndex = this.parent.viewIndex;\n    this.updateLabelText(viewName);\n    this.parent.activeView.addEventListener();\n    this.parent.activeView.getRenderDates();\n    this.parent.uiStateValues.isGroupAdaptive = this.parent.isAdaptive && this.parent.activeViewOptions.group.resources.length > 0 && this.parent.activeViewOptions.group.enableCompactView;\n\n    if (this.parent.virtualScrollModule) {\n      this.parent.virtualScrollModule.destroy();\n      this.parent.virtualScrollModule = null;\n    }\n\n    if (this.parent.currentView.indexOf('Timeline') !== -1 && this.parent.activeViewOptions.allowVirtualScrolling && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.parent.virtualScrollModule = new VirtualScroll(this.parent);\n      this.parent.uiStateValues.top = 0;\n    }\n\n    this.updateHeader();\n    this.parent.activeView.renderLayout(cls.CURRENT_PANEL_CLASS);\n\n    if (this.parent.eventTooltip) {\n      this.parent.eventTooltip.destroy();\n      this.parent.eventTooltip = null;\n    }\n\n    if (this.parent.eventSettings.enableTooltip || this.parent.activeViewOptions.group.resources.length > 0 && this.parent.activeViewOptions.group.headerTooltipTemplate) {\n      this.parent.eventTooltip = new EventTooltip(this.parent);\n    }\n  };\n\n  Render.prototype.updateHeader = function () {\n    if (this.parent.headerModule) {\n      this.parent.headerModule.setDayOfWeek(this.parent.activeViewOptions.firstDayOfWeek);\n\n      if (this.parent.activeViewOptions.readonly) {\n        addClass([this.parent.element], cls.READ_ONLY);\n      } else if (this.parent.element.classList.contains(cls.READ_ONLY)) {\n        removeClass([this.parent.element], cls.READ_ONLY);\n      }\n\n      this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText());\n      this.parent.headerModule.updateHeaderItems('remove');\n    }\n  };\n\n  Render.prototype.updateLabelText = function (view) {\n    var content = this.parent.activeView.getLabelText(view);\n    this.parent.element.setAttribute('role', 'main');\n    this.parent.element.setAttribute('aria-label', content);\n  };\n\n  Render.prototype.refreshDataManager = function () {\n    var _this = this;\n\n    var start = this.parent.activeView.startDate();\n    var end = this.parent.activeView.endDate();\n    var dataManager = this.parent.dataModule.getData(this.parent.dataModule.generateQuery(start, end));\n    dataManager.then(function (e) {\n      return _this.dataManagerSuccess(e);\n    }).catch(function (e) {\n      return _this.dataManagerFailure(e);\n    });\n  };\n\n  Render.prototype.dataManagerSuccess = function (e) {\n    var _this = this;\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.trigger(events.dataBinding, e, function (args) {\n      var resultData = extend([], args.result, null, true);\n      _this.parent.eventsData = resultData.filter(function (data) {\n        return !data[_this.parent.eventFields.isBlock];\n      });\n      _this.parent.blockData = resultData.filter(function (data) {\n        return data[_this.parent.eventFields.isBlock];\n      });\n\n      var processed = _this.parent.eventBase.processData(resultData);\n\n      _this.parent.notify(events.dataReady, {\n        processedData: processed\n      });\n\n      if (_this.parent.dragAndDropModule && _this.parent.dragAndDropModule.actionObj.action === 'drag') {\n        _this.parent.dragAndDropModule.navigationWrapper();\n      }\n\n      _this.parent.renderCompleted();\n\n      _this.parent.trigger(events.dataBound, null, function () {\n        return _this.parent.hideSpinner();\n      });\n    });\n  };\n\n  Render.prototype.dataManagerFailure = function (e) {\n    var _this = this;\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.trigger(events.actionFailure, {\n      error: e\n    }, function () {\n      return _this.parent.hideSpinner();\n    });\n  };\n\n  return Render;\n}();\n\nexport { Render };","map":{"version":3,"sources":["D:/developing/projects/whiteboard/node_modules/@syncfusion/ej2-schedule/src/schedule/renderer/renderer.js"],"names":["isNullOrUndefined","extend","addClass","removeClass","EventTooltip","events","cls","VirtualScroll","Render","parent","prototype","render","viewName","isDataRefresh","initializeLayout","isServerRenderer","refreshDataManager","activeView","removeEventListener","destroy","dayModule","weekModule","workWeekModule","monthModule","agendaModule","monthAgendaModule","timelineViewsModule","viewClass","timelineMonthModule","timelineYearModule","firstView","viewCollections","option","setScheduleProperties","currentView","onServerDataBind","headerModule","updateActiveView","setCalendarView","Error","viewIndex","updateLabelText","addEventListener","getRenderDates","uiStateValues","isGroupAdaptive","isAdaptive","activeViewOptions","group","resources","length","enableCompactView","virtualScrollModule","indexOf","allowVirtualScrolling","top","updateHeader","renderLayout","CURRENT_PANEL_CLASS","eventTooltip","eventSettings","enableTooltip","headerTooltipTemplate","setDayOfWeek","firstDayOfWeek","readonly","element","READ_ONLY","classList","contains","updateDateRange","getDateRangeText","updateHeaderItems","view","content","getLabelText","setAttribute","_this","start","startDate","end","endDate","dataManager","dataModule","getData","generateQuery","then","e","dataManagerSuccess","catch","dataManagerFailure","isDestroyed","trigger","dataBinding","args","resultData","result","eventsData","filter","data","eventFields","isBlock","blockData","processed","eventBase","processData","notify","dataReady","processedData","dragAndDropModule","actionObj","action","navigationWrapper","renderCompleted","dataBound","hideSpinner","actionFailure","error"],"mappings":"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","sourcesContent":["import { isNullOrUndefined, extend, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { EventTooltip } from '../popups/event-tooltip';\nimport * as events from '../base/constant';\nimport * as cls from '../base/css-constant';\nimport { VirtualScroll } from '../actions/virtual-scroll';\n/**\n * Schedule DOM rendering\n */\nvar Render = /** @class */ (function () {\n    /**\n     * Constructor for render\n     */\n    function Render(parent) {\n        this.parent = parent;\n    }\n    Render.prototype.render = function (viewName, isDataRefresh) {\n        if (isDataRefresh === void 0) { isDataRefresh = true; }\n        this.initializeLayout(viewName);\n        if (isDataRefresh && !this.parent.isServerRenderer()) {\n            this.refreshDataManager();\n        }\n    };\n    Render.prototype.initializeLayout = function (viewName) {\n        if (this.parent.activeView) {\n            this.parent.activeView.removeEventListener();\n            this.parent.activeView.destroy();\n        }\n        switch (viewName) {\n            case 'Day':\n                this.parent.activeView = this.parent.dayModule;\n                break;\n            case 'Week':\n                this.parent.activeView = this.parent.weekModule;\n                break;\n            case 'WorkWeek':\n                this.parent.activeView = this.parent.workWeekModule;\n                break;\n            case 'Month':\n                this.parent.activeView = this.parent.monthModule;\n                break;\n            // case 'Year':\n            //     this.parent.activeView = this.parent.yearModule;\n            //     break;\n            case 'Agenda':\n                this.parent.activeView = this.parent.agendaModule;\n                break;\n            case 'MonthAgenda':\n                this.parent.activeView = this.parent.monthAgendaModule;\n                break;\n            case 'TimelineDay':\n                this.parent.activeView = this.parent.timelineViewsModule;\n                this.parent.activeView.viewClass = 'e-timeline-day-view';\n                break;\n            case 'TimelineWorkWeek':\n                this.parent.activeView = this.parent.timelineViewsModule;\n                this.parent.activeView.viewClass = 'e-timeline-work-week-view';\n                break;\n            case 'TimelineWeek':\n                this.parent.activeView = this.parent.timelineViewsModule;\n                this.parent.activeView.viewClass = 'e-timeline-week-view';\n                break;\n            case 'TimelineMonth':\n                this.parent.activeView = this.parent.timelineMonthModule;\n                break;\n            case 'TimelineYear':\n                this.parent.activeView = this.parent.timelineYearModule;\n                break;\n        }\n        if (isNullOrUndefined(this.parent.activeView)) {\n            var firstView = this.parent.viewCollections[0].option;\n            if (firstView) {\n                this.parent.setScheduleProperties({ currentView: firstView });\n                this.parent.onServerDataBind();\n                if (this.parent.headerModule) {\n                    this.parent.headerModule.updateActiveView();\n                    this.parent.headerModule.setCalendarView();\n                }\n                return this.initializeLayout(firstView);\n            }\n            throw Error('Inject required modules');\n        }\n        this.parent.activeView.viewIndex = this.parent.viewIndex;\n        this.updateLabelText(viewName);\n        this.parent.activeView.addEventListener();\n        this.parent.activeView.getRenderDates();\n        this.parent.uiStateValues.isGroupAdaptive = this.parent.isAdaptive && this.parent.activeViewOptions.group.resources.length > 0 &&\n            this.parent.activeViewOptions.group.enableCompactView;\n        if (this.parent.virtualScrollModule) {\n            this.parent.virtualScrollModule.destroy();\n            this.parent.virtualScrollModule = null;\n        }\n        if (this.parent.currentView.indexOf('Timeline') !== -1 && this.parent.activeViewOptions.allowVirtualScrolling\n            && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            this.parent.virtualScrollModule = new VirtualScroll(this.parent);\n            this.parent.uiStateValues.top = 0;\n        }\n        this.updateHeader();\n        this.parent.activeView.renderLayout(cls.CURRENT_PANEL_CLASS);\n        if (this.parent.eventTooltip) {\n            this.parent.eventTooltip.destroy();\n            this.parent.eventTooltip = null;\n        }\n        if (this.parent.eventSettings.enableTooltip || (this.parent.activeViewOptions.group.resources.length > 0\n            && this.parent.activeViewOptions.group.headerTooltipTemplate)) {\n            this.parent.eventTooltip = new EventTooltip(this.parent);\n        }\n    };\n    Render.prototype.updateHeader = function () {\n        if (this.parent.headerModule) {\n            this.parent.headerModule.setDayOfWeek(this.parent.activeViewOptions.firstDayOfWeek);\n            if (this.parent.activeViewOptions.readonly) {\n                addClass([this.parent.element], cls.READ_ONLY);\n            }\n            else if (this.parent.element.classList.contains(cls.READ_ONLY)) {\n                removeClass([this.parent.element], cls.READ_ONLY);\n            }\n            this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText());\n            this.parent.headerModule.updateHeaderItems('remove');\n        }\n    };\n    Render.prototype.updateLabelText = function (view) {\n        var content = this.parent.activeView.getLabelText(view);\n        this.parent.element.setAttribute('role', 'main');\n        this.parent.element.setAttribute('aria-label', content);\n    };\n    Render.prototype.refreshDataManager = function () {\n        var _this = this;\n        var start = this.parent.activeView.startDate();\n        var end = this.parent.activeView.endDate();\n        var dataManager = this.parent.dataModule.getData(this.parent.dataModule.generateQuery(start, end));\n        dataManager.then(function (e) { return _this.dataManagerSuccess(e); }).catch(function (e) { return _this.dataManagerFailure(e); });\n    };\n    Render.prototype.dataManagerSuccess = function (e) {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.trigger(events.dataBinding, e, function (args) {\n            var resultData = extend([], args.result, null, true);\n            _this.parent.eventsData = resultData.filter(function (data) { return !data[_this.parent.eventFields.isBlock]; });\n            _this.parent.blockData = resultData.filter(function (data) { return data[_this.parent.eventFields.isBlock]; });\n            var processed = _this.parent.eventBase.processData(resultData);\n            _this.parent.notify(events.dataReady, { processedData: processed });\n            if (_this.parent.dragAndDropModule && _this.parent.dragAndDropModule.actionObj.action === 'drag') {\n                _this.parent.dragAndDropModule.navigationWrapper();\n            }\n            _this.parent.renderCompleted();\n            _this.parent.trigger(events.dataBound, null, function () { return _this.parent.hideSpinner(); });\n        });\n    };\n    Render.prototype.dataManagerFailure = function (e) {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.trigger(events.actionFailure, { error: e }, function () { return _this.parent.hideSpinner(); });\n    };\n    return Render;\n}());\nexport { Render };\n"]},"metadata":{},"sourceType":"module"}