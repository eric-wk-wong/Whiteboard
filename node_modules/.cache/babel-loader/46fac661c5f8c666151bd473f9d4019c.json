{"ast":null,"code":"/**\n * MaskedTextBox base module\n */\nimport { EventHandler, isNullOrUndefined, merge, attributes, addClass, removeClass, Browser, extend } from '@syncfusion/ej2-base';\nimport { Input } from '../../input/input';\nvar ERROR = 'e-error';\nvar INPUTGROUP = 'e-input-group';\nvar FLOATINPUT = 'e-float-input';\nvar UTILMASK = 'e-utility-mask';\nvar TOPLABEL = 'e-label-top';\nvar BOTTOMLABEL = 'e-label-bottom';\n/**\n * @hidden\n * Built-in masking elements collection.\n */\n\nexport var regularExpressions = {\n  '0': '[0-9]',\n  '9': '[0-9 ]',\n  '#': '[0-9 +-]',\n  'L': '[A-Za-z]',\n  '?': '[A-Za-z ]',\n  '&': '[^\\x7f ]+',\n  'C': '[^\\x7f]+',\n  'A': '[A-Za-z0-9]',\n  'a': '[A-Za-z0-9 ]'\n};\n/**\n * @hidden\n * Generate required masking elements to the MaskedTextBox from user mask input.\n */\n\nexport function createMask() {\n  attributes(this.element, {\n    'role': 'textbox',\n    'autocomplete': 'off',\n    'autocorrect': 'off',\n    'autocapitalize': 'off',\n    'spellcheck': 'false',\n    'aria-live': 'assertive',\n    'aria-valuenow': ''\n  });\n\n  if (this.mask) {\n    var splitMask = this.mask.split(']');\n\n    for (var i = 0; i < splitMask.length; i++) {\n      if (splitMask[i][splitMask[i].length - 1] === '\\\\') {\n        splitMask[i] = splitMask[i] + ']';\n        var splitInnerMask = splitMask[i].split('[');\n\n        for (var j = 0; j < splitInnerMask.length; j++) {\n          if (splitInnerMask[j][splitInnerMask[j].length - 1] === '\\\\') {\n            splitInnerMask[j] = splitInnerMask[j] + '[';\n          }\n\n          pushIntoRegExpCollec.call(this, splitInnerMask[j]);\n        }\n      } else {\n        var splitInnerMask = splitMask[i].split('[');\n\n        if (splitInnerMask.length > 1) {\n          var chkSpace = false;\n\n          for (var j = 0; j < splitInnerMask.length; j++) {\n            if (splitInnerMask[j] === '\\\\') {\n              this.customRegExpCollec.push('[');\n              this.hiddenMask += splitInnerMask[j] + '[';\n            } else if (splitInnerMask[j] === '') {\n              chkSpace = true;\n            } else if (splitInnerMask[j] !== '' && chkSpace || j === splitInnerMask.length - 1) {\n              this.customRegExpCollec.push('[' + splitInnerMask[j] + ']');\n              this.hiddenMask += this.promptChar;\n              chkSpace = false;\n            } else {\n              pushIntoRegExpCollec.call(this, splitInnerMask[j]);\n            }\n          }\n        } else {\n          pushIntoRegExpCollec.call(this, splitInnerMask[0]);\n        }\n      }\n    }\n\n    this.escapeMaskValue = this.hiddenMask;\n    this.promptMask = this.hiddenMask.replace(/[09?LCAa#&]/g, this.promptChar);\n\n    if (!isNullOrUndefined(this.customCharacters)) {\n      for (var i = 0; i < this.promptMask.length; i++) {\n        if (!isNullOrUndefined(this.customCharacters[this.promptMask[i]])) {\n          this.promptMask = this.promptMask.replace(new RegExp(this.promptMask[i], 'g'), this.promptChar);\n        }\n      }\n    }\n\n    var escapeNumber = 0;\n\n    if (this.hiddenMask.match(new RegExp(/\\\\/))) {\n      for (var i = 0; i < this.hiddenMask.length; i++) {\n        var j = 0;\n\n        if (i >= 1) {\n          j = i;\n        }\n\n        escapeNumber = this.hiddenMask.length - this.promptMask.length;\n        j = j - escapeNumber;\n\n        if (i > 0 && this.hiddenMask[i - 1] !== '\\\\' && (this.hiddenMask[i] === '>' || this.hiddenMask[i] === '<' || this.hiddenMask[i] === '|')) {\n          this.promptMask = this.promptMask.substring(0, j) + this.promptMask.substring(i + 1 - escapeNumber, this.promptMask.length);\n          this.escapeMaskValue = this.escapeMaskValue.substring(0, j) + this.escapeMaskValue.substring(i + 1 - escapeNumber, this.escapeMaskValue.length);\n        }\n\n        if (this.hiddenMask[i] === '\\\\') {\n          this.promptMask = this.promptMask.substring(0, j) + this.hiddenMask[i + 1] + this.promptMask.substring(i + 2 - escapeNumber, this.promptMask.length);\n          this.escapeMaskValue = this.escapeMaskValue.substring(0, j) + this.escapeMaskValue[i + 1] + this.escapeMaskValue.substring(i + 2 - escapeNumber, this.escapeMaskValue.length);\n        }\n      }\n    } else {\n      this.promptMask = this.promptMask.replace(/[>|<]/g, '');\n      this.escapeMaskValue = this.hiddenMask.replace(/[>|<]/g, '');\n    }\n\n    attributes(this.element, {\n      'aria-invalid': 'false'\n    });\n  }\n}\n/**\n * @hidden\n * Apply mask ability with masking elements to the MaskedTextBox.\n */\n\nexport function applyMask() {\n  setElementValue.call(this, this.promptMask);\n  setMaskValue.call(this, this.value);\n}\n/**\n * @hidden\n * To wire required events to the MaskedTextBox.\n */\n\nexport function wireEvents() {\n  EventHandler.add(this.element, 'keydown', maskInputKeyDownHandler, this);\n  EventHandler.add(this.element, 'keypress', maskInputKeyPressHandler, this);\n  EventHandler.add(this.element, 'keyup', maskInputKeyUpHandler, this);\n  EventHandler.add(this.element, 'input', maskInputHandler, this);\n  EventHandler.add(this.element, 'focus', maskInputFocusHandler, this);\n  EventHandler.add(this.element, 'blur', maskInputBlurHandler, this);\n  EventHandler.add(this.element, 'paste', maskInputPasteHandler, this);\n  EventHandler.add(this.element, 'cut', maskInputCutHandler, this);\n  EventHandler.add(this.element, 'drop', maskInputDropHandler, this);\n\n  if (this.enabled) {\n    bindClearEvent.call(this);\n\n    if (this.formElement) {\n      EventHandler.add(this.formElement, 'reset', resetFormHandler, this);\n    }\n  }\n}\n/**\n * @hidden\n * To unwire events attached to the MaskedTextBox.\n */\n\nexport function unwireEvents() {\n  EventHandler.remove(this.element, 'keydown', maskInputKeyDownHandler);\n  EventHandler.remove(this.element, 'keypress', maskInputKeyPressHandler);\n  EventHandler.remove(this.element, 'keyup', maskInputKeyUpHandler);\n  EventHandler.remove(this.element, 'input', maskInputHandler);\n  EventHandler.remove(this.element, 'focus', maskInputFocusHandler);\n  EventHandler.remove(this.element, 'blur', maskInputBlurHandler);\n  EventHandler.remove(this.element, 'paste', maskInputPasteHandler);\n  EventHandler.remove(this.element, 'cut', maskInputCutHandler);\n\n  if (this.formElement) {\n    EventHandler.remove(this.formElement, 'reset', resetFormHandler);\n  }\n}\n/**\n * @hidden\n * To bind required events to the MaskedTextBox clearButton.\n */\n\nexport function bindClearEvent() {\n  if (this.showClearButton) {\n    EventHandler.add(this.inputObj.clearButton, 'mousedown touchstart', resetHandler, this);\n  }\n}\n\nfunction resetHandler(e) {\n  e.preventDefault();\n\n  if (!this.inputObj.clearButton.classList.contains('e-clear-icon-hide')) {\n    clear.call(this, e);\n    this.value = '';\n  }\n}\n\nfunction clear(event) {\n  var value = this.element.value;\n  setElementValue.call(this, this.promptMask);\n  this.redoCollec.unshift({\n    value: this.promptMask,\n    startIndex: this.element.selectionStart,\n    endIndex: this.element.selectionEnd\n  });\n  triggerMaskChangeEvent.call(this, event, value);\n  this.element.setSelectionRange(0, 0);\n}\n\nfunction resetFormHandler() {\n  if (this.element.tagName === 'EJS-MASKEDTEXTBOX') {\n    setElementValue.call(this, this.promptMask);\n  } else {\n    this.value = this.initInputValue;\n  }\n}\n/**\n * @hidden\n * To get masked value from the MaskedTextBox.\n */\n\n\nexport function unstrippedValue(element) {\n  return element.value;\n}\n/**\n * @hidden\n * To extract raw value from the MaskedTextBox.\n */\n\nexport function strippedValue(element, maskValues) {\n  var value = '';\n  var k = 0;\n  var checkMask = false;\n  var maskValue = !isNullOrUndefined(maskValues) ? maskValues : !isNullOrUndefined(element) && !isNullOrUndefined(this) ? element.value : maskValues;\n\n  if (maskValue !== this.promptMask) {\n    for (var i = 0; i < this.customRegExpCollec.length; i++) {\n      if (checkMask) {\n        checkMask = false;\n      }\n\n      if (this.customRegExpCollec[k] === '>' || this.customRegExpCollec[k] === '<' || this.customRegExpCollec[k] === '|' || this.customRegExpCollec[k] === '\\\\') {\n        --i;\n        checkMask = true;\n      }\n\n      if (!checkMask) {\n        if (maskValue[i] !== this.promptChar && !isNullOrUndefined(this.customRegExpCollec[k]) && (!isNullOrUndefined(this.regExpCollec[this.customRegExpCollec[k]]) || this.customRegExpCollec[k].length > 2 && this.customRegExpCollec[k][0] === '[' && this.customRegExpCollec[k][this.customRegExpCollec[k].length - 1] === ']' || !isNullOrUndefined(this.customCharacters) && !isNullOrUndefined(this.customCharacters[this.customRegExpCollec[k]])) && maskValue !== '') {\n          value += maskValue[i];\n        }\n      }\n\n      ++k;\n    }\n  }\n\n  if (this.mask === null || this.mask === '' && this.value !== undefined) {\n    value = maskValue;\n  }\n\n  return value;\n}\n\nfunction pushIntoRegExpCollec(value) {\n  for (var k = 0; k < value.length; k++) {\n    this.hiddenMask += value[k];\n\n    if (value[k] !== '\\\\') {\n      this.customRegExpCollec.push(value[k]);\n    }\n  }\n}\n\nexport function maskInputFocusHandler(event) {\n  var _this = this;\n\n  var eventArgs = {\n    selectionStart: 0,\n    event: event,\n    value: this.value,\n    maskedValue: this.element.value,\n    container: this.inputObj.container,\n    selectionEnd: this.promptMask.length > 0 ? this.promptMask.length : this.element.value.length\n  };\n  this.trigger('focus', eventArgs, function (eventArgs) {\n    if (_this.mask) {\n      _this.isFocus = true;\n\n      if (_this.element.value === '') {\n        setElementValue.call(_this, _this.promptMask);\n      } else {\n        setElementValue.call(_this, _this.element.value);\n      }\n\n      if (!Browser.isDevice && Browser.info.version === '11.0') {\n        _this.element.setSelectionRange(eventArgs.selectionStart, eventArgs.selectionEnd);\n      } else {\n        var delay = Browser.isDevice && Browser.isIos ? 450 : 0;\n        setTimeout(function () {\n          _this.element.setSelectionRange(eventArgs.selectionStart, eventArgs.selectionEnd);\n        }, delay);\n      }\n    }\n  });\n}\nexport function maskInputBlurHandler(event) {\n  this.blurEventArgs = {\n    event: event,\n    value: this.value,\n    maskedValue: this.element.value,\n    container: this.inputObj.container\n  };\n  this.trigger('blur', this.blurEventArgs);\n\n  if (this.mask) {\n    this.isFocus = false;\n\n    if (this.placeholder && this.element.value === this.promptMask && this.floatLabelType !== 'Always') {\n      setElementValue.call(this, '');\n      var labelElement = this.element.parentNode.querySelector('.e-float-text');\n\n      if (this.floatLabelType === 'Auto' && !isNullOrUndefined(labelElement) && labelElement.classList.contains(TOPLABEL)) {\n        removeClass([labelElement], TOPLABEL);\n      }\n    }\n  }\n}\n\nfunction maskInputPasteHandler(event) {\n  var _this = this;\n\n  if (this.mask && !this.readonly) {\n    var sIndex_1 = this.element.selectionStart;\n    var eIndex_1 = this.element.selectionEnd;\n    var oldValue_1 = this.element.value;\n    setElementValue.call(this, '');\n    this._callPasteHandler = true;\n    setTimeout(function () {\n      var value = _this.element.value.replace(/ /g, '');\n\n      if (_this.redoCollec.length > 0 && _this.redoCollec[0].value === _this.element.value) {\n        value = strippedValue.call(_this, _this.element);\n      }\n\n      setElementValue.call(_this, oldValue_1);\n      _this.element.selectionStart = sIndex_1;\n      _this.element.selectionEnd = eIndex_1;\n      var i = 0;\n      _this.maskKeyPress = true;\n\n      do {\n        validateValue.call(_this, value[i], false, null);\n        ++i;\n      } while (i < value.length);\n\n      _this.maskKeyPress = false;\n      _this._callPasteHandler = false;\n\n      if (_this.element.value === oldValue_1) {\n        var i_1 = 0;\n        _this.maskKeyPress = true;\n\n        do {\n          validateValue.call(_this, value[i_1], false, null);\n          ++i_1;\n        } while (i_1 < value.length);\n\n        _this.maskKeyPress = false;\n      } else {\n        triggerMaskChangeEvent.call(_this, event, oldValue_1);\n      }\n    }, 1);\n  }\n}\n\nfunction maskInputCutHandler(event) {\n  var _this = this;\n\n  if (this.mask && !this.readonly) {\n    var preValue_1 = this.element.value;\n    var sIndex_2 = this.element.selectionStart;\n    var eIndex = this.element.selectionEnd;\n    this.undoCollec.push({\n      value: this.element.value,\n      startIndex: this.element.selectionStart,\n      endIndex: this.element.selectionEnd\n    });\n    var value_1 = this.element.value.substring(0, sIndex_2) + this.promptMask.substring(sIndex_2, eIndex) + this.element.value.substring(eIndex);\n    setTimeout(function () {\n      setElementValue.call(_this, value_1);\n      _this.element.selectionStart = _this.element.selectionEnd = sIndex_2;\n\n      if (_this.element.value !== preValue_1) {\n        triggerMaskChangeEvent.call(_this, event, null);\n      }\n    }, 0);\n  }\n}\n\nexport function maskInputDropHandler(event) {\n  event.preventDefault();\n}\n\nfunction maskInputHandler(event) {\n  if (Browser.isIE === true && this.element.value === '' && this.floatLabelType === 'Never') {\n    return;\n  }\n\n  var eventArgs = {\n    ctrlKey: false,\n    keyCode: 229\n  }; // tslint:disable-next-line\n\n  extend(event, eventArgs);\n\n  if (this.mask) {\n    if (this.element.value === '') {\n      this.redoCollec.unshift({\n        value: this.promptMask,\n        startIndex: this.element.selectionStart,\n        endIndex: this.element.selectionEnd\n      });\n    }\n\n    if (this.element.value.length === 1) {\n      this.element.value = this.element.value + this.promptMask;\n      this.element.setSelectionRange(1, 1);\n    }\n\n    if (!this._callPasteHandler) {\n      removeMaskInputValues.call(this, event);\n    }\n\n    if (this.element.value.length > this.promptMask.length) {\n      var startIndex = this.element.selectionStart;\n      var addedValues = this.element.value.length - this.promptMask.length;\n      var value = this.element.value.substring(startIndex - addedValues, startIndex);\n      this.maskKeyPress = false;\n      var i = 0;\n\n      do {\n        validateValue.call(this, value[i], event.ctrlKey, event);\n        ++i;\n      } while (i < value.length);\n\n      if (this.element.value !== this.preEleVal) {\n        triggerMaskChangeEvent.call(this, event, null);\n      }\n    }\n\n    var val = strippedValue.call(this, this.element);\n    this.prevValue = val;\n    this.value = val;\n\n    if (val === '') {\n      setElementValue.call(this, this.promptMask);\n      this.element.setSelectionRange(0, 0);\n    }\n  }\n}\n\nfunction maskInputKeyDownHandler(event) {\n  if (this.mask && !this.readonly) {\n    var value = this;\n\n    if (event.keyCode !== 229) {\n      if (event.ctrlKey && (event.keyCode === 89 || event.keyCode === 90)) {\n        event.preventDefault();\n      }\n\n      removeMaskInputValues.call(this, event);\n    }\n\n    var startValue = this.element.value;\n\n    if (event.ctrlKey && (event.keyCode === 89 || event.keyCode === 90)) {\n      var collec = void 0;\n\n      if (event.keyCode === 90 && this.undoCollec.length > 0 && startValue !== this.undoCollec[this.undoCollec.length - 1].value) {\n        collec = this.undoCollec[this.undoCollec.length - 1];\n        this.redoCollec.unshift({\n          value: this.element.value,\n          startIndex: this.element.selectionStart,\n          endIndex: this.element.selectionEnd\n        });\n        setElementValue.call(this, collec.value);\n        this.element.selectionStart = collec.startIndex;\n        this.element.selectionEnd = collec.endIndex;\n        this.undoCollec.splice(this.undoCollec.length - 1, 1);\n      } else if (event.keyCode === 89 && this.redoCollec.length > 0 && startValue !== this.redoCollec[0].value) {\n        collec = this.redoCollec[0];\n        this.undoCollec.push({\n          value: this.element.value,\n          startIndex: this.element.selectionStart,\n          endIndex: this.element.selectionEnd\n        });\n        setElementValue.call(this, collec.value);\n        this.element.selectionStart = collec.startIndex;\n        this.element.selectionEnd = collec.endIndex;\n        this.redoCollec.splice(0, 1);\n      }\n    }\n  }\n}\n\nexport function mobileRemoveFunction() {\n  var collec;\n  var sIndex = this.element.selectionStart;\n  var eIndex = this.element.selectionEnd;\n\n  if (this.redoCollec.length > 0) {\n    collec = this.redoCollec[0];\n    setElementValue.call(this, collec.value);\n\n    if (collec.startIndex - sIndex === 1) {\n      this.element.selectionStart = collec.startIndex;\n      this.element.selectionEnd = collec.endIndex;\n    } else {\n      this.element.selectionStart = sIndex + 1;\n      this.element.selectionEnd = eIndex + 1;\n    }\n  } else {\n    setElementValue.call(this, this.promptMask);\n    this.element.selectionStart = this.element.selectionEnd = sIndex;\n  }\n}\n\nfunction autoFillMaskInputValues(isRemove, oldEventVal, event) {\n  if (event.type === 'input') {\n    isRemove = false;\n    oldEventVal = this.element.value;\n    setElementValue.call(this, this.promptMask);\n    setMaskValue.call(this, oldEventVal);\n  }\n\n  return isRemove;\n}\n\nfunction removeMaskInputValues(event) {\n  var isRemove = false;\n  var oldEventVal;\n  var isDeleted = false;\n\n  if (this.element.value.length < this.promptMask.length) {\n    isRemove = true;\n    oldEventVal = this.element.value;\n    isRemove = autoFillMaskInputValues.call(this, isRemove, oldEventVal, event);\n    mobileRemoveFunction.call(this);\n  }\n\n  if (this.element.value.length >= this.promptMask.length && event.type === 'input') {\n    isRemove = autoFillMaskInputValues.call(this, isRemove, oldEventVal, event);\n  }\n\n  var initStartIndex = this.element.selectionStart;\n  var initEndIndex = this.element.selectionEnd;\n  var startIndex = this.element.selectionStart;\n  var endIndex = this.element.selectionEnd;\n  var maskValue = this.hiddenMask.replace(/[>|\\\\<]/g, '');\n  var curMask = maskValue[startIndex - 1];\n  var parentElement = this.element.parentNode;\n\n  if (isRemove || event.keyCode === 8 || event.keyCode === 46) {\n    this.undoCollec.push({\n      value: this.element.value,\n      startIndex: this.element.selectionStart,\n      endIndex: endIndex\n    });\n    var multipleDel = false;\n    var preValue = this.element.value;\n\n    if (startIndex > 0 || (event.keyCode === 8 || event.keyCode === 46) && startIndex < this.element.value.length && this.element.selectionEnd - startIndex !== this.element.value.length) {\n      var index = startIndex;\n\n      if (startIndex !== endIndex) {\n        startIndex = endIndex;\n\n        if (event.keyCode === 46) {\n          multipleDel = true;\n        }\n      } else if (event.keyCode === 46) {\n        ++index;\n      } else {\n        --index;\n      }\n\n      for (var k = startIndex; event.keyCode === 8 || isRemove || multipleDel ? k > index : k < index; event.keyCode === 8 || isRemove || multipleDel ? k-- : k++) {\n        for (var i = startIndex; event.keyCode === 8 || isRemove || multipleDel ? i > 0 : i < this.element.value.length; event.keyCode === 8 || isRemove || multipleDel ? i-- : i++) {\n          var sIndex = void 0;\n\n          if ((event.keyCode === 8 || multipleDel) && (initStartIndex !== initEndIndex && initStartIndex !== startIndex || initStartIndex === initEndIndex) || isRemove) {\n            curMask = maskValue[i - 1];\n            sIndex = startIndex - 1;\n          } else {\n            curMask = maskValue[i];\n            sIndex = startIndex;\n            ++startIndex;\n          }\n\n          var oldValue = this.element.value[sIndex];\n\n          if (isNullOrUndefined(this.regExpCollec[curMask]) && !isNullOrUndefined(this.customCharacters) && isNullOrUndefined(this.customCharacters[curMask]) && this.hiddenMask[sIndex] !== this.promptChar && this.customRegExpCollec[sIndex][0] !== '[' && this.customRegExpCollec[sIndex][this.customRegExpCollec[sIndex].length - 1] !== ']' || this.promptMask[sIndex] !== this.promptChar && isNullOrUndefined(this.customCharacters)) {\n            this.element.selectionStart = this.element.selectionEnd = sIndex;\n            event.preventDefault();\n\n            if (event.keyCode === 46 && !multipleDel) {\n              ++this.element.selectionStart;\n            }\n          } else {\n            var value = this.element.value;\n            var prompt_1 = this.promptChar;\n            var elementValue = value.substring(0, sIndex) + prompt_1 + value.substring(startIndex, value.length);\n            setElementValue.call(this, elementValue);\n            event.preventDefault();\n            this.element.selectionStart = this.element.selectionEnd = sIndex;\n            isDeleted = true;\n          }\n\n          startIndex = this.element.selectionStart;\n\n          if (!isDeleted && event.keyCode === 8 || multipleDel || !isDeleted && !(event.keyCode === 46)) {\n            sIndex = startIndex - 1;\n          } else {\n            sIndex = startIndex;\n            isDeleted = false;\n          }\n\n          oldValue = this.element.value[sIndex];\n\n          if (initStartIndex !== initEndIndex && this.element.selectionStart === initStartIndex || this.promptMask[sIndex] === this.promptChar || oldValue !== this.promptMask[sIndex] && this.promptMask[sIndex] !== this.promptChar && !isNullOrUndefined(this.customCharacters)) {\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.element.selectionStart === 0 && this.element.selectionEnd === this.element.value.length) {\n      setElementValue.call(this, this.promptMask);\n      event.preventDefault();\n      this.element.selectionStart = this.element.selectionEnd = startIndex;\n    }\n\n    this.redoCollec.unshift({\n      value: this.element.value,\n      startIndex: this.element.selectionStart,\n      endIndex: this.element.selectionEnd\n    });\n\n    if (this.element.value !== preValue) {\n      triggerMaskChangeEvent.call(this, event, oldEventVal);\n    }\n  }\n}\n\nfunction maskInputKeyPressHandler(event) {\n  if (this.mask && !this.readonly) {\n    var oldValue = this.element.value;\n\n    if (!event.ctrlKey || event.ctrlKey && event.code !== 'KeyA' && event.code !== 'KeyY' && event.code !== 'KeyZ' && event.code !== 'KeyX' && event.code !== 'KeyC' && event.code !== 'KeyV') {\n      this.maskKeyPress = true;\n      var key = event.key;\n\n      if (key === 'Spacebar') {\n        key = String.fromCharCode(event.keyCode);\n      }\n\n      if (!key) {\n        this.isIosInvalid = true;\n        validateValue.call(this, String.fromCharCode(event.keyCode), event.ctrlKey, event);\n        event.preventDefault();\n        this.isIosInvalid = false;\n      } else if (key && key.length === 1) {\n        validateValue.call(this, key, event.ctrlKey, event);\n        event.preventDefault();\n      }\n\n      if (event.keyCode === 32 && key === ' ' && this.promptChar === ' ') {\n        this.element.selectionStart = this.element.selectionEnd = this.element.selectionStart - key.length;\n      }\n    }\n\n    if (this.element.value !== oldValue) {\n      triggerMaskChangeEvent.call(this, event, oldValue);\n    }\n  }\n}\n\nfunction triggerMaskChangeEvent(event, oldValue) {\n  var prevOnChange = this.isProtectedOnChange;\n\n  if (!isNullOrUndefined(this.changeEventArgs) && !this.isInitial) {\n    var eventArgs = {};\n    this.changeEventArgs = {\n      value: this.element.value,\n      maskedValue: this.element.value,\n      isInteraction: false,\n      isInteracted: false\n    };\n\n    if (this.mask) {\n      this.changeEventArgs.value = strippedValue.call(this, this.element);\n    }\n\n    if (!isNullOrUndefined(event)) {\n      this.changeEventArgs.isInteracted = true;\n      this.changeEventArgs.isInteraction = true;\n      this.changeEventArgs.event = event;\n    }\n\n    this.isProtectedOnChange = true;\n    this.value = this.changeEventArgs.value;\n    this.isProtectedOnChange = prevOnChange;\n    merge(eventArgs, this.changeEventArgs);\n    this.trigger('change', eventArgs);\n  }\n\n  this.preEleVal = this.element.value;\n  this.prevValue = strippedValue.call(this, this.element);\n  attributes(this.element, {\n    'aria-valuenow': this.element.value\n  });\n}\n\nfunction maskInputKeyUpHandler(event) {\n  if (this.mask && !this.readonly) {\n    var collec = void 0;\n\n    if (!this.maskKeyPress && event.keyCode === 229) {\n      var oldEventVal = void 0;\n\n      if (this.element.value.length === 1) {\n        this.element.value = this.element.value + this.promptMask;\n        this.element.setSelectionRange(1, 1);\n      }\n\n      if (this.element.value.length > this.promptMask.length) {\n        var startIndex = this.element.selectionStart;\n        var addedValues = this.element.value.length - this.promptMask.length;\n        var val_1 = this.element.value.substring(startIndex - addedValues, startIndex);\n\n        if (this.undoCollec.length > 0) {\n          collec = this.undoCollec[this.undoCollec.length - 1];\n          var startIndex_1 = this.element.selectionStart;\n          oldEventVal = collec.value;\n          var oldVal = collec.value.substring(startIndex_1 - addedValues, startIndex_1);\n          collec = this.redoCollec[0];\n          val_1 = val_1.trim();\n          var isSpace = Browser.isAndroid && val_1 === '';\n\n          if (!isSpace && oldVal !== val_1 && collec.value.substring(startIndex_1 - addedValues, startIndex_1) !== val_1) {\n            validateValue.call(this, val_1, event.ctrlKey, event);\n          } else if (isSpace) {\n            preventUnsupportedValues.call(this, event, startIndex_1 - 1, this.element.selectionEnd - 1, val_1, event.ctrlKey, false);\n          }\n        } else {\n          oldEventVal = this.promptMask;\n          validateValue.call(this, val_1, event.ctrlKey, event);\n        }\n\n        this.maskKeyPress = false;\n        triggerMaskChangeEvent.call(this, event, oldEventVal);\n      }\n    } else {\n      removeMaskError.call(this);\n    }\n\n    var val = strippedValue.call(this, this.element);\n\n    if (!(this.element.selectionStart === 0 && this.promptMask === this.element.value && val === '') || val === '' && this.value !== val) {\n      this.prevValue = val;\n      this.value = val;\n    }\n  } else {\n    triggerMaskChangeEvent.call(this, event);\n  }\n\n  if (this.element.selectionStart === 0 && this.element.selectionEnd === 0) {\n    // tslint:disable-next-line\n    var temp_1 = this.element;\n    setTimeout(function () {\n      temp_1.setSelectionRange(0, 0);\n    }, 0);\n  }\n}\n\nfunction mobileSwipeCheck(key) {\n  if (key.length > 1 && this.promptMask.length + key.length < this.element.value.length) {\n    var elementValue = this.redoCollec[0].value.substring(0, this.redoCollec[0].startIndex) + key + this.redoCollec[0].value.substring(this.redoCollec[0].startIndex, this.redoCollec[0].value.length);\n    setElementValue.call(this, elementValue);\n    this.element.selectionStart = this.element.selectionEnd = this.redoCollec[0].startIndex + key.length;\n  }\n\n  this.element.selectionStart = this.element.selectionStart - key.length;\n  this.element.selectionEnd = this.element.selectionEnd - key.length;\n}\n\nfunction mobileValidation(key) {\n  if (!this.maskKeyPress) {\n    mobileSwipeCheck.call(this, key);\n  }\n}\n\nfunction validateValue(key, isCtrlKey, event) {\n  mobileValidation.call(this, key);\n\n  if (isNullOrUndefined(this) || isNullOrUndefined(key)) {\n    return;\n  }\n\n  var startIndex = this.element.selectionStart;\n  var initStartIndex = startIndex;\n  var endIndex = this.element.selectionEnd;\n  var curMask;\n  var allowText = false;\n  var value = this.element.value;\n  var eventOldVal;\n  var prevSupport = false;\n  var isEqualVal = false;\n\n  for (var k = 0; k < key.length; k++) {\n    var keyValue = key[k];\n    startIndex = this.element.selectionStart;\n    endIndex = this.element.selectionEnd;\n\n    if (!this.maskKeyPress && initStartIndex === startIndex) {\n      startIndex = startIndex + k;\n    }\n\n    if (!this.maskKeyPress || startIndex < this.promptMask.length) {\n      for (var i = startIndex; i < this.promptMask.length; i++) {\n        var maskValue = this.escapeMaskValue;\n        curMask = maskValue[startIndex];\n\n        if (this.hiddenMask[startIndex] === '\\\\' && this.hiddenMask[startIndex + 1] === key) {\n          isEqualVal = true;\n        }\n\n        if (isNullOrUndefined(this.regExpCollec[curMask]) && (isNullOrUndefined(this.customCharacters) || !isNullOrUndefined(this.customCharacters) && isNullOrUndefined(this.customCharacters[curMask])) && this.hiddenMask[startIndex] !== this.promptChar && this.customRegExpCollec[startIndex][0] !== '[' && this.customRegExpCollec[startIndex][this.customRegExpCollec[startIndex].length - 1] !== ']' || this.promptMask[startIndex] !== this.promptChar && isNullOrUndefined(this.customCharacters) || this.promptChar === curMask && this.escapeMaskValue === this.mask) {\n          this.element.selectionStart = this.element.selectionEnd = startIndex + 1;\n          startIndex = this.element.selectionStart;\n          curMask = this.hiddenMask[startIndex];\n        }\n      }\n\n      if (!isNullOrUndefined(this.customCharacters) && !isNullOrUndefined(this.customCharacters[curMask])) {\n        var customValStr = this.customCharacters[curMask];\n        var customValArr = customValStr.split(',');\n\n        for (var i = 0; i < customValArr.length; i++) {\n          if (keyValue.match(new RegExp('[' + customValArr[i] + ']'))) {\n            allowText = true;\n            break;\n          }\n        }\n      } else if (!isNullOrUndefined(this.regExpCollec[curMask]) && keyValue.match(new RegExp(this.regExpCollec[curMask])) && this.promptMask[startIndex] === this.promptChar) {\n        allowText = true;\n      } else if (this.promptMask[startIndex] === this.promptChar && this.customRegExpCollec[startIndex][0] === '[' && this.customRegExpCollec[startIndex][this.customRegExpCollec[startIndex].length - 1] === ']' && keyValue.match(new RegExp(this.customRegExpCollec[startIndex]))) {\n        allowText = true;\n      }\n\n      if ((!this.maskKeyPress || startIndex < this.hiddenMask.length) && allowText) {\n        if (k === 0) {\n          if (this.maskKeyPress) {\n            this.undoCollec.push({\n              value: value,\n              startIndex: startIndex,\n              endIndex: startIndex\n            });\n          } else {\n            var sIndex = this.element.selectionStart;\n            var eIndex = this.element.selectionEnd;\n\n            if (this.redoCollec.length > 0) {\n              eventOldVal = this.redoCollec[0].value;\n              setElementValue.call(this, eventOldVal);\n              this.undoCollec.push(this.redoCollec[0]);\n            } else {\n              this.undoCollec.push({\n                value: this.promptMask,\n                startIndex: startIndex,\n                endIndex: startIndex\n              });\n              eventOldVal = this.promptMask;\n              setElementValue.call(this, eventOldVal);\n            }\n\n            this.element.selectionStart = sIndex;\n            this.element.selectionEnd = eIndex;\n          }\n        }\n\n        startIndex = this.element.selectionStart;\n        applySupportedValues.call(this, event, startIndex, keyValue, eventOldVal, isEqualVal);\n        prevSupport = true;\n\n        if (k === key.length - 1) {\n          this.redoCollec.unshift({\n            value: this.element.value,\n            startIndex: this.element.selectionStart,\n            endIndex: this.element.selectionEnd\n          });\n        }\n\n        allowText = false;\n      } else {\n        startIndex = this.element.selectionStart;\n        preventUnsupportedValues.call(this, event, startIndex, initStartIndex, key, isCtrlKey, prevSupport);\n      }\n\n      if (k === key.length - 1 && !allowText) {\n        if (!Browser.isAndroid || Browser.isAndroid && startIndex < this.promptMask.length) {\n          this.redoCollec.unshift({\n            value: this.element.value,\n            startIndex: this.element.selectionStart,\n            endIndex: this.element.selectionEnd\n          });\n        }\n      }\n    } else {\n      if (key.length === 1 && !isCtrlKey && !isNullOrUndefined(event)) {\n        addMaskErrorClass.call(this);\n      }\n    }\n  }\n}\n\nfunction applySupportedValues(event, startIndex, keyValue, eventOldVal, isEqualVal) {\n  if (this.hiddenMask.length > this.promptMask.length) {\n    keyValue = changeToLowerUpperCase.call(this, keyValue, this.element.value);\n  }\n\n  if (!isEqualVal) {\n    var value = this.element.value;\n    var elementValue = value.substring(0, startIndex) + keyValue + value.substring(startIndex + 1, value.length);\n    setElementValue.call(this, elementValue);\n    this.element.selectionStart = this.element.selectionEnd = startIndex + 1;\n  }\n}\n\nfunction preventUnsupportedValues(event, sIdx, idx, key, ctrl, chkSupport) {\n  if (!this.maskKeyPress) {\n    var eventOldVal = void 0;\n    var value = this.element.value;\n\n    if (sIdx >= this.promptMask.length) {\n      setElementValue.call(this, value.substring(0, sIdx));\n    } else {\n      if (idx === sIdx) {\n        setElementValue.call(this, value.substring(0, sIdx) + value.substring(sIdx + 1, value.length));\n      } else {\n        if (this.promptMask.length === this.element.value.length) {\n          setElementValue.call(this, value.substring(0, sIdx) + value.substring(sIdx, value.length));\n        } else {\n          setElementValue.call(this, value.substring(0, idx) + value.substring(idx + 1, value.length));\n        }\n      }\n\n      this.element.selectionStart = this.element.selectionEnd = chkSupport || this.element.value[idx] !== this.promptChar ? sIdx : idx;\n    }\n\n    eventOldVal = this.element.value;\n    addMaskErrorClass.call(this);\n  }\n\n  if (key.length === 1 && !ctrl && !isNullOrUndefined(event)) {\n    addMaskErrorClass.call(this);\n  }\n}\n\nfunction addMaskErrorClass() {\n  var _this = this;\n\n  var parentElement = this.element.parentNode;\n  var timer = 200;\n\n  if (parentElement.classList.contains(INPUTGROUP) || parentElement.classList.contains(FLOATINPUT)) {\n    addClass([parentElement], ERROR);\n  } else {\n    addClass([this.element], ERROR);\n  }\n\n  if (this.isIosInvalid === true) {\n    timer = 400;\n  }\n\n  attributes(this.element, {\n    'aria-invalid': 'true'\n  });\n  setTimeout(function () {\n    if (!_this.maskKeyPress) {\n      removeMaskError.call(_this);\n    }\n  }, timer);\n}\n\nfunction removeMaskError() {\n  var parentElement = this.element.parentNode;\n\n  if (!isNullOrUndefined(parentElement)) {\n    removeClass([parentElement], ERROR);\n  }\n\n  removeClass([this.element], ERROR);\n  attributes(this.element, {\n    'aria-invalid': 'false'\n  });\n}\n/**\n * @hidden\n * Validates user input using masking elements '<' , '>' and '|'.\n */\n\n\nfunction changeToLowerUpperCase(key, value) {\n  var promptMask;\n  var i;\n  var j = 0;\n  var curVal = value;\n  var caseCount = 0;\n\n  for (i = 0; i < this.hiddenMask.length; i++) {\n    if (this.hiddenMask[i] === '\\\\') {\n      promptMask = curVal.substring(0, i) + '\\\\' + curVal.substring(i, curVal.length);\n    }\n\n    if (this.hiddenMask[i] === '>' || this.hiddenMask[i] === '<' || this.hiddenMask[i] === '|') {\n      if (this.hiddenMask[i] !== curVal[i]) {\n        promptMask = curVal.substring(0, i) + this.hiddenMask[i] + curVal.substring(i, curVal.length);\n      }\n\n      ++caseCount;\n    }\n\n    if (promptMask) {\n      if (promptMask[i] === this.promptChar && i > this.element.selectionStart || this.element.value.indexOf(this.promptChar) < 0 && this.element.selectionStart + caseCount === i) {\n        caseCount = 0;\n        break;\n      }\n\n      curVal = promptMask;\n    }\n  }\n\n  while (i >= 0 && promptMask) {\n    if (i === 0 || promptMask[i - 1] !== '\\\\') {\n      var val = this.element.value;\n\n      if (promptMask[i] === '>') {\n        key = key.toUpperCase();\n        break;\n      } else if (promptMask[i] === '<') {\n        key = key.toLowerCase();\n        break;\n      } else if (promptMask[i] === '|') {\n        break;\n      }\n    }\n\n    --i;\n  }\n\n  return key;\n}\n/**\n * @hidden\n * To set updated values in the MaskedTextBox.\n */\n\n\nexport function setMaskValue(val) {\n  if (this.mask && val !== undefined && (this.prevValue === undefined || this.prevValue !== val)) {\n    this.maskKeyPress = true;\n    setElementValue.call(this, this.promptMask);\n\n    if (val !== '' && !(val === null && this.floatLabelType === 'Never' && this.placeholder)) {\n      this.element.selectionStart = 0;\n      this.element.selectionEnd = 0;\n    }\n\n    if (val !== null) {\n      for (var i = 0; i < val.length; i++) {\n        validateValue.call(this, val[i], false, null);\n      }\n    }\n\n    var newVal = strippedValue.call(this, this.element);\n    this.prevValue = newVal;\n    this.value = newVal;\n    triggerMaskChangeEvent.call(this, null, null);\n    this.maskKeyPress = false;\n    var labelElement = this.element.parentNode.querySelector('.e-float-text');\n\n    if (this.element.value === this.promptMask && this.floatLabelType === 'Auto' && this.placeholder && !isNullOrUndefined(labelElement) && labelElement.classList.contains(TOPLABEL) && !this.isFocus) {\n      removeClass([labelElement], TOPLABEL);\n      addClass([labelElement], BOTTOMLABEL);\n      setElementValue.call(this, '');\n    }\n  }\n\n  if (this.mask === null || this.mask === '' && this.value !== undefined) {\n    setElementValue.call(this, this.value);\n  }\n}\n/**\n * @hidden\n * To set updated values in the input element.\n */\n\nexport function setElementValue(val, element) {\n  if (!this.isFocus && this.floatLabelType === 'Auto' && this.placeholder && isNullOrUndefined(this.value)) {\n    val = '';\n  }\n\n  var value = strippedValue.call(this, element ? element : this.element, val);\n\n  if (value === null || value === '') {\n    Input.setValue(val, element ? element : this.element, this.floatLabelType, false);\n\n    if (this.showClearButton) {\n      this.inputObj.clearButton.classList.add('e-clear-icon-hide');\n    }\n  } else {\n    Input.setValue(val, element ? element : this.element, this.floatLabelType, this.showClearButton);\n  }\n}\n/**\n * @hidden\n * Provide mask support to input textbox through utility method.\n */\n\nexport function maskInput(args) {\n  var inputEle = getMaskInput(args);\n  applyMask.call(inputEle);\n  var val = strippedValue.call(this, this.element);\n  this.prevValue = val;\n  this.value = val;\n\n  if (args.mask) {\n    unwireEvents.call(inputEle);\n    wireEvents.call(inputEle);\n  }\n}\n\nfunction getMaskInput(args) {\n  addClass([args.element], UTILMASK);\n  var inputEle = {\n    element: args.element,\n    mask: args.mask,\n    promptMask: '',\n    hiddenMask: '',\n    escapeMaskValue: '',\n    promptChar: args.promptChar ? args.promptChar.length > 1 ? args.promptChar = args.promptChar[0] : args.promptChar : '_',\n    value: args.value ? args.value : null,\n    regExpCollec: regularExpressions,\n    customRegExpCollec: [],\n    customCharacters: args.customCharacters,\n    undoCollec: [],\n    redoCollec: [],\n    maskKeyPress: false,\n    prevValue: ''\n  };\n  createMask.call(inputEle);\n  return inputEle;\n}\n/**\n * @hidden\n * Gets raw value of the textbox which has been masked through utility method.\n */\n\n\nexport function getVal(args) {\n  return strippedValue.call(getUtilMaskEle(args), args.element);\n}\n/**\n * @hidden\n * Gets masked value of the textbox which has been masked through utility method.\n */\n\nexport function getMaskedVal(args) {\n  return unstrippedValue.call(getUtilMaskEle(args), args.element);\n}\n\nfunction getUtilMaskEle(args) {\n  var value = '';\n  var inputEle;\n\n  if (!isNullOrUndefined(args) && args.element.classList.contains(UTILMASK)) {\n    inputEle = getMaskInput(args);\n  }\n\n  return inputEle;\n}\n/**\n * @hidden\n * Arguments to perform undo and redo functionalities.\n */\n\n\nvar MaskUndo =\n/** @class */\nfunction () {\n  function MaskUndo() {}\n\n  return MaskUndo;\n}();\n\nexport { MaskUndo };\nvar maskUndo = new MaskUndo();","map":{"version":3,"sources":["/Users/jay/node_modules/@syncfusion/ej2-inputs/src/maskedtextbox/base/mask-base.js"],"names":["EventHandler","isNullOrUndefined","merge","attributes","addClass","removeClass","Browser","extend","Input","ERROR","INPUTGROUP","FLOATINPUT","UTILMASK","TOPLABEL","BOTTOMLABEL","regularExpressions","createMask","element","mask","splitMask","split","i","length","splitInnerMask","j","pushIntoRegExpCollec","call","chkSpace","customRegExpCollec","push","hiddenMask","promptChar","escapeMaskValue","promptMask","replace","customCharacters","RegExp","escapeNumber","match","substring","applyMask","setElementValue","setMaskValue","value","wireEvents","add","maskInputKeyDownHandler","maskInputKeyPressHandler","maskInputKeyUpHandler","maskInputHandler","maskInputFocusHandler","maskInputBlurHandler","maskInputPasteHandler","maskInputCutHandler","maskInputDropHandler","enabled","bindClearEvent","formElement","resetFormHandler","unwireEvents","remove","showClearButton","inputObj","clearButton","resetHandler","e","preventDefault","classList","contains","clear","event","redoCollec","unshift","startIndex","selectionStart","endIndex","selectionEnd","triggerMaskChangeEvent","setSelectionRange","tagName","initInputValue","unstrippedValue","strippedValue","maskValues","k","checkMask","maskValue","regExpCollec","undefined","_this","eventArgs","maskedValue","container","trigger","isFocus","isDevice","info","version","delay","isIos","setTimeout","blurEventArgs","placeholder","floatLabelType","labelElement","parentNode","querySelector","readonly","sIndex_1","eIndex_1","oldValue_1","_callPasteHandler","maskKeyPress","validateValue","i_1","preValue_1","sIndex_2","eIndex","undoCollec","value_1","isIE","ctrlKey","keyCode","removeMaskInputValues","addedValues","preEleVal","val","prevValue","startValue","collec","splice","mobileRemoveFunction","sIndex","autoFillMaskInputValues","isRemove","oldEventVal","type","isDeleted","initStartIndex","initEndIndex","curMask","parentElement","multipleDel","preValue","index","oldValue","prompt_1","elementValue","code","key","String","fromCharCode","isIosInvalid","prevOnChange","isProtectedOnChange","changeEventArgs","isInitial","isInteraction","isInteracted","val_1","startIndex_1","oldVal","trim","isSpace","isAndroid","preventUnsupportedValues","removeMaskError","temp_1","mobileSwipeCheck","mobileValidation","isCtrlKey","allowText","eventOldVal","prevSupport","isEqualVal","keyValue","customValStr","customValArr","applySupportedValues","addMaskErrorClass","changeToLowerUpperCase","sIdx","idx","ctrl","chkSupport","timer","curVal","caseCount","indexOf","toUpperCase","toLowerCase","newVal","setValue","maskInput","args","inputEle","getMaskInput","getVal","getUtilMaskEle","getMaskedVal","MaskUndo","maskUndo"],"mappings":"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","sourcesContent":["/**\n * MaskedTextBox base module\n */\nimport { EventHandler, isNullOrUndefined, merge, attributes, addClass, removeClass, Browser, extend } from '@syncfusion/ej2-base';\nimport { Input } from '../../input/input';\nvar ERROR = 'e-error';\nvar INPUTGROUP = 'e-input-group';\nvar FLOATINPUT = 'e-float-input';\nvar UTILMASK = 'e-utility-mask';\nvar TOPLABEL = 'e-label-top';\nvar BOTTOMLABEL = 'e-label-bottom';\n/**\n * @hidden\n * Built-in masking elements collection.\n */\nexport var regularExpressions = {\n    '0': '[0-9]',\n    '9': '[0-9 ]',\n    '#': '[0-9 +-]',\n    'L': '[A-Za-z]',\n    '?': '[A-Za-z ]',\n    '&': '[^\\x7f ]+',\n    'C': '[^\\x7f]+',\n    'A': '[A-Za-z0-9]',\n    'a': '[A-Za-z0-9 ]',\n};\n/**\n * @hidden\n * Generate required masking elements to the MaskedTextBox from user mask input.\n */\nexport function createMask() {\n    attributes(this.element, {\n        'role': 'textbox', 'autocomplete': 'off', 'autocorrect': 'off', 'autocapitalize': 'off',\n        'spellcheck': 'false', 'aria-live': 'assertive', 'aria-valuenow': ''\n    });\n    if (this.mask) {\n        var splitMask = this.mask.split(']');\n        for (var i = 0; i < splitMask.length; i++) {\n            if (splitMask[i][splitMask[i].length - 1] === '\\\\') {\n                splitMask[i] = splitMask[i] + ']';\n                var splitInnerMask = splitMask[i].split('[');\n                for (var j = 0; j < splitInnerMask.length; j++) {\n                    if (splitInnerMask[j][splitInnerMask[j].length - 1] === '\\\\') {\n                        splitInnerMask[j] = splitInnerMask[j] + '[';\n                    }\n                    pushIntoRegExpCollec.call(this, splitInnerMask[j]);\n                }\n            }\n            else {\n                var splitInnerMask = splitMask[i].split('[');\n                if (splitInnerMask.length > 1) {\n                    var chkSpace = false;\n                    for (var j = 0; j < splitInnerMask.length; j++) {\n                        if (splitInnerMask[j] === '\\\\') {\n                            this.customRegExpCollec.push('[');\n                            this.hiddenMask += splitInnerMask[j] + '[';\n                        }\n                        else if (splitInnerMask[j] === '') {\n                            chkSpace = true;\n                        }\n                        else if ((splitInnerMask[j] !== '' && chkSpace) || j === splitInnerMask.length - 1) {\n                            this.customRegExpCollec.push('[' + splitInnerMask[j] + ']');\n                            this.hiddenMask += this.promptChar;\n                            chkSpace = false;\n                        }\n                        else {\n                            pushIntoRegExpCollec.call(this, splitInnerMask[j]);\n                        }\n                    }\n                }\n                else {\n                    pushIntoRegExpCollec.call(this, splitInnerMask[0]);\n                }\n            }\n        }\n        this.escapeMaskValue = this.hiddenMask;\n        this.promptMask = this.hiddenMask.replace(/[09?LCAa#&]/g, this.promptChar);\n        if (!isNullOrUndefined(this.customCharacters)) {\n            for (var i = 0; i < this.promptMask.length; i++) {\n                if (!isNullOrUndefined(this.customCharacters[this.promptMask[i]])) {\n                    this.promptMask = this.promptMask.replace(new RegExp(this.promptMask[i], 'g'), this.promptChar);\n                }\n            }\n        }\n        var escapeNumber = 0;\n        if (this.hiddenMask.match(new RegExp(/\\\\/))) {\n            for (var i = 0; i < this.hiddenMask.length; i++) {\n                var j = 0;\n                if (i >= 1) {\n                    j = i;\n                }\n                escapeNumber = this.hiddenMask.length - this.promptMask.length;\n                j = j - escapeNumber;\n                if ((i > 0 && this.hiddenMask[i - 1] !== '\\\\') && (this.hiddenMask[i] === '>' ||\n                    this.hiddenMask[i] === '<' || this.hiddenMask[i] === '|')) {\n                    this.promptMask = this.promptMask.substring(0, j) +\n                        this.promptMask.substring((i + 1) - escapeNumber, this.promptMask.length);\n                    this.escapeMaskValue = this.escapeMaskValue.substring(0, j) +\n                        this.escapeMaskValue.substring((i + 1) - escapeNumber, this.escapeMaskValue.length);\n                }\n                if (this.hiddenMask[i] === '\\\\') {\n                    this.promptMask = this.promptMask.substring(0, j) + this.hiddenMask[i + 1] +\n                        this.promptMask.substring((i + 2) - escapeNumber, this.promptMask.length);\n                    this.escapeMaskValue = this.escapeMaskValue.substring(0, j) + this.escapeMaskValue[i + 1] +\n                        this.escapeMaskValue.substring((i + 2) - escapeNumber, this.escapeMaskValue.length);\n                }\n            }\n        }\n        else {\n            this.promptMask = this.promptMask.replace(/[>|<]/g, '');\n            this.escapeMaskValue = this.hiddenMask.replace(/[>|<]/g, '');\n        }\n        attributes(this.element, { 'aria-invalid': 'false' });\n    }\n}\n/**\n * @hidden\n * Apply mask ability with masking elements to the MaskedTextBox.\n */\nexport function applyMask() {\n    setElementValue.call(this, this.promptMask);\n    setMaskValue.call(this, this.value);\n}\n/**\n * @hidden\n * To wire required events to the MaskedTextBox.\n */\nexport function wireEvents() {\n    EventHandler.add(this.element, 'keydown', maskInputKeyDownHandler, this);\n    EventHandler.add(this.element, 'keypress', maskInputKeyPressHandler, this);\n    EventHandler.add(this.element, 'keyup', maskInputKeyUpHandler, this);\n    EventHandler.add(this.element, 'input', maskInputHandler, this);\n    EventHandler.add(this.element, 'focus', maskInputFocusHandler, this);\n    EventHandler.add(this.element, 'blur', maskInputBlurHandler, this);\n    EventHandler.add(this.element, 'paste', maskInputPasteHandler, this);\n    EventHandler.add(this.element, 'cut', maskInputCutHandler, this);\n    EventHandler.add(this.element, 'drop', maskInputDropHandler, this);\n    if (this.enabled) {\n        bindClearEvent.call(this);\n        if (this.formElement) {\n            EventHandler.add(this.formElement, 'reset', resetFormHandler, this);\n        }\n    }\n}\n/**\n * @hidden\n * To unwire events attached to the MaskedTextBox.\n */\nexport function unwireEvents() {\n    EventHandler.remove(this.element, 'keydown', maskInputKeyDownHandler);\n    EventHandler.remove(this.element, 'keypress', maskInputKeyPressHandler);\n    EventHandler.remove(this.element, 'keyup', maskInputKeyUpHandler);\n    EventHandler.remove(this.element, 'input', maskInputHandler);\n    EventHandler.remove(this.element, 'focus', maskInputFocusHandler);\n    EventHandler.remove(this.element, 'blur', maskInputBlurHandler);\n    EventHandler.remove(this.element, 'paste', maskInputPasteHandler);\n    EventHandler.remove(this.element, 'cut', maskInputCutHandler);\n    if (this.formElement) {\n        EventHandler.remove(this.formElement, 'reset', resetFormHandler);\n    }\n}\n/**\n * @hidden\n * To bind required events to the MaskedTextBox clearButton.\n */\nexport function bindClearEvent() {\n    if (this.showClearButton) {\n        EventHandler.add(this.inputObj.clearButton, 'mousedown touchstart', resetHandler, this);\n    }\n}\nfunction resetHandler(e) {\n    e.preventDefault();\n    if (!this.inputObj.clearButton.classList.contains('e-clear-icon-hide')) {\n        clear.call(this, e);\n        this.value = '';\n    }\n}\nfunction clear(event) {\n    var value = this.element.value;\n    setElementValue.call(this, this.promptMask);\n    this.redoCollec.unshift({\n        value: this.promptMask, startIndex: this.element.selectionStart, endIndex: this.element.selectionEnd\n    });\n    triggerMaskChangeEvent.call(this, event, value);\n    this.element.setSelectionRange(0, 0);\n}\nfunction resetFormHandler() {\n    if (this.element.tagName === 'EJS-MASKEDTEXTBOX') {\n        setElementValue.call(this, this.promptMask);\n    }\n    else {\n        this.value = this.initInputValue;\n    }\n}\n/**\n * @hidden\n * To get masked value from the MaskedTextBox.\n */\nexport function unstrippedValue(element) {\n    return element.value;\n}\n/**\n * @hidden\n * To extract raw value from the MaskedTextBox.\n */\nexport function strippedValue(element, maskValues) {\n    var value = '';\n    var k = 0;\n    var checkMask = false;\n    var maskValue = (!isNullOrUndefined(maskValues)) ? maskValues : (!isNullOrUndefined(element) &&\n        !isNullOrUndefined(this)) ? element.value : maskValues;\n    if (maskValue !== this.promptMask) {\n        for (var i = 0; i < this.customRegExpCollec.length; i++) {\n            if (checkMask) {\n                checkMask = false;\n            }\n            if (this.customRegExpCollec[k] === '>' || this.customRegExpCollec[k] === '<' ||\n                this.customRegExpCollec[k] === '|' || this.customRegExpCollec[k] === '\\\\') {\n                --i;\n                checkMask = true;\n            }\n            if (!checkMask) {\n                if ((maskValue[i] !== this.promptChar) && (!isNullOrUndefined(this.customRegExpCollec[k]) &&\n                    ((!isNullOrUndefined(this.regExpCollec[this.customRegExpCollec[k]])) ||\n                        (this.customRegExpCollec[k].length > 2 && this.customRegExpCollec[k][0] === '[' &&\n                            this.customRegExpCollec[k][this.customRegExpCollec[k].length - 1] === ']') ||\n                        (!isNullOrUndefined(this.customCharacters) &&\n                            (!isNullOrUndefined(this.customCharacters[this.customRegExpCollec[k]]))))) && (maskValue !== '')) {\n                    value += maskValue[i];\n                }\n            }\n            ++k;\n        }\n    }\n    if (this.mask === null || this.mask === '' && this.value !== undefined) {\n        value = maskValue;\n    }\n    return value;\n}\nfunction pushIntoRegExpCollec(value) {\n    for (var k = 0; k < value.length; k++) {\n        this.hiddenMask += value[k];\n        if (value[k] !== '\\\\') {\n            this.customRegExpCollec.push(value[k]);\n        }\n    }\n}\nexport function maskInputFocusHandler(event) {\n    var _this = this;\n    var eventArgs = {\n        selectionStart: 0,\n        event: event,\n        value: this.value,\n        maskedValue: this.element.value,\n        container: this.inputObj.container,\n        selectionEnd: (this.promptMask.length > 0) ? this.promptMask.length : this.element.value.length,\n    };\n    this.trigger('focus', eventArgs, function (eventArgs) {\n        if (_this.mask) {\n            _this.isFocus = true;\n            if (_this.element.value === '') {\n                setElementValue.call(_this, _this.promptMask);\n            }\n            else {\n                setElementValue.call(_this, _this.element.value);\n            }\n            if (!Browser.isDevice && Browser.info.version === '11.0') {\n                _this.element.setSelectionRange(eventArgs.selectionStart, eventArgs.selectionEnd);\n            }\n            else {\n                var delay = (Browser.isDevice && Browser.isIos) ? 450 : 0;\n                setTimeout(function () {\n                    _this.element.setSelectionRange(eventArgs.selectionStart, eventArgs.selectionEnd);\n                }, delay);\n            }\n        }\n    });\n}\nexport function maskInputBlurHandler(event) {\n    this.blurEventArgs = {\n        event: event,\n        value: this.value,\n        maskedValue: this.element.value,\n        container: this.inputObj.container\n    };\n    this.trigger('blur', this.blurEventArgs);\n    if (this.mask) {\n        this.isFocus = false;\n        if (this.placeholder && this.element.value === this.promptMask && this.floatLabelType !== 'Always') {\n            setElementValue.call(this, '');\n            var labelElement = this.element.parentNode.querySelector('.e-float-text');\n            if (this.floatLabelType === 'Auto' && !isNullOrUndefined(labelElement) && labelElement.classList.contains(TOPLABEL)) {\n                removeClass([labelElement], TOPLABEL);\n            }\n        }\n    }\n}\nfunction maskInputPasteHandler(event) {\n    var _this = this;\n    if (this.mask && !this.readonly) {\n        var sIndex_1 = this.element.selectionStart;\n        var eIndex_1 = this.element.selectionEnd;\n        var oldValue_1 = this.element.value;\n        setElementValue.call(this, '');\n        this._callPasteHandler = true;\n        setTimeout(function () {\n            var value = _this.element.value.replace(/ /g, '');\n            if (_this.redoCollec.length > 0 && _this.redoCollec[0].value === _this.element.value) {\n                value = strippedValue.call(_this, _this.element);\n            }\n            setElementValue.call(_this, oldValue_1);\n            _this.element.selectionStart = sIndex_1;\n            _this.element.selectionEnd = eIndex_1;\n            var i = 0;\n            _this.maskKeyPress = true;\n            do {\n                validateValue.call(_this, value[i], false, null);\n                ++i;\n            } while (i < value.length);\n            _this.maskKeyPress = false;\n            _this._callPasteHandler = false;\n            if (_this.element.value === oldValue_1) {\n                var i_1 = 0;\n                _this.maskKeyPress = true;\n                do {\n                    validateValue.call(_this, value[i_1], false, null);\n                    ++i_1;\n                } while (i_1 < value.length);\n                _this.maskKeyPress = false;\n            }\n            else {\n                triggerMaskChangeEvent.call(_this, event, oldValue_1);\n            }\n        }, 1);\n    }\n}\nfunction maskInputCutHandler(event) {\n    var _this = this;\n    if (this.mask && !this.readonly) {\n        var preValue_1 = this.element.value;\n        var sIndex_2 = this.element.selectionStart;\n        var eIndex = this.element.selectionEnd;\n        this.undoCollec.push({ value: this.element.value, startIndex: this.element.selectionStart, endIndex: this.element.selectionEnd });\n        var value_1 = this.element.value.substring(0, sIndex_2) + this.promptMask.substring(sIndex_2, eIndex) +\n            this.element.value.substring(eIndex);\n        setTimeout(function () {\n            setElementValue.call(_this, value_1);\n            _this.element.selectionStart = _this.element.selectionEnd = sIndex_2;\n            if (_this.element.value !== preValue_1) {\n                triggerMaskChangeEvent.call(_this, event, null);\n            }\n        }, 0);\n    }\n}\nexport function maskInputDropHandler(event) {\n    event.preventDefault();\n}\nfunction maskInputHandler(event) {\n    if (Browser.isIE === true && this.element.value === '' && this.floatLabelType === 'Never') {\n        return;\n    }\n    var eventArgs = { ctrlKey: false, keyCode: 229 };\n    // tslint:disable-next-line\n    extend(event, eventArgs);\n    if (this.mask) {\n        if (this.element.value === '') {\n            this.redoCollec.unshift({\n                value: this.promptMask, startIndex: this.element.selectionStart, endIndex: this.element.selectionEnd\n            });\n        }\n        if (this.element.value.length === 1) {\n            this.element.value = this.element.value + this.promptMask;\n            this.element.setSelectionRange(1, 1);\n        }\n        if (!this._callPasteHandler) {\n            removeMaskInputValues.call(this, event);\n        }\n        if (this.element.value.length > this.promptMask.length) {\n            var startIndex = this.element.selectionStart;\n            var addedValues = this.element.value.length - this.promptMask.length;\n            var value = this.element.value.substring(startIndex - addedValues, startIndex);\n            this.maskKeyPress = false;\n            var i = 0;\n            do {\n                validateValue.call(this, value[i], event.ctrlKey, event);\n                ++i;\n            } while (i < value.length);\n            if (this.element.value !== this.preEleVal) {\n                triggerMaskChangeEvent.call(this, event, null);\n            }\n        }\n        var val = strippedValue.call(this, this.element);\n        this.prevValue = val;\n        this.value = val;\n        if (val === '') {\n            setElementValue.call(this, this.promptMask);\n            this.element.setSelectionRange(0, 0);\n        }\n    }\n}\nfunction maskInputKeyDownHandler(event) {\n    if (this.mask && !this.readonly) {\n        var value = this;\n        if (event.keyCode !== 229) {\n            if (event.ctrlKey && (event.keyCode === 89 || event.keyCode === 90)) {\n                event.preventDefault();\n            }\n            removeMaskInputValues.call(this, event);\n        }\n        var startValue = this.element.value;\n        if (event.ctrlKey && (event.keyCode === 89 || event.keyCode === 90)) {\n            var collec = void 0;\n            if (event.keyCode === 90 && this.undoCollec.length > 0 && startValue !== this.undoCollec[this.undoCollec.length - 1].value) {\n                collec = this.undoCollec[this.undoCollec.length - 1];\n                this.redoCollec.unshift({\n                    value: this.element.value, startIndex: this.element.selectionStart,\n                    endIndex: this.element.selectionEnd\n                });\n                setElementValue.call(this, collec.value);\n                this.element.selectionStart = collec.startIndex;\n                this.element.selectionEnd = collec.endIndex;\n                this.undoCollec.splice(this.undoCollec.length - 1, 1);\n            }\n            else if (event.keyCode === 89 && this.redoCollec.length > 0 && startValue !== this.redoCollec[0].value) {\n                collec = this.redoCollec[0];\n                this.undoCollec.push({\n                    value: this.element.value, startIndex: this.element.selectionStart,\n                    endIndex: this.element.selectionEnd\n                });\n                setElementValue.call(this, collec.value);\n                this.element.selectionStart = collec.startIndex;\n                this.element.selectionEnd = collec.endIndex;\n                this.redoCollec.splice(0, 1);\n            }\n        }\n    }\n}\nexport function mobileRemoveFunction() {\n    var collec;\n    var sIndex = this.element.selectionStart;\n    var eIndex = this.element.selectionEnd;\n    if (this.redoCollec.length > 0) {\n        collec = this.redoCollec[0];\n        setElementValue.call(this, collec.value);\n        if ((collec.startIndex - sIndex) === 1) {\n            this.element.selectionStart = collec.startIndex;\n            this.element.selectionEnd = collec.endIndex;\n        }\n        else {\n            this.element.selectionStart = sIndex + 1;\n            this.element.selectionEnd = eIndex + 1;\n        }\n    }\n    else {\n        setElementValue.call(this, this.promptMask);\n        this.element.selectionStart = this.element.selectionEnd = sIndex;\n    }\n}\nfunction autoFillMaskInputValues(isRemove, oldEventVal, event) {\n    if (event.type === 'input') {\n        isRemove = false;\n        oldEventVal = this.element.value;\n        setElementValue.call(this, this.promptMask);\n        setMaskValue.call(this, oldEventVal);\n    }\n    return isRemove;\n}\nfunction removeMaskInputValues(event) {\n    var isRemove = false;\n    var oldEventVal;\n    var isDeleted = false;\n    if (this.element.value.length < this.promptMask.length) {\n        isRemove = true;\n        oldEventVal = this.element.value;\n        isRemove = autoFillMaskInputValues.call(this, isRemove, oldEventVal, event);\n        mobileRemoveFunction.call(this);\n    }\n    if (this.element.value.length >= this.promptMask.length && event.type === 'input') {\n        isRemove = autoFillMaskInputValues.call(this, isRemove, oldEventVal, event);\n    }\n    var initStartIndex = this.element.selectionStart;\n    var initEndIndex = this.element.selectionEnd;\n    var startIndex = this.element.selectionStart;\n    var endIndex = this.element.selectionEnd;\n    var maskValue = this.hiddenMask.replace(/[>|\\\\<]/g, '');\n    var curMask = maskValue[startIndex - 1];\n    var parentElement = this.element.parentNode;\n    if (isRemove || event.keyCode === 8 || event.keyCode === 46) {\n        this.undoCollec.push({ value: this.element.value, startIndex: this.element.selectionStart, endIndex: endIndex });\n        var multipleDel = false;\n        var preValue = this.element.value;\n        if (startIndex > 0 || ((event.keyCode === 8 || event.keyCode === 46) && startIndex < this.element.value.length\n            && ((this.element.selectionEnd - startIndex) !== this.element.value.length))) {\n            var index = startIndex;\n            if (startIndex !== endIndex) {\n                startIndex = endIndex;\n                if (event.keyCode === 46) {\n                    multipleDel = true;\n                }\n            }\n            else if (event.keyCode === 46) {\n                ++index;\n            }\n            else {\n                --index;\n            }\n            for (var k = startIndex; (event.keyCode === 8 || isRemove || multipleDel) ? k > index : k < index; (event.keyCode === 8 || isRemove || multipleDel) ? k-- : k++) {\n                for (var i = startIndex; (event.keyCode === 8 || isRemove || multipleDel) ? i > 0 : i < this.element.value.length; (event.keyCode === 8 || isRemove || multipleDel) ? i-- : i++) {\n                    var sIndex = void 0;\n                    if (((event.keyCode === 8 || multipleDel) && ((initStartIndex !== initEndIndex && initStartIndex !== startIndex) ||\n                        (initStartIndex === initEndIndex))) || isRemove) {\n                        curMask = maskValue[i - 1];\n                        sIndex = startIndex - 1;\n                    }\n                    else {\n                        curMask = maskValue[i];\n                        sIndex = startIndex;\n                        ++startIndex;\n                    }\n                    var oldValue = this.element.value[sIndex];\n                    if ((isNullOrUndefined(this.regExpCollec[curMask]) && (!isNullOrUndefined(this.customCharacters)\n                        && isNullOrUndefined(this.customCharacters[curMask]))\n                        && ((this.hiddenMask[sIndex] !== this.promptChar && this.customRegExpCollec[sIndex][0] !== '['\n                            && this.customRegExpCollec[sIndex][this.customRegExpCollec[sIndex].length - 1] !== ']')))\n                        || (this.promptMask[sIndex] !== this.promptChar && isNullOrUndefined(this.customCharacters))) {\n                        this.element.selectionStart = this.element.selectionEnd = sIndex;\n                        event.preventDefault();\n                        if (event.keyCode === 46 && !multipleDel) {\n                            ++this.element.selectionStart;\n                        }\n                    }\n                    else {\n                        var value = this.element.value;\n                        var prompt_1 = this.promptChar;\n                        var elementValue = value.substring(0, sIndex) + prompt_1 + value.substring(startIndex, value.length);\n                        setElementValue.call(this, elementValue);\n                        event.preventDefault();\n                        this.element.selectionStart = this.element.selectionEnd = sIndex;\n                        isDeleted = true;\n                    }\n                    startIndex = this.element.selectionStart;\n                    if ((!isDeleted && event.keyCode === 8) || multipleDel || (!isDeleted && !(event.keyCode === 46))) {\n                        sIndex = startIndex - 1;\n                    }\n                    else {\n                        sIndex = startIndex;\n                        isDeleted = false;\n                    }\n                    oldValue = this.element.value[sIndex];\n                    if (((initStartIndex !== initEndIndex) && (this.element.selectionStart === initStartIndex))\n                        || (this.promptMask[sIndex] === this.promptChar) || ((oldValue !== this.promptMask[sIndex]) &&\n                        (this.promptMask[sIndex] !== this.promptChar) && !isNullOrUndefined(this.customCharacters))) {\n                        break;\n                    }\n                }\n            }\n        }\n        if (this.element.selectionStart === 0 && (this.element.selectionEnd === this.element.value.length)) {\n            setElementValue.call(this, this.promptMask);\n            event.preventDefault();\n            this.element.selectionStart = this.element.selectionEnd = startIndex;\n        }\n        this.redoCollec.unshift({\n            value: this.element.value, startIndex: this.element.selectionStart,\n            endIndex: this.element.selectionEnd\n        });\n        if (this.element.value !== preValue) {\n            triggerMaskChangeEvent.call(this, event, oldEventVal);\n        }\n    }\n}\nfunction maskInputKeyPressHandler(event) {\n    if (this.mask && !this.readonly) {\n        var oldValue = this.element.value;\n        if ((!event.ctrlKey) || (event.ctrlKey && event.code !== 'KeyA' && event.code !== 'KeyY'\n            && event.code !== 'KeyZ' && event.code !== 'KeyX' && event.code !== 'KeyC' && event.code !== 'KeyV')) {\n            this.maskKeyPress = true;\n            var key = event.key;\n            if (key === 'Spacebar') {\n                key = String.fromCharCode(event.keyCode);\n            }\n            if (!key) {\n                this.isIosInvalid = true;\n                validateValue.call(this, String.fromCharCode(event.keyCode), event.ctrlKey, event);\n                event.preventDefault();\n                this.isIosInvalid = false;\n            }\n            else if (key && key.length === 1) {\n                validateValue.call(this, key, event.ctrlKey, event);\n                event.preventDefault();\n            }\n            if (event.keyCode === 32 && key === ' ' && this.promptChar === ' ') {\n                this.element.selectionStart = this.element.selectionEnd = this.element.selectionStart - key.length;\n            }\n        }\n        if (this.element.value !== oldValue) {\n            triggerMaskChangeEvent.call(this, event, oldValue);\n        }\n    }\n}\nfunction triggerMaskChangeEvent(event, oldValue) {\n    var prevOnChange = this.isProtectedOnChange;\n    if (!isNullOrUndefined(this.changeEventArgs) && !this.isInitial) {\n        var eventArgs = {};\n        this.changeEventArgs = { value: this.element.value, maskedValue: this.element.value, isInteraction: false, isInteracted: false };\n        if (this.mask) {\n            this.changeEventArgs.value = strippedValue.call(this, this.element);\n        }\n        if (!isNullOrUndefined(event)) {\n            this.changeEventArgs.isInteracted = true;\n            this.changeEventArgs.isInteraction = true;\n            this.changeEventArgs.event = event;\n        }\n        this.isProtectedOnChange = true;\n        this.value = this.changeEventArgs.value;\n        this.isProtectedOnChange = prevOnChange;\n        merge(eventArgs, this.changeEventArgs);\n        this.trigger('change', eventArgs);\n    }\n    this.preEleVal = this.element.value;\n    this.prevValue = strippedValue.call(this, this.element);\n    attributes(this.element, { 'aria-valuenow': this.element.value });\n}\nfunction maskInputKeyUpHandler(event) {\n    if (this.mask && !this.readonly) {\n        var collec = void 0;\n        if (!this.maskKeyPress && event.keyCode === 229) {\n            var oldEventVal = void 0;\n            if (this.element.value.length === 1) {\n                this.element.value = this.element.value + this.promptMask;\n                this.element.setSelectionRange(1, 1);\n            }\n            if (this.element.value.length > this.promptMask.length) {\n                var startIndex = this.element.selectionStart;\n                var addedValues = this.element.value.length - this.promptMask.length;\n                var val_1 = this.element.value.substring(startIndex - addedValues, startIndex);\n                if (this.undoCollec.length > 0) {\n                    collec = this.undoCollec[this.undoCollec.length - 1];\n                    var startIndex_1 = this.element.selectionStart;\n                    oldEventVal = collec.value;\n                    var oldVal = collec.value.substring(startIndex_1 - addedValues, startIndex_1);\n                    collec = this.redoCollec[0];\n                    val_1 = val_1.trim();\n                    var isSpace = Browser.isAndroid && val_1 === '';\n                    if (!isSpace && oldVal !== val_1 && collec.value.substring(startIndex_1 - addedValues, startIndex_1) !== val_1) {\n                        validateValue.call(this, val_1, event.ctrlKey, event);\n                    }\n                    else if (isSpace) {\n                        preventUnsupportedValues.call(this, event, startIndex_1 - 1, this.element.selectionEnd - 1, val_1, event.ctrlKey, false);\n                    }\n                }\n                else {\n                    oldEventVal = this.promptMask;\n                    validateValue.call(this, val_1, event.ctrlKey, event);\n                }\n                this.maskKeyPress = false;\n                triggerMaskChangeEvent.call(this, event, oldEventVal);\n            }\n        }\n        else {\n            removeMaskError.call(this);\n        }\n        var val = strippedValue.call(this, this.element);\n        if (!((this.element.selectionStart === 0) && (this.promptMask === this.element.value) && val === '')\n            || (val === '' && this.value !== val)) {\n            this.prevValue = val;\n            this.value = val;\n        }\n    }\n    else {\n        triggerMaskChangeEvent.call(this, event);\n    }\n    if (this.element.selectionStart === 0 && this.element.selectionEnd === 0) {\n        // tslint:disable-next-line\n        var temp_1 = this.element;\n        setTimeout(function () {\n            temp_1.setSelectionRange(0, 0);\n        }, 0);\n    }\n}\nfunction mobileSwipeCheck(key) {\n    if (key.length > 1 && ((this.promptMask.length + key.length) < this.element.value.length)) {\n        var elementValue = this.redoCollec[0].value.substring(0, this.redoCollec[0].startIndex) + key +\n            this.redoCollec[0].value.substring(this.redoCollec[0].startIndex, this.redoCollec[0].value.length);\n        setElementValue.call(this, elementValue);\n        this.element.selectionStart = this.element.selectionEnd = this.redoCollec[0].startIndex + key.length;\n    }\n    this.element.selectionStart = this.element.selectionStart - key.length;\n    this.element.selectionEnd = this.element.selectionEnd - key.length;\n}\nfunction mobileValidation(key) {\n    if (!this.maskKeyPress) {\n        mobileSwipeCheck.call(this, key);\n    }\n}\nfunction validateValue(key, isCtrlKey, event) {\n    mobileValidation.call(this, key);\n    if (isNullOrUndefined(this) || isNullOrUndefined(key)) {\n        return;\n    }\n    var startIndex = this.element.selectionStart;\n    var initStartIndex = startIndex;\n    var endIndex = this.element.selectionEnd;\n    var curMask;\n    var allowText = false;\n    var value = this.element.value;\n    var eventOldVal;\n    var prevSupport = false;\n    var isEqualVal = false;\n    for (var k = 0; k < key.length; k++) {\n        var keyValue = key[k];\n        startIndex = this.element.selectionStart;\n        endIndex = this.element.selectionEnd;\n        if (!this.maskKeyPress && initStartIndex === startIndex) {\n            startIndex = startIndex + k;\n        }\n        if ((!this.maskKeyPress || startIndex < this.promptMask.length)) {\n            for (var i = startIndex; i < this.promptMask.length; i++) {\n                var maskValue = this.escapeMaskValue;\n                curMask = maskValue[startIndex];\n                if (this.hiddenMask[startIndex] === '\\\\' && this.hiddenMask[startIndex + 1] === key) {\n                    isEqualVal = true;\n                }\n                if ((isNullOrUndefined(this.regExpCollec[curMask]) && (isNullOrUndefined(this.customCharacters)\n                    || (!isNullOrUndefined(this.customCharacters) && isNullOrUndefined(this.customCharacters[curMask])))\n                    && ((this.hiddenMask[startIndex] !== this.promptChar && this.customRegExpCollec[startIndex][0] !== '['\n                        && this.customRegExpCollec[startIndex][this.customRegExpCollec[startIndex].length - 1] !== ']')))\n                    || ((this.promptMask[startIndex] !== this.promptChar) && isNullOrUndefined(this.customCharacters))\n                    || (this.promptChar === curMask && this.escapeMaskValue === this.mask)) {\n                    this.element.selectionStart = this.element.selectionEnd = startIndex + 1;\n                    startIndex = this.element.selectionStart;\n                    curMask = this.hiddenMask[startIndex];\n                }\n            }\n            if (!isNullOrUndefined(this.customCharacters) && !isNullOrUndefined(this.customCharacters[curMask])) {\n                var customValStr = this.customCharacters[curMask];\n                var customValArr = customValStr.split(',');\n                for (var i = 0; i < customValArr.length; i++) {\n                    if (keyValue.match(new RegExp('[' + customValArr[i] + ']'))) {\n                        allowText = true;\n                        break;\n                    }\n                }\n            }\n            else if (!isNullOrUndefined(this.regExpCollec[curMask]) && keyValue.match(new RegExp(this.regExpCollec[curMask]))\n                && this.promptMask[startIndex] === this.promptChar) {\n                allowText = true;\n            }\n            else if (this.promptMask[startIndex] === this.promptChar && this.customRegExpCollec[startIndex][0] === '['\n                && this.customRegExpCollec[startIndex][this.customRegExpCollec[startIndex].length - 1] === ']'\n                && keyValue.match(new RegExp(this.customRegExpCollec[startIndex]))) {\n                allowText = true;\n            }\n            if ((!this.maskKeyPress || startIndex < this.hiddenMask.length) && allowText) {\n                if (k === 0) {\n                    if (this.maskKeyPress) {\n                        this.undoCollec.push({ value: value, startIndex: startIndex, endIndex: startIndex });\n                    }\n                    else {\n                        var sIndex = this.element.selectionStart;\n                        var eIndex = this.element.selectionEnd;\n                        if (this.redoCollec.length > 0) {\n                            eventOldVal = this.redoCollec[0].value;\n                            setElementValue.call(this, eventOldVal);\n                            this.undoCollec.push(this.redoCollec[0]);\n                        }\n                        else {\n                            this.undoCollec.push({ value: this.promptMask, startIndex: startIndex, endIndex: startIndex });\n                            eventOldVal = this.promptMask;\n                            setElementValue.call(this, eventOldVal);\n                        }\n                        this.element.selectionStart = sIndex;\n                        this.element.selectionEnd = eIndex;\n                    }\n                }\n                startIndex = this.element.selectionStart;\n                applySupportedValues.call(this, event, startIndex, keyValue, eventOldVal, isEqualVal);\n                prevSupport = true;\n                if (k === key.length - 1) {\n                    this.redoCollec.unshift({\n                        value: this.element.value, startIndex: this.element.selectionStart, endIndex: this.element.selectionEnd\n                    });\n                }\n                allowText = false;\n            }\n            else {\n                startIndex = this.element.selectionStart;\n                preventUnsupportedValues.call(this, event, startIndex, initStartIndex, key, isCtrlKey, prevSupport);\n            }\n            if (k === key.length - 1 && !allowText) {\n                if (!Browser.isAndroid || (Browser.isAndroid && startIndex < this.promptMask.length)) {\n                    this.redoCollec.unshift({\n                        value: this.element.value, startIndex: this.element.selectionStart, endIndex: this.element.selectionEnd\n                    });\n                }\n            }\n        }\n        else {\n            if (key.length === 1 && !isCtrlKey && !isNullOrUndefined(event)) {\n                addMaskErrorClass.call(this);\n            }\n        }\n    }\n}\nfunction applySupportedValues(event, startIndex, keyValue, eventOldVal, isEqualVal) {\n    if (this.hiddenMask.length > this.promptMask.length) {\n        keyValue = changeToLowerUpperCase.call(this, keyValue, this.element.value);\n    }\n    if (!isEqualVal) {\n        var value = this.element.value;\n        var elementValue = value.substring(0, startIndex) + keyValue + value.substring(startIndex + 1, value.length);\n        setElementValue.call(this, elementValue);\n        this.element.selectionStart = this.element.selectionEnd = startIndex + 1;\n    }\n}\nfunction preventUnsupportedValues(event, sIdx, idx, key, ctrl, chkSupport) {\n    if (!this.maskKeyPress) {\n        var eventOldVal = void 0;\n        var value = this.element.value;\n        if (sIdx >= this.promptMask.length) {\n            setElementValue.call(this, value.substring(0, sIdx));\n        }\n        else {\n            if (idx === sIdx) {\n                setElementValue.call(this, value.substring(0, sIdx) + value.substring(sIdx + 1, value.length));\n            }\n            else {\n                if (this.promptMask.length === this.element.value.length) {\n                    setElementValue.call(this, value.substring(0, sIdx) + value.substring(sIdx, value.length));\n                }\n                else {\n                    setElementValue.call(this, value.substring(0, idx) + value.substring(idx + 1, value.length));\n                }\n            }\n            this.element.selectionStart = this.element.selectionEnd = (chkSupport ||\n                this.element.value[idx] !== this.promptChar) ? sIdx : idx;\n        }\n        eventOldVal = this.element.value;\n        addMaskErrorClass.call(this);\n    }\n    if (key.length === 1 && !ctrl && !isNullOrUndefined(event)) {\n        addMaskErrorClass.call(this);\n    }\n}\nfunction addMaskErrorClass() {\n    var _this = this;\n    var parentElement = this.element.parentNode;\n    var timer = 200;\n    if (parentElement.classList.contains(INPUTGROUP) || parentElement.classList.contains(FLOATINPUT)) {\n        addClass([parentElement], ERROR);\n    }\n    else {\n        addClass([this.element], ERROR);\n    }\n    if (this.isIosInvalid === true) {\n        timer = 400;\n    }\n    attributes(this.element, { 'aria-invalid': 'true' });\n    setTimeout(function () {\n        if (!_this.maskKeyPress) {\n            removeMaskError.call(_this);\n        }\n    }, timer);\n}\nfunction removeMaskError() {\n    var parentElement = this.element.parentNode;\n    if (!isNullOrUndefined(parentElement)) {\n        removeClass([parentElement], ERROR);\n    }\n    removeClass([this.element], ERROR);\n    attributes(this.element, { 'aria-invalid': 'false' });\n}\n/**\n * @hidden\n * Validates user input using masking elements '<' , '>' and '|'.\n */\nfunction changeToLowerUpperCase(key, value) {\n    var promptMask;\n    var i;\n    var j = 0;\n    var curVal = value;\n    var caseCount = 0;\n    for (i = 0; i < this.hiddenMask.length; i++) {\n        if (this.hiddenMask[i] === '\\\\') {\n            promptMask = curVal.substring(0, i) + '\\\\' + curVal.substring(i, curVal.length);\n        }\n        if (this.hiddenMask[i] === '>' || this.hiddenMask[i] === '<' || this.hiddenMask[i] === '|') {\n            if (this.hiddenMask[i] !== curVal[i]) {\n                promptMask = curVal.substring(0, i) + this.hiddenMask[i] + curVal.substring(i, curVal.length);\n            }\n            ++caseCount;\n        }\n        if (promptMask) {\n            if (((promptMask[i] === this.promptChar) && (i > this.element.selectionStart)) ||\n                (this.element.value.indexOf(this.promptChar) < 0 && (this.element.selectionStart + caseCount) === i)) {\n                caseCount = 0;\n                break;\n            }\n            curVal = promptMask;\n        }\n    }\n    while (i >= 0 && promptMask) {\n        if (i === 0 || promptMask[i - 1] !== '\\\\') {\n            var val = this.element.value;\n            if (promptMask[i] === '>') {\n                key = key.toUpperCase();\n                break;\n            }\n            else if (promptMask[i] === '<') {\n                key = key.toLowerCase();\n                break;\n            }\n            else if (promptMask[i] === '|') {\n                break;\n            }\n        }\n        --i;\n    }\n    return key;\n}\n/**\n * @hidden\n * To set updated values in the MaskedTextBox.\n */\nexport function setMaskValue(val) {\n    if (this.mask && val !== undefined && (this.prevValue === undefined || this.prevValue !== val)) {\n        this.maskKeyPress = true;\n        setElementValue.call(this, this.promptMask);\n        if (val !== '' && !(val === null && this.floatLabelType === 'Never' && this.placeholder)) {\n            this.element.selectionStart = 0;\n            this.element.selectionEnd = 0;\n        }\n        if (val !== null) {\n            for (var i = 0; i < val.length; i++) {\n                validateValue.call(this, val[i], false, null);\n            }\n        }\n        var newVal = strippedValue.call(this, this.element);\n        this.prevValue = newVal;\n        this.value = newVal;\n        triggerMaskChangeEvent.call(this, null, null);\n        this.maskKeyPress = false;\n        var labelElement = this.element.parentNode.querySelector('.e-float-text');\n        if (this.element.value === this.promptMask && this.floatLabelType === 'Auto' && this.placeholder &&\n            !isNullOrUndefined(labelElement) && labelElement.classList.contains(TOPLABEL) && !this.isFocus) {\n            removeClass([labelElement], TOPLABEL);\n            addClass([labelElement], BOTTOMLABEL);\n            setElementValue.call(this, '');\n        }\n    }\n    if (this.mask === null || this.mask === '' && this.value !== undefined) {\n        setElementValue.call(this, this.value);\n    }\n}\n/**\n * @hidden\n * To set updated values in the input element.\n */\nexport function setElementValue(val, element) {\n    if (!this.isFocus && this.floatLabelType === 'Auto' && this.placeholder && isNullOrUndefined(this.value)) {\n        val = '';\n    }\n    var value = strippedValue.call(this, (element ? element : this.element), val);\n    if (value === null || value === '') {\n        Input.setValue(val, (element ? element : this.element), this.floatLabelType, false);\n        if (this.showClearButton) {\n            this.inputObj.clearButton.classList.add('e-clear-icon-hide');\n        }\n    }\n    else {\n        Input.setValue(val, (element ? element : this.element), this.floatLabelType, this.showClearButton);\n    }\n}\n/**\n * @hidden\n * Provide mask support to input textbox through utility method.\n */\nexport function maskInput(args) {\n    var inputEle = getMaskInput(args);\n    applyMask.call(inputEle);\n    var val = strippedValue.call(this, this.element);\n    this.prevValue = val;\n    this.value = val;\n    if (args.mask) {\n        unwireEvents.call(inputEle);\n        wireEvents.call(inputEle);\n    }\n}\nfunction getMaskInput(args) {\n    addClass([args.element], UTILMASK);\n    var inputEle = {\n        element: args.element,\n        mask: args.mask,\n        promptMask: '',\n        hiddenMask: '',\n        escapeMaskValue: '',\n        promptChar: args.promptChar ? (args.promptChar.length > 1) ? args.promptChar = args.promptChar[0]\n            : args.promptChar : '_',\n        value: args.value ? args.value : null,\n        regExpCollec: regularExpressions,\n        customRegExpCollec: [],\n        customCharacters: args.customCharacters,\n        undoCollec: [],\n        redoCollec: [],\n        maskKeyPress: false,\n        prevValue: ''\n    };\n    createMask.call(inputEle);\n    return inputEle;\n}\n/**\n * @hidden\n * Gets raw value of the textbox which has been masked through utility method.\n */\nexport function getVal(args) {\n    return strippedValue.call(getUtilMaskEle(args), args.element);\n}\n/**\n * @hidden\n * Gets masked value of the textbox which has been masked through utility method.\n */\nexport function getMaskedVal(args) {\n    return unstrippedValue.call(getUtilMaskEle(args), args.element);\n}\nfunction getUtilMaskEle(args) {\n    var value = '';\n    var inputEle;\n    if (!isNullOrUndefined(args) && args.element.classList.contains(UTILMASK)) {\n        inputEle = getMaskInput(args);\n    }\n    return inputEle;\n}\n/**\n * @hidden\n * Arguments to perform undo and redo functionalities.\n */\nvar MaskUndo = /** @class */ (function () {\n    function MaskUndo() {\n    }\n    return MaskUndo;\n}());\nexport { MaskUndo };\nvar maskUndo = new MaskUndo();\n"]},"metadata":{},"sourceType":"module"}