{"ast":null,"code":"import { extend, isNullOrUndefined, createElement, EventHandler, addClass, append, removeClass, remove, closest, classList, isBlazor } from '@syncfusion/ej2-base';\nimport { DataManager, Query } from '@syncfusion/ej2-data';\nimport { TreeView } from '@syncfusion/ej2-navigations';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { Data } from '../actions/data';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\n\nvar ResourceBase =\n/** @class */\nfunction () {\n  function ResourceBase(parent) {\n    this.resourceCollection = [];\n    this.leftPixel = 25;\n    this.parent = parent;\n  }\n\n  ResourceBase.prototype.renderResourceHeaderIndent = function (tr) {\n    var resColTd = createElement('td', {\n      className: cls.RESOURCE_LEFT_TD_CLASS\n    });\n    var resColDiv = createElement('div', {\n      className: cls.RESOURCE_TEXT_CLASS\n    });\n    resColTd.appendChild(resColDiv);\n    var args = {\n      elementType: 'emptyCells',\n      element: resColTd\n    };\n    this.parent.trigger(events.renderCell, args);\n    tr.appendChild(resColTd);\n  };\n\n  ResourceBase.prototype.hideResourceRows = function (tBody) {\n    if (this.resourceCollection.length <= 1 || this.parent.virtualScrollModule) {\n      return;\n    }\n\n    var trCount = this.lastResourceLevel.length;\n\n    for (var i = 0; i < trCount; i++) {\n      var resData = this.lastResourceLevel[i].resourceData;\n      var res = this.lastResourceLevel[i].resource;\n\n      if (resData.ClassName === cls.RESOURCE_PARENT_CLASS && !resData[res.expandedField] && !isNullOrUndefined(resData[res.expandedField])) {\n        var trCollection = [].slice.call(tBody.children);\n        var slicedCollection = trCollection.slice(i + 1, i + (parseInt(resData.Count, 0) + 1));\n        addClass(slicedCollection, cls.HIDDEN_CLASS);\n      }\n    }\n  };\n\n  ResourceBase.prototype.createResourceColumn = function () {\n    var resColl = this.resourceCollection;\n    var resDiv = createElement('div', {\n      className: cls.RESOURCE_COLUMN_WRAP_CLASS\n    });\n    var tbl = this.parent.activeView.createTableLayout(cls.RESOURCE_COLUMN_TABLE_CLASS);\n\n    if (!this.parent.uiStateValues.isGroupAdaptive && this.parent.rowAutoHeight && this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0) {\n      addClass([tbl], cls.AUTO_HEIGHT);\n    }\n\n    if (this.parent.eventSettings.ignoreWhitespace) {\n      addClass([tbl], cls.IGNORE_WHITESPACE);\n    }\n\n    var tBody = tbl.querySelector('tbody');\n    var resData = this.generateTreeData(true);\n    this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n    this.renderedResources = this.lastResourceLevel;\n\n    if (this.parent.virtualScrollModule) {\n      var resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n      this.setExpandedResources();\n      resData = this.expandedResources.slice(0, resourceCount);\n      this.renderedResources = resData;\n    }\n\n    append(this.getContentRows(resData), tBody);\n    this.hideResourceRows(tBody);\n    tbl.appendChild(tBody);\n    resDiv.appendChild(tbl);\n    return resDiv;\n  };\n\n  ResourceBase.prototype.setRenderedResources = function () {\n    var resColl = this.resourceCollection;\n    this.generateTreeData(true);\n    this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n    this.renderedResources = this.lastResourceLevel;\n  };\n\n  ResourceBase.prototype.setExpandedResources = function () {\n    var resources = [];\n\n    for (var i = 0; i < this.lastResourceLevel.length; i++) {\n      var resource = this.lastResourceLevel[i].resourceData;\n      var count = resource.Count;\n      resources.push(this.lastResourceLevel[i]);\n      var isExpanded = resource[this.lastResourceLevel[i].resource.expandedField];\n\n      if (!isNullOrUndefined(isExpanded) && !isExpanded && count > 0) {\n        i = i + count;\n      }\n    }\n\n    this.expandedResources = resources;\n  };\n\n  ResourceBase.prototype.getContentRows = function (resData) {\n    var resRows = [];\n    var left;\n    var rIndex;\n    var resColl = this.resourceCollection;\n    var tr = createElement('tr');\n    var td = createElement('td');\n\n    for (var i = 0; i < resData.length; i++) {\n      var ntd = td.cloneNode();\n      rIndex = util.findIndexInData(resColl, 'name', resData[i].resource.name);\n\n      if (rIndex === resColl.length - 1) {\n        extend(resData[i].resourceData, {\n          ClassName: cls.RESOURCE_CHILD_CLASS\n        });\n        this.renderedResources[i].className = [cls.RESOURCE_CHILD_CLASS];\n      } else {\n        extend(resData[i].resourceData, {\n          ClassName: cls.RESOURCE_PARENT_CLASS\n        });\n        this.renderedResources[i].className = [cls.RESOURCE_PARENT_CLASS];\n      }\n\n      left = rIndex * this.leftPixel + 'px';\n\n      if (resData[i].resourceData.ClassName === cls.RESOURCE_PARENT_CLASS && !isNullOrUndefined(resData[i].resourceData.Count) && resData[i].resourceData.Count > 0) {\n        var iconClass = void 0;\n\n        if (resData[i].resourceData[resColl[rIndex].expandedField] || isNullOrUndefined(resData[i].resourceData[resColl[rIndex].expandedField])) {\n          iconClass = cls.RESOURCE_COLLAPSE_CLASS;\n        } else {\n          iconClass = cls.RESOURCE_EXPAND_CLASS;\n        }\n\n        var iconDiv = createElement('div');\n        addClass([iconDiv], [cls.RESOURCE_TREE_ICON_CLASS, iconClass]);\n        this.setMargin(iconDiv, left);\n        ntd.appendChild(iconDiv);\n\n        if (this.resourceCollection.length > 1) {\n          EventHandler.add(iconDiv, 'click', this.onTreeIconClick, this);\n        }\n      }\n\n      this.parent.activeView.setResourceHeaderContent(ntd, resData[i], cls.RESOURCE_TEXT_CLASS);\n      ntd.setAttribute('data-group-index', resData[i].groupIndex.toString());\n\n      if (!this.parent.activeViewOptions.resourceHeaderTemplate) {\n        this.setMargin(ntd.querySelector('.' + cls.RESOURCE_TEXT_CLASS), left);\n      }\n\n      var classCollection = [cls.RESOURCE_CELLS_CLASS, resData[i].resourceData.ClassName];\n      addClass([ntd], classCollection);\n      var args = {\n        elementType: 'resourceHeader',\n        element: ntd,\n        groupIndex: resData[i].groupIndex\n      };\n      this.parent.trigger(events.renderCell, args);\n      var ntr = tr.cloneNode();\n      ntr.appendChild(ntd);\n      resRows.push(ntr);\n    }\n\n    return resRows;\n  };\n\n  ResourceBase.prototype.setMargin = function (element, value) {\n    if (!this.parent.enableRtl) {\n      element.style.marginLeft = value;\n    } else {\n      element.style.marginRight = value;\n    }\n  };\n\n  ResourceBase.prototype.countCalculation = function (parentCollection, wholeCollection) {\n    var collection;\n\n    for (var y = 0; y < parentCollection.length; y++) {\n      var data = parentCollection[parentCollection.length - (y + 1)].dataSource;\n\n      for (var x = 0; x < data.length; x++) {\n        var totalCount = 0;\n\n        if (this.parent.activeViewOptions.group.byGroupID) {\n          collection = new DataManager(wholeCollection[wholeCollection.length - 1].dataSource).executeLocal(new Query().where(wholeCollection[wholeCollection.length - 1].groupIDField, 'equal', data[x][parentCollection[parentCollection.length - (y + 1)].idField]));\n        } else {\n          collection = wholeCollection[wholeCollection.length - 1].dataSource;\n        }\n\n        for (var z = 0; z < collection.length; z++) {\n          totalCount = totalCount + parseInt(collection[z].Count, 0);\n        }\n\n        totalCount = totalCount + parseInt(data[x].Count, 0);\n        extend(data[x], {\n          Count: totalCount\n        });\n      }\n\n      wholeCollection = wholeCollection.slice(0, -1);\n    }\n  };\n\n  ResourceBase.prototype.onTreeIconClick = function (e) {\n    var _this = this;\n\n    if (this.parent.eventTooltip) {\n      this.parent.eventTooltip.close();\n    }\n\n    var target = e.target;\n    var hide;\n    var trElement = closest(target, '.' + cls.RESOURCE_PARENT_CLASS).parentElement;\n    var index = parseInt(trElement.children[0].getAttribute('data-group-index'), 10);\n    var args = {\n      cancel: false,\n      event: e,\n      groupIndex: index,\n      requestType: !target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS) ? 'resourceExpand' : 'resourceCollapse'\n    };\n    this.parent.trigger(events.actionBegin, args, function (actionArgs) {\n      if (!actionArgs.cancel) {\n        if (target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS)) {\n          classList(target, [cls.RESOURCE_EXPAND_CLASS], [cls.RESOURCE_COLLAPSE_CLASS]);\n          hide = true;\n        } else {\n          classList(target, [cls.RESOURCE_COLLAPSE_CLASS], [cls.RESOURCE_EXPAND_CLASS]);\n          hide = false;\n        }\n\n        var eventElements = [].slice.call(_this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n        eventElements.forEach(function (node) {\n          return remove(node);\n        });\n\n        if (_this.parent.virtualScrollModule) {\n          _this.updateVirtualContent(index, hide);\n        } else {\n          _this.updateContent(index, hide);\n        }\n\n        var data = {\n          cssProperties: _this.parent.getCssProperties(),\n          module: 'scroll'\n        };\n\n        _this.parent.notify(events.scrollUiUpdate, data);\n\n        args = {\n          cancel: false,\n          event: e,\n          groupIndex: index,\n          requestType: target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS) ? 'resourceExpanded' : 'resourceCollapsed'\n        };\n\n        _this.parent.notify(events.dataReady, {});\n\n        _this.parent.trigger(events.actionComplete, args);\n      }\n    });\n  };\n\n  ResourceBase.prototype.updateContent = function (index, hide) {\n    var rowCollection = [];\n    var workCellCollection = [];\n    var headerRowCollection = [];\n    var pNode;\n    var clickedRes = this.lastResourceLevel[index].resourceData;\n    var resRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'tr'));\n    var contentRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_WRAP_CLASS + ' ' + 'tbody tr'));\n    var eventRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_WRAP_CLASS + ' .' + cls.APPOINTMENT_CONTAINER_CLASS));\n\n    for (var j = 0; j < clickedRes.Count; j++) {\n      rowCollection.push(resRows[index + j + 1]);\n      workCellCollection.push(contentRows[index + j + 1]);\n      headerRowCollection.push(eventRows[index + j + 1]);\n    }\n\n    var clonedCollection = this.lastResourceLevel;\n\n    for (var i = 0; i < rowCollection.length; i++) {\n      var expanded = true;\n      pNode = rowCollection[i].children[0].classList.contains(cls.RESOURCE_PARENT_CLASS);\n      clonedCollection[index].resourceData[clonedCollection[index].resource.expandedField] = !hide;\n\n      if (hide) {\n        if (pNode) {\n          var trElem = rowCollection[i].querySelector('.' + cls.RESOURCE_TREE_ICON_CLASS);\n\n          if (trElem) {\n            classList(trElem, [cls.RESOURCE_EXPAND_CLASS], [cls.RESOURCE_COLLAPSE_CLASS]);\n          }\n        }\n\n        if (!rowCollection[i].classList.contains(cls.HIDDEN_CLASS)) {\n          addClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], cls.HIDDEN_CLASS);\n        }\n      } else {\n        if (pNode) {\n          var rowIndex = rowCollection[i].rowIndex;\n\n          if (!clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField] && !isNullOrUndefined(clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField])) {\n            rowCollection.splice(i + 1, parseInt(clonedCollection[rowIndex].resourceData.Count, 0));\n            workCellCollection.splice(i + 1, parseInt(clonedCollection[rowIndex].resourceData.Count, 0));\n            headerRowCollection.splice(i + 1, parseInt(clonedCollection[rowIndex].resourceData.Count, 0));\n            expanded = false;\n          }\n\n          if (expanded) {\n            var trElem = rowCollection[i].querySelector('.' + cls.RESOURCE_TREE_ICON_CLASS);\n\n            if (trElem) {\n              classList(trElem, [cls.RESOURCE_COLLAPSE_CLASS], [cls.RESOURCE_EXPAND_CLASS]);\n            }\n          }\n        }\n\n        if (rowCollection[i].classList.contains(cls.HIDDEN_CLASS)) {\n          removeClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], cls.HIDDEN_CLASS);\n        }\n      }\n    }\n  };\n\n  ResourceBase.prototype.updateVirtualContent = function (index, expand) {\n    this.lastResourceLevel[index].resourceData[this.lastResourceLevel[index].resource.expandedField] = !expand;\n    this.setExpandedResources();\n    var resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n    var startIndex = this.expandedResources.indexOf(this.renderedResources[0]);\n    this.renderedResources = this.expandedResources.slice(startIndex, startIndex + resourceCount);\n\n    if (this.renderedResources.length < resourceCount) {\n      var sIndex = this.expandedResources.length - resourceCount;\n      sIndex = sIndex > 0 ? sIndex : 0;\n      this.renderedResources = this.expandedResources.slice(sIndex, this.expandedResources.length);\n    }\n\n    var virtualTrack = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n    this.parent.virtualScrollModule.updateVirtualTrackHeight(virtualTrack);\n    var resTable = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'table');\n    var contentTable = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' ' + 'table');\n    var eventTable = this.parent.element.querySelector('.' + cls.EVENT_TABLE_CLASS);\n    this.parent.virtualScrollModule.updateContent(resTable, contentTable, eventTable, this.renderedResources);\n    var timeIndicator = this.parent.element.querySelector('.' + cls.CURRENT_TIMELINE_CLASS);\n\n    if (!isNullOrUndefined(timeIndicator)) {\n      timeIndicator.style.height = this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS).offsetHeight + 'px';\n    }\n  };\n\n  ResourceBase.prototype.renderResourceHeader = function () {\n    var resourceWrapper = createElement('div', {\n      className: cls.RESOURCE_TOOLBAR_CONTAINER\n    });\n    resourceWrapper.innerHTML = '<div class=\"' + cls.RESOURCE_HEADER_TOOLBAR + '\"><div class=\"' + cls.RESOURCE_MENU + '\">' + '<div class=\"e-icons ' + cls.RESOURCE_MENU_ICON + '\"></div></div><div class=\"' + cls.RESOURCE_LEVEL_TITLE + '\"></div></div>';\n\n    if (this.parent.currentView === 'MonthAgenda') {\n      var target = this.parent.activeView.getPanel().querySelector('.' + cls.CONTENT_WRAP_CLASS);\n      target.insertBefore(resourceWrapper, target.querySelector('.' + cls.WRAPPER_CONTAINER_CLASS));\n    } else {\n      this.parent.element.insertBefore(resourceWrapper, this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS));\n    }\n\n    this.renderResourceHeaderText();\n    EventHandler.add(resourceWrapper.querySelector('.' + cls.RESOURCE_MENU_ICON), 'click', this.menuClick, this);\n  };\n\n  ResourceBase.prototype.renderResourceTree = function () {\n    this.popupOverlay = createElement('div', {\n      className: cls.RESOURCE_TREE_POPUP_OVERLAY\n    });\n    var treeWrapper = createElement('div', {\n      className: cls.RESOURCE_TREE_POPUP + ' e-popup-close'\n    });\n\n    if (this.parent.currentView === 'MonthAgenda') {\n      var target = this.parent.activeView.getPanel().querySelector('.' + cls.WRAPPER_CONTAINER_CLASS);\n      target.insertBefore(treeWrapper, target.children[0]);\n      target.appendChild(this.popupOverlay);\n    } else {\n      this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS).appendChild(treeWrapper);\n      this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS).appendChild(this.popupOverlay);\n    }\n\n    var resourceTree = createElement('div', {\n      className: cls.RESOURCE_TREE\n    });\n    treeWrapper.appendChild(resourceTree);\n    this.treeViewObj = new TreeView({\n      cssClass: this.parent.cssClass,\n      enableRtl: this.parent.enableRtl,\n      fields: {\n        dataSource: [].slice.call(this.generateTreeData()),\n        id: 'resourceId',\n        text: 'resourceName',\n        child: 'resourceChild'\n      },\n      nodeTemplate: this.parent.resourceHeaderTemplate,\n      nodeClicked: this.resourceClick.bind(this)\n    });\n    this.treeViewObj.appendTo(resourceTree);\n    this.treeViewObj.expandAll();\n    this.treePopup = new Popup(treeWrapper, {\n      targetType: 'relative',\n      actionOnScroll: 'none',\n      content: this.treeViewObj.element,\n      enableRtl: this.parent.enableRtl,\n      hideAnimation: {\n        name: 'SlideLeftOut',\n        duration: 500\n      },\n      showAnimation: {\n        name: 'SlideLeftIn',\n        duration: 500\n      },\n      viewPortElement: this.parent.element.querySelector('.' + (this.parent.currentView === 'MonthAgenda' ? cls.WRAPPER_CONTAINER_CLASS : cls.TABLE_CONTAINER_CLASS))\n    });\n    this.parent.on(events.documentClick, this.documentClick, this);\n  };\n\n  ResourceBase.prototype.generateTreeData = function (isTimeLine) {\n    var _this = this;\n\n    var treeCollection = [];\n    var resTreeColl = [];\n    var groupIndex = 0;\n    this.resourceTreeLevel.forEach(function (resTree, index) {\n      var treeHandler = function (treeLevel, index, levelId) {\n        var resource = _this.resourceCollection[index];\n        var treeArgs;\n        var resObj;\n\n        if (!isTimeLine) {\n          treeArgs = {\n            resourceId: levelId,\n            resourceName: treeLevel.resourceData[resource.textField],\n            resource: treeLevel.resource,\n            resourceData: treeLevel.resourceData\n          };\n        } else {\n          resObj = {\n            type: 'resourceHeader',\n            resource: treeLevel.resource,\n            resourceData: treeLevel.resourceData,\n            groupIndex: groupIndex,\n            groupOrder: treeLevel.groupOrder\n          };\n          resTreeColl.push(resObj);\n          groupIndex++;\n        }\n\n        if (treeLevel.child.length > 0 && !isTimeLine) {\n          treeArgs.resourceChild = [];\n        }\n\n        var count = 1;\n\n        for (var _i = 0, _a = treeLevel.child; _i < _a.length; _i++) {\n          var tree = _a[_i];\n\n          if (!isTimeLine) {\n            treeArgs.resourceChild.push(treeHandler(tree, index + 1, levelId + '-' + count));\n          } else {\n            treeHandler(tree, index + 1, levelId + '-' + count);\n          }\n\n          count += 1;\n        }\n\n        if (isTimeLine) {\n          extend(resObj.resourceData, {\n            Count: count - 1\n          });\n        }\n\n        return treeArgs;\n      };\n\n      if (!isTimeLine) {\n        treeCollection.push(treeHandler(resTree, 0, (index + 1).toString()));\n      } else {\n        treeHandler(resTree, 0, (index + 1).toString());\n      }\n    });\n\n    if (isTimeLine) {\n      this.lastResourceLevel = resTreeColl;\n      return resTreeColl;\n    } else {\n      return treeCollection;\n    }\n  };\n\n  ResourceBase.prototype.renderResourceHeaderText = function () {\n    var _this = this;\n\n    var resource = this.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n    var headerCollection = [];\n    resource.groupOrder.forEach(function (level, index) {\n      var resourceLevel = _this.resourceCollection[index];\n      var resourceText = resourceLevel.dataSource.filter(function (resData) {\n        return resData[resourceLevel.idField] === level;\n      });\n      var resourceName = createElement('div', {\n        className: cls.RESOURCE_NAME,\n        innerHTML: resourceText[0][resourceLevel.textField]\n      });\n      headerCollection.push(resourceName);\n      var levelIcon = createElement('div', {\n        className: 'e-icons e-icon-next'\n      });\n      headerCollection.push(levelIcon);\n    });\n    headerCollection.pop();\n    var target = this.parent.currentView === 'MonthAgenda' ? this.parent.activeView.getPanel() : this.parent.element;\n    var headerWrapper = target.querySelector('.' + cls.RESOURCE_LEVEL_TITLE);\n    util.removeChildren(headerWrapper);\n    headerCollection.forEach(function (element) {\n      return headerWrapper.appendChild(element);\n    });\n\n    if (this.lastResourceLevel.length === 1) {\n      addClass([this.parent.element.querySelector('.' + cls.RESOURCE_MENU)], cls.DISABLE_CLASS);\n    }\n  };\n\n  ResourceBase.prototype.menuClick = function (event) {\n    if (this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP).classList.contains(cls.POPUP_OPEN)) {\n      this.treePopup.hide();\n      removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n    } else {\n      var treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n      removeClass(treeNodes, 'e-active');\n      addClass([treeNodes[this.parent.uiStateValues.groupIndex]], 'e-active');\n      this.treePopup.show();\n      addClass([this.popupOverlay], cls.ENABLE_CLASS);\n    }\n  };\n\n  ResourceBase.prototype.resourceClick = function (event) {\n    var _this = this;\n\n    if (!event.node.classList.contains('e-has-child')) {\n      this.treePopup.hide();\n      removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n      var treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n      this.parent.uiStateValues.groupIndex = treeNodes.indexOf(event.node);\n\n      if (this.parent.isServerRenderer()) {\n        // tslint:disable-next-line:no-any\n        this.parent.interopAdaptor.invokeMethodAsync('OnResourceClick', this.parent.uiStateValues.groupIndex).then(function () {\n          if (_this.parent.isDestroyed) {\n            return;\n          }\n\n          _this.renderResourceHeaderText();\n\n          _this.parent.activeView.serverRenderLayout();\n\n          var processed = _this.parent.eventBase.processData(_this.parent.eventsData);\n\n          _this.parent.notify(events.dataReady, {\n            processedData: processed\n          });\n        }).catch(function (e) {\n          return _this.dataManagerFailure(e);\n        });\n      } else {\n        this.parent.renderModule.render(this.parent.currentView, false);\n        var processed = this.parent.eventBase.processData(this.parent.eventsData);\n        this.parent.notify(events.dataReady, {\n          processedData: processed\n        });\n      }\n    }\n\n    event.event.preventDefault();\n  };\n\n  ResourceBase.prototype.documentClick = function (args) {\n    if (closest(args.event.target, '.' + cls.RESOURCE_TREE_POPUP)) {\n      return;\n    }\n\n    var treeWrapper = this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP);\n\n    if (treeWrapper && treeWrapper.classList.contains(cls.POPUP_OPEN)) {\n      this.treePopup.hide();\n      removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n    }\n  };\n\n  ResourceBase.prototype.bindResourcesData = function (isSetModel) {\n    var _this = this;\n\n    this.parent.showSpinner();\n\n    if (isBlazor()) {\n      // the resourceCollection will be updated in layoutReady method\n      // tslint:disable-next-line:no-any\n      // (this.parent as any).interopAdaptor.invokeMethodAsync('BindResourcesData').then((result: string) => {\n      //     if (this.parent.isDestroyed) { return; }\n      //     this.parent.resourceCollection = DataUtil.parse.parseJson(result);\n      //     this.refreshLayout(isSetModel);\n      // }).catch((e: ReturnType) => this.dataManagerFailure(e));\n      return;\n    }\n\n    var promises = [];\n\n    for (var i = 0; i < this.parent.resources.length; i++) {\n      var dataModule = new Data(this.parent.resources[i].dataSource, this.parent.resources[i].query);\n      promises.push(dataModule.getData(dataModule.generateQuery()));\n    }\n\n    Promise.all(promises).then(function (e) {\n      return _this.dataManagerSuccess(e, isSetModel);\n    }).catch(function (e) {\n      return _this.dataManagerFailure(e);\n    });\n  };\n\n  ResourceBase.prototype.dataManagerSuccess = function (e, isSetModel) {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.resourceCollection = [];\n\n    for (var i = 0, length_1 = e.length; i < length_1; i++) {\n      var resource = this.parent.resources[i];\n      var resourceObj = this.getResourceModel(resource, e[i].result);\n      this.parent.resourceCollection.push(resourceObj);\n    }\n\n    this.refreshLayout(isSetModel);\n  };\n\n  ResourceBase.prototype.getResourceModel = function (resource, resourceData) {\n    var resourceObj = {\n      field: resource.field,\n      title: resource.title,\n      name: resource.name,\n      allowMultiple: resource.allowMultiple,\n      dataSource: resourceData || resource.dataSource,\n      idField: resource.idField,\n      textField: resource.textField,\n      groupIDField: resource.groupIDField,\n      colorField: resource.colorField,\n      startHourField: resource.startHourField,\n      endHourField: resource.endHourField,\n      workDaysField: resource.workDaysField,\n      expandedField: resource.expandedField,\n      cssClassField: resource.cssClassField\n    };\n    return resourceObj;\n  };\n\n  ResourceBase.prototype.refreshLayout = function (isSetModel) {\n    this.parent.uiStateValues.groupIndex = 0;\n    this.parent.renderElements(isSetModel);\n  };\n\n  ResourceBase.prototype.setResourceCollection = function () {\n    var requiredResources = [];\n    this.resourceCollection = [];\n    this.colorIndex = null;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      for (var _i = 0, _a = this.parent.activeViewOptions.group.resources; _i < _a.length; _i++) {\n        var resource = _a[_i];\n        var index_1 = util.findIndexInData(this.parent.resourceCollection, 'name', resource);\n\n        if (index_1 >= 0) {\n          requiredResources.push(this.parent.resourceCollection[index_1]);\n        }\n      }\n    } else if (this.parent.resourceCollection.length > 0) {\n      requiredResources = this.parent.resourceCollection;\n    }\n\n    var index = 0;\n\n    for (var _b = 0, requiredResources_1 = requiredResources; _b < requiredResources_1.length; _b++) {\n      var resource = requiredResources_1[_b];\n      var resources = this.getResourceModel(resource);\n\n      if (resource.name === this.parent.eventSettings.resourceColorField) {\n        this.colorIndex = index;\n      }\n\n      index++;\n      this.resourceCollection.push(resources);\n    }\n\n    if (isNullOrUndefined(this.colorIndex)) {\n      this.colorIndex = this.resourceCollection.length - 1;\n    }\n  };\n\n  ResourceBase.prototype.generateResourceLevels = function (innerDates, isTimeLine) {\n    var _this = this;\n\n    var resources = this.resourceCollection;\n    var resTreeGroup = [];\n    var lastColumnDates = [];\n\n    var group = function (resources, index, prevResource, prevResourceData, prevOrder) {\n      var resTree = [];\n      var resource = resources[0];\n\n      if (resource) {\n        var data = void 0;\n\n        if (prevResourceData && _this.parent.activeViewOptions.group.byGroupID) {\n          var id = prevResourceData[prevResource.idField];\n          data = new DataManager(resource.dataSource).executeLocal(new Query().where(resource.groupIDField, 'equal', id));\n        } else {\n          data = resource.dataSource;\n        }\n\n        for (var i = 0; i < data.length; i++) {\n          var groupOrder = [];\n\n          if (prevOrder && prevOrder.length > 0) {\n            groupOrder = groupOrder.concat(prevOrder);\n          }\n\n          groupOrder.push(data[i][resource.idField]);\n          var items = group(resources.slice(1), index + 1, resource, data[i], groupOrder); // Here validate child item empty top level resource only\n\n          if (index === 0 && items.length === 0 && _this.resourceCollection.length > 1) {\n            continue;\n          }\n\n          var dateCol = [];\n          var renderDates = _this.parent.activeView.renderDates;\n          var resWorkDays = void 0;\n\n          if (!_this.parent.activeViewOptions.group.byDate && index + 1 === _this.resourceCollection.length) {\n            var workDays = data[i][resource.workDaysField];\n            var resStartHour = data[i][resource.startHourField];\n            var resEndHour = data[i][resource.endHourField];\n\n            if (workDays && workDays.length > 0) {\n              renderDates = _this.parent.activeView.getRenderDates(workDays);\n              resWorkDays = workDays;\n              dateCol = _this.parent.activeView.getDateSlots(renderDates, workDays);\n            } else {\n              resWorkDays = _this.parent.activeViewOptions.workDays;\n              dateCol = innerDates;\n            }\n\n            var dateSlots = _this.generateCustomHours(dateCol, resStartHour, resEndHour, groupOrder);\n\n            lastColumnDates = lastColumnDates.concat(dateSlots);\n          }\n\n          var resCssClass = data[i][resource.cssClassField];\n          var slotData = {\n            type: 'resourceHeader',\n            className: ['e-resource-cells'],\n            resourceLevelIndex: index,\n            groupOrder: groupOrder,\n            resource: resource,\n            resourceData: data[i],\n            colSpan: _this.parent.activeViewOptions.group.byDate ? 1 : dateCol.length,\n            renderDates: renderDates,\n            workDays: resWorkDays,\n            cssClass: resCssClass,\n            child: items\n          };\n          resTree.push(slotData);\n        }\n\n        if (!resTreeGroup[index]) {\n          resTreeGroup[index] = [];\n        }\n\n        resTreeGroup[index].push(resTree);\n        return resTree;\n      }\n\n      return [];\n    };\n\n    this.resourceTreeLevel = group(resources, 0);\n    return isTimeLine ? [] : this.generateHeaderLevels(resTreeGroup, lastColumnDates, innerDates);\n  };\n\n  ResourceBase.prototype.generateCustomHours = function (renderDates, startHour, endHour, groupOrder) {\n    var dateSlots = extend([], renderDates, null, true);\n\n    for (var _i = 0, dateSlots_1 = dateSlots; _i < dateSlots_1.length; _i++) {\n      var dateSlot = dateSlots_1[_i];\n\n      if (startHour) {\n        dateSlot.startHour = this.parent.getStartEndTime(startHour);\n      }\n\n      if (endHour) {\n        dateSlot.endHour = this.parent.getStartEndTime(endHour);\n      }\n\n      if (groupOrder) {\n        dateSlot.groupOrder = groupOrder;\n      }\n    }\n\n    return dateSlots;\n  };\n\n  ResourceBase.prototype.generateHeaderLevels = function (resTreeGroup, lastColumnDates, headerDates) {\n    var headerLevels = [];\n\n    for (var i = resTreeGroup.length - 1; i >= 0; i--) {\n      var temp = 0;\n\n      for (var _i = 0, _a = resTreeGroup[i]; _i < _a.length; _i++) {\n        var currentLevelChilds = _a[_i];\n\n        for (var _b = 0, currentLevelChilds_1 = currentLevelChilds; _b < currentLevelChilds_1.length; _b++) {\n          var currentLevelChild = currentLevelChilds_1[_b];\n\n          if (resTreeGroup[i + 1]) {\n            var nextLevelChilds = resTreeGroup[i + 1][temp];\n            var colSpan = 0;\n\n            for (var _c = 0, nextLevelChilds_1 = nextLevelChilds; _c < nextLevelChilds_1.length; _c++) {\n              var nextLevelChild = nextLevelChilds_1[_c];\n\n              if (!this.parent.activeViewOptions.group.byGroupID || this.parent.activeViewOptions.group.byGroupID && nextLevelChild.resourceData[nextLevelChild.resource.groupIDField] === currentLevelChild.resourceData[currentLevelChild.resource.idField]) {\n                colSpan += nextLevelChild.colSpan;\n              }\n            }\n\n            currentLevelChild.colSpan = colSpan;\n          }\n\n          currentLevelChild.groupIndex = temp;\n          temp++;\n          headerLevels[currentLevelChild.resourceLevelIndex] = headerLevels[currentLevelChild.resourceLevelIndex] || [];\n          headerLevels[currentLevelChild.resourceLevelIndex].push(currentLevelChild);\n        }\n      }\n    }\n\n    this.lastResourceLevel = headerLevels.slice(-1)[0] || [];\n\n    if (!this.parent.activeViewOptions.group.byDate) {\n      var index = 0;\n\n      for (var _d = 0, _e = this.lastResourceLevel; _d < _e.length; _d++) {\n        var lastLevelResource = _e[_d];\n\n        for (var i = 0; i < lastLevelResource.colSpan; i++) {\n          lastColumnDates[index].groupIndex = lastLevelResource.groupIndex;\n          index++;\n        }\n      }\n\n      headerLevels.push(lastColumnDates);\n      return headerLevels;\n    }\n\n    var dateHeaderLevels = [];\n    var levels = extend([], headerLevels, null, true);\n    var dateColSpan = 0;\n\n    for (var _f = 0, _g = levels[0]; _f < _g.length; _f++) {\n      var firstRowTd = _g[_f];\n      dateColSpan += firstRowTd.colSpan;\n    }\n\n    var datesColumn = [];\n\n    for (var _h = 0, headerDates_1 = headerDates; _h < headerDates_1.length; _h++) {\n      var headerDate = headerDates_1[_h];\n      headerDate.colSpan = dateColSpan;\n      datesColumn.push(headerDate);\n      var resGroup = extend([], levels, null, true);\n\n      for (var k = 0, length_2 = resGroup.length; k < length_2; k++) {\n        if (k === resGroup.length - 1) {\n          for (var _j = 0, _k = resGroup[k]; _j < _k.length; _j++) {\n            var resTd = _k[_j];\n            resTd.date = headerDate.date;\n            resTd.workDays = headerDate.workDays;\n            resTd.startHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.startHourField]) || headerDate.startHour;\n            resTd.endHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.endHourField]) || headerDate.endHour;\n          }\n        }\n\n        if (!dateHeaderLevels[k]) {\n          dateHeaderLevels[k] = [];\n        }\n\n        dateHeaderLevels[k] = dateHeaderLevels[k].concat(resGroup[k]);\n      }\n    }\n\n    dateHeaderLevels.unshift(datesColumn);\n    return dateHeaderLevels;\n  };\n\n  ResourceBase.prototype.setResourceValues = function (eventObj, isCrud, groupIndex) {\n    var _this = this;\n\n    var setValues = function (index, field, value) {\n      if (_this.resourceCollection[index].allowMultiple && (!isCrud || isCrud && _this.parent.activeViewOptions.group.allowGroupEdit)) {\n        eventObj[field] = [value];\n      } else {\n        eventObj[field] = value;\n      }\n    };\n\n    if (groupIndex === void 0) {\n      groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : this.parent.activeCellsData.groupIndex;\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !isNullOrUndefined(groupIndex)) {\n      var groupOrder = this.lastResourceLevel[groupIndex].groupOrder;\n\n      for (var index = 0; index < this.resourceCollection.length; index++) {\n        setValues(index, this.resourceCollection[index].field, groupOrder[index]);\n      }\n    } else if (this.parent.resourceCollection.length > 0) {\n      for (var index = 0; index < this.resourceCollection.length; index++) {\n        var data = this.resourceCollection[index].dataSource[0];\n\n        if (data) {\n          setValues(index, this.resourceCollection[index].field, data[this.resourceCollection[index].idField]);\n        }\n      }\n    }\n  };\n\n  ResourceBase.prototype.getResourceColor = function (eventObj, groupOrder) {\n    var colorFieldIndex = !isNullOrUndefined(groupOrder) && this.colorIndex > groupOrder.length - 1 ? groupOrder.length - 1 : this.colorIndex;\n    var resource = this.resourceCollection[colorFieldIndex];\n\n    if (isNullOrUndefined(groupOrder) && this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n      return undefined;\n    }\n\n    var id = isNullOrUndefined(groupOrder) ? eventObj[resource.field] : groupOrder[colorFieldIndex];\n    var data = this.filterData(resource.dataSource, resource.idField, 'equal', id);\n\n    if (data.length > 0) {\n      return data[0][resource.colorField];\n    }\n\n    return undefined;\n  };\n\n  ResourceBase.prototype.getCssClass = function (eventObj) {\n    var resource = this.resourceCollection.slice(-1)[0];\n\n    if (this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n      return undefined;\n    }\n\n    var data = this.filterData(resource.dataSource, resource.idField, 'equal', eventObj[resource.field]);\n\n    if (data.length > 0) {\n      return data[0][resource.cssClassField];\n    }\n\n    return undefined;\n  };\n\n  ResourceBase.prototype.filterData = function (dataSource, field, operator, value) {\n    return new DataManager(dataSource).executeLocal(new Query().where(field, operator, value));\n  };\n\n  ResourceBase.prototype.dataManagerFailure = function (e) {\n    var _this = this;\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.trigger(events.actionFailure, {\n      error: e\n    }, function () {\n      return _this.parent.hideSpinner();\n    });\n  };\n\n  ResourceBase.prototype.getResourceData = function (eventObj, index, groupEditIndex) {\n    if (this.parent.activeViewOptions.group.allowGroupEdit) {\n      var resourceObj = {};\n\n      for (var _i = 0, groupEditIndex_1 = groupEditIndex; _i < groupEditIndex_1.length; _i++) {\n        var groupIndex = groupEditIndex_1[_i];\n        var resourceLevel = this.lastResourceLevel[groupIndex].groupOrder;\n\n        for (var level = 0, length_3 = resourceLevel.length; level < length_3; level++) {\n          var fieldName = this.resourceCollection[level].field;\n\n          if (isNullOrUndefined(resourceObj[fieldName])) {\n            resourceObj[fieldName] = [];\n          }\n\n          resourceObj[fieldName].push(resourceLevel[level]);\n        }\n      }\n\n      eventObj = extend(eventObj, resourceObj);\n    } else {\n      for (var level = 0, length_4 = this.resourceCollection.length; level < length_4; level++) {\n        eventObj[this.resourceCollection[level].field] = this.lastResourceLevel[index].groupOrder[level];\n      }\n    }\n  };\n\n  ResourceBase.prototype.addResource = function (resources, name, index) {\n    var resourceCollection = resources instanceof Array ? resources : [resources];\n\n    var _loop_1 = function (resource) {\n      if (resource.name === name) {\n        resourceCollection.forEach(function (addObj, i) {\n          return new DataManager({\n            json: resource.dataSource\n          }).insert(addObj, null, null, index + i);\n        });\n        return \"break\";\n      }\n    };\n\n    for (var _i = 0, _a = this.parent.resourceCollection; _i < _a.length; _i++) {\n      var resource = _a[_i];\n\n      var state_1 = _loop_1(resource);\n\n      if (state_1 === \"break\") break;\n    }\n\n    this.refreshLayout(true);\n  };\n\n  ResourceBase.prototype.removeResource = function (resourceId, name) {\n    var resourceCollection = resourceId instanceof Array ? resourceId : [resourceId];\n\n    var _loop_2 = function (resource) {\n      if (resource.name === name) {\n        resourceCollection.forEach(function (removeObj) {\n          return new DataManager({\n            json: resource.dataSource\n          }).remove(resource.idField, removeObj);\n        });\n        return \"break\";\n      }\n    };\n\n    for (var _i = 0, _a = this.parent.resourceCollection; _i < _a.length; _i++) {\n      var resource = _a[_i];\n\n      var state_2 = _loop_2(resource);\n\n      if (state_2 === \"break\") break;\n    }\n\n    this.refreshLayout(true);\n  };\n\n  ResourceBase.prototype.getIndexFromResourceId = function (id, name) {\n    var indexs;\n\n    if (this.parent.resourceCollection[this.parent.resourceCollection.length - 1].name === name) {\n      indexs = id - 1;\n    } else {\n      var counts = 1;\n\n      for (var i = this.parent.resourceCollection.length - 1; i >= 0; i--) {\n        if (this.parent.resourceCollection[i].name === name) {\n          indexs = (id - 1) * counts;\n          break;\n        } else {\n          counts = counts * this.parent.resourceCollection[i].dataSource.length;\n        }\n      }\n    }\n\n    return indexs;\n  };\n\n  ResourceBase.prototype.resourceScroll = function (id, name) {\n    if (this.parent.isAdaptive || ['Agenda', 'MonthAgenda'].indexOf(this.parent.currentView) > -1) {\n      return;\n    }\n\n    var levelName = name || this.parent.resourceCollection.slice(-1)[0].name;\n    var levelIndex = this.parent.resourceCollection.length - 1;\n    var resource = this.parent.resourceCollection.filter(function (e, index) {\n      if (e.name === levelName) {\n        levelIndex = index;\n        return e;\n      }\n\n      return null;\n    })[0];\n    var scrollElement = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var index = 0;\n\n    if (this.parent.activeView.isTimelineView()) {\n      if (!this.parent.activeViewOptions.group.byGroupID) {\n        index = this.getIndexFromResourceId(id, levelName);\n      } else {\n        var resourceData = resource.dataSource.filter(function (e) {\n          return e[resource.idField] === id;\n        })[0];\n        index = this.lastResourceLevel.map(function (e) {\n          return e.resourceData;\n        }).indexOf(resourceData);\n      }\n\n      if (this.parent.virtualScrollModule) {\n        var virtual = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n        var averageRowHeight = Math.round(virtual.offsetHeight / this.expandedResources.length);\n\n        if (this.renderedResources[0].resourceData[this.renderedResources[0].resource.idField] > index) {\n          scrollElement.scrollTop = index * averageRowHeight + (this.parent.virtualScrollModule.bufferCount - 1) * averageRowHeight;\n        } else {\n          scrollElement.scrollTop = index * averageRowHeight;\n        }\n      } else {\n        var td = this.parent.element.querySelector(\".\" + cls.WORK_CELLS_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\");\n\n        if (td && !td.parentElement.classList.contains(cls.HIDDEN_CLASS)) {\n          scrollElement.scrollTop = td.offsetTop;\n        }\n      }\n    } else {\n      if (!this.parent.activeViewOptions.group.byGroupID) {\n        index = this.getIndexFromResourceId(id, levelName);\n      } else {\n        index = resource.dataSource.map(function (e) {\n          return e[resource.idField];\n        }).indexOf(id);\n      }\n\n      var offsetTarget = this.parent.element.querySelector(\".\" + cls.HEADER_ROW_CLASS + \":nth-child(\" + (levelIndex + 1) + \")\");\n      var offset = [].slice.call(offsetTarget.children).map(function (node) {\n        return node.offsetLeft;\n      });\n      scrollElement.scrollLeft = offset[index];\n    }\n  };\n\n  ResourceBase.prototype.destroy = function () {\n    this.parent.off(events.documentClick, this.documentClick);\n\n    if (this.treeViewObj) {\n      this.treeViewObj.destroy();\n      this.treeViewObj = null;\n    }\n\n    if (this.treePopup) {\n      this.treePopup.destroy();\n      this.treePopup = null;\n      remove(this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP));\n      remove(this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP_OVERLAY));\n    }\n\n    var resToolBarEle = this.parent.element.querySelector('.' + cls.RESOURCE_TOOLBAR_CONTAINER);\n\n    if (resToolBarEle) {\n      remove(resToolBarEle);\n    }\n  };\n\n  return ResourceBase;\n}();\n\nexport { ResourceBase };","map":{"version":3,"sources":["/Users/jay/node_modules/@syncfusion/ej2-schedule/src/schedule/base/resource.js"],"names":["extend","isNullOrUndefined","createElement","EventHandler","addClass","append","removeClass","remove","closest","classList","isBlazor","DataManager","Query","TreeView","Popup","Data","cls","events","util","ResourceBase","parent","resourceCollection","leftPixel","prototype","renderResourceHeaderIndent","tr","resColTd","className","RESOURCE_LEFT_TD_CLASS","resColDiv","RESOURCE_TEXT_CLASS","appendChild","args","elementType","element","trigger","renderCell","hideResourceRows","tBody","length","virtualScrollModule","trCount","lastResourceLevel","i","resData","resourceData","res","resource","ClassName","RESOURCE_PARENT_CLASS","expandedField","trCollection","slice","call","children","slicedCollection","parseInt","Count","HIDDEN_CLASS","createResourceColumn","resColl","resDiv","RESOURCE_COLUMN_WRAP_CLASS","tbl","activeView","createTableLayout","RESOURCE_COLUMN_TABLE_CLASS","uiStateValues","isGroupAdaptive","rowAutoHeight","isTimelineView","activeViewOptions","group","resources","AUTO_HEIGHT","eventSettings","ignoreWhitespace","IGNORE_WHITESPACE","querySelector","generateTreeData","countCalculation","renderedResources","resourceCount","getRenderedCount","setExpandedResources","expandedResources","getContentRows","setRenderedResources","count","push","isExpanded","resRows","left","rIndex","td","ntd","cloneNode","findIndexInData","name","RESOURCE_CHILD_CLASS","iconClass","RESOURCE_COLLAPSE_CLASS","RESOURCE_EXPAND_CLASS","iconDiv","RESOURCE_TREE_ICON_CLASS","setMargin","add","onTreeIconClick","setResourceHeaderContent","setAttribute","groupIndex","toString","resourceHeaderTemplate","classCollection","RESOURCE_CELLS_CLASS","ntr","value","enableRtl","style","marginLeft","marginRight","parentCollection","wholeCollection","collection","y","data","dataSource","x","totalCount","byGroupID","executeLocal","where","groupIDField","idField","z","e","_this","eventTooltip","close","target","hide","trElement","parentElement","index","getAttribute","cancel","event","requestType","contains","actionBegin","actionArgs","eventElements","querySelectorAll","APPOINTMENT_CLASS","forEach","node","updateVirtualContent","updateContent","cssProperties","getCssProperties","module","notify","scrollUiUpdate","dataReady","actionComplete","rowCollection","workCellCollection","headerRowCollection","pNode","clickedRes","contentRows","CONTENT_WRAP_CLASS","eventRows","APPOINTMENT_CONTAINER_CLASS","j","clonedCollection","expanded","trElem","rowIndex","splice","expand","startIndex","indexOf","sIndex","virtualTrack","VIRTUAL_TRACK_CLASS","updateVirtualTrackHeight","resTable","contentTable","eventTable","EVENT_TABLE_CLASS","timeIndicator","CURRENT_TIMELINE_CLASS","height","CONTENT_TABLE_CLASS","offsetHeight","renderResourceHeader","resourceWrapper","RESOURCE_TOOLBAR_CONTAINER","innerHTML","RESOURCE_HEADER_TOOLBAR","RESOURCE_MENU","RESOURCE_MENU_ICON","RESOURCE_LEVEL_TITLE","currentView","getPanel","insertBefore","WRAPPER_CONTAINER_CLASS","TABLE_CONTAINER_CLASS","renderResourceHeaderText","menuClick","renderResourceTree","popupOverlay","RESOURCE_TREE_POPUP_OVERLAY","treeWrapper","RESOURCE_TREE_POPUP","resourceTree","RESOURCE_TREE","treeViewObj","cssClass","fields","id","text","child","nodeTemplate","nodeClicked","resourceClick","bind","appendTo","expandAll","treePopup","targetType","actionOnScroll","content","hideAnimation","duration","showAnimation","viewPortElement","on","documentClick","isTimeLine","treeCollection","resTreeColl","resourceTreeLevel","resTree","treeHandler","treeLevel","levelId","treeArgs","resObj","resourceId","resourceName","textField","type","groupOrder","resourceChild","_i","_a","tree","headerCollection","level","resourceLevel","resourceText","filter","RESOURCE_NAME","levelIcon","pop","headerWrapper","removeChildren","DISABLE_CLASS","POPUP_OPEN","ENABLE_CLASS","treeNodes","show","isServerRenderer","interopAdaptor","invokeMethodAsync","then","isDestroyed","serverRenderLayout","processed","eventBase","processData","eventsData","processedData","catch","dataManagerFailure","renderModule","render","preventDefault","bindResourcesData","isSetModel","showSpinner","promises","dataModule","query","getData","generateQuery","Promise","all","dataManagerSuccess","length_1","resourceObj","getResourceModel","result","refreshLayout","field","title","allowMultiple","colorField","startHourField","endHourField","workDaysField","cssClassField","renderElements","setResourceCollection","requiredResources","colorIndex","index_1","_b","requiredResources_1","resourceColorField","generateResourceLevels","innerDates","resTreeGroup","lastColumnDates","prevResource","prevResourceData","prevOrder","concat","items","dateCol","renderDates","resWorkDays","byDate","workDays","resStartHour","resEndHour","getRenderDates","getDateSlots","dateSlots","generateCustomHours","resCssClass","slotData","resourceLevelIndex","colSpan","generateHeaderLevels","startHour","endHour","dateSlots_1","dateSlot","getStartEndTime","headerDates","headerLevels","temp","currentLevelChilds","currentLevelChilds_1","currentLevelChild","nextLevelChilds","_c","nextLevelChilds_1","nextLevelChild","_d","_e","lastLevelResource","dateHeaderLevels","levels","dateColSpan","_f","_g","firstRowTd","datesColumn","_h","headerDates_1","headerDate","resGroup","k","length_2","_j","_k","resTd","date","unshift","setResourceValues","eventObj","isCrud","setValues","allowGroupEdit","activeCellsData","getResourceColor","colorFieldIndex","undefined","filterData","getCssClass","operator","actionFailure","error","hideSpinner","getResourceData","groupEditIndex","groupEditIndex_1","length_3","fieldName","length_4","addResource","Array","_loop_1","addObj","json","insert","state_1","removeResource","_loop_2","removeObj","state_2","getIndexFromResourceId","indexs","counts","resourceScroll","isAdaptive","levelName","levelIndex","scrollElement","map","virtual","averageRowHeight","Math","round","scrollTop","bufferCount","WORK_CELLS_CLASS","offsetTop","offsetTarget","HEADER_ROW_CLASS","offset","offsetLeft","scrollLeft","destroy","off","resToolBarEle"],"mappings":"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","sourcesContent":["import { extend, isNullOrUndefined, createElement, EventHandler, addClass, append, removeClass, remove, closest, classList, isBlazor } from '@syncfusion/ej2-base';\nimport { DataManager, Query } from '@syncfusion/ej2-data';\nimport { TreeView } from '@syncfusion/ej2-navigations';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { Data } from '../actions/data';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar ResourceBase = /** @class */ (function () {\n    function ResourceBase(parent) {\n        this.resourceCollection = [];\n        this.leftPixel = 25;\n        this.parent = parent;\n    }\n    ResourceBase.prototype.renderResourceHeaderIndent = function (tr) {\n        var resColTd = createElement('td', { className: cls.RESOURCE_LEFT_TD_CLASS });\n        var resColDiv = createElement('div', { className: cls.RESOURCE_TEXT_CLASS });\n        resColTd.appendChild(resColDiv);\n        var args = { elementType: 'emptyCells', element: resColTd };\n        this.parent.trigger(events.renderCell, args);\n        tr.appendChild(resColTd);\n    };\n    ResourceBase.prototype.hideResourceRows = function (tBody) {\n        if (this.resourceCollection.length <= 1 || this.parent.virtualScrollModule) {\n            return;\n        }\n        var trCount = this.lastResourceLevel.length;\n        for (var i = 0; i < trCount; i++) {\n            var resData = this.lastResourceLevel[i].resourceData;\n            var res = this.lastResourceLevel[i].resource;\n            if (resData.ClassName === cls.RESOURCE_PARENT_CLASS && !resData[res.expandedField] &&\n                !isNullOrUndefined(resData[res.expandedField])) {\n                var trCollection = [].slice.call(tBody.children);\n                var slicedCollection = trCollection.slice(i + 1, i + (parseInt(resData.Count, 0) + 1));\n                addClass(slicedCollection, cls.HIDDEN_CLASS);\n            }\n        }\n    };\n    ResourceBase.prototype.createResourceColumn = function () {\n        var resColl = this.resourceCollection;\n        var resDiv = createElement('div', { className: cls.RESOURCE_COLUMN_WRAP_CLASS });\n        var tbl = this.parent.activeView.createTableLayout(cls.RESOURCE_COLUMN_TABLE_CLASS);\n        if (!this.parent.uiStateValues.isGroupAdaptive && this.parent.rowAutoHeight && this.parent.activeView.isTimelineView()\n            && this.parent.activeViewOptions.group.resources.length > 0) {\n            addClass([tbl], cls.AUTO_HEIGHT);\n        }\n        if (this.parent.eventSettings.ignoreWhitespace) {\n            addClass([tbl], cls.IGNORE_WHITESPACE);\n        }\n        var tBody = tbl.querySelector('tbody');\n        var resData = this.generateTreeData(true);\n        this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n        this.renderedResources = this.lastResourceLevel;\n        if (this.parent.virtualScrollModule) {\n            var resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n            this.setExpandedResources();\n            resData = this.expandedResources.slice(0, resourceCount);\n            this.renderedResources = resData;\n        }\n        append(this.getContentRows(resData), tBody);\n        this.hideResourceRows(tBody);\n        tbl.appendChild(tBody);\n        resDiv.appendChild(tbl);\n        return resDiv;\n    };\n    ResourceBase.prototype.setRenderedResources = function () {\n        var resColl = this.resourceCollection;\n        this.generateTreeData(true);\n        this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n        this.renderedResources = this.lastResourceLevel;\n    };\n    ResourceBase.prototype.setExpandedResources = function () {\n        var resources = [];\n        for (var i = 0; i < this.lastResourceLevel.length; i++) {\n            var resource = this.lastResourceLevel[i].resourceData;\n            var count = resource.Count;\n            resources.push(this.lastResourceLevel[i]);\n            var isExpanded = resource[this.lastResourceLevel[i].resource.expandedField];\n            if (!isNullOrUndefined(isExpanded) && !isExpanded && count > 0) {\n                i = i + count;\n            }\n        }\n        this.expandedResources = resources;\n    };\n    ResourceBase.prototype.getContentRows = function (resData) {\n        var resRows = [];\n        var left;\n        var rIndex;\n        var resColl = this.resourceCollection;\n        var tr = createElement('tr');\n        var td = createElement('td');\n        for (var i = 0; i < resData.length; i++) {\n            var ntd = td.cloneNode();\n            rIndex = util.findIndexInData(resColl, 'name', resData[i].resource.name);\n            if (rIndex === resColl.length - 1) {\n                extend(resData[i].resourceData, { ClassName: cls.RESOURCE_CHILD_CLASS });\n                this.renderedResources[i].className = [cls.RESOURCE_CHILD_CLASS];\n            }\n            else {\n                extend(resData[i].resourceData, { ClassName: cls.RESOURCE_PARENT_CLASS });\n                this.renderedResources[i].className = [cls.RESOURCE_PARENT_CLASS];\n            }\n            left = (rIndex * this.leftPixel) + 'px';\n            if (resData[i].resourceData.ClassName === cls.RESOURCE_PARENT_CLASS\n                && !isNullOrUndefined(resData[i].resourceData.Count) && (resData[i].resourceData.Count > 0)) {\n                var iconClass = void 0;\n                if (resData[i].resourceData[resColl[rIndex].expandedField] ||\n                    isNullOrUndefined(resData[i].resourceData[resColl[rIndex].expandedField])) {\n                    iconClass = cls.RESOURCE_COLLAPSE_CLASS;\n                }\n                else {\n                    iconClass = cls.RESOURCE_EXPAND_CLASS;\n                }\n                var iconDiv = createElement('div');\n                addClass([iconDiv], [cls.RESOURCE_TREE_ICON_CLASS, iconClass]);\n                this.setMargin(iconDiv, left);\n                ntd.appendChild(iconDiv);\n                if (this.resourceCollection.length > 1) {\n                    EventHandler.add(iconDiv, 'click', this.onTreeIconClick, this);\n                }\n            }\n            this.parent.activeView.setResourceHeaderContent(ntd, resData[i], cls.RESOURCE_TEXT_CLASS);\n            ntd.setAttribute('data-group-index', resData[i].groupIndex.toString());\n            if (!this.parent.activeViewOptions.resourceHeaderTemplate) {\n                this.setMargin(ntd.querySelector('.' + cls.RESOURCE_TEXT_CLASS), left);\n            }\n            var classCollection = [cls.RESOURCE_CELLS_CLASS, resData[i].resourceData.ClassName];\n            addClass([ntd], classCollection);\n            var args = { elementType: 'resourceHeader', element: ntd, groupIndex: resData[i].groupIndex };\n            this.parent.trigger(events.renderCell, args);\n            var ntr = tr.cloneNode();\n            ntr.appendChild(ntd);\n            resRows.push(ntr);\n        }\n        return resRows;\n    };\n    ResourceBase.prototype.setMargin = function (element, value) {\n        if (!this.parent.enableRtl) {\n            element.style.marginLeft = value;\n        }\n        else {\n            element.style.marginRight = value;\n        }\n    };\n    ResourceBase.prototype.countCalculation = function (parentCollection, wholeCollection) {\n        var collection;\n        for (var y = 0; y < parentCollection.length; y++) {\n            var data = parentCollection[parentCollection.length - (y + 1)]\n                .dataSource;\n            for (var x = 0; x < data.length; x++) {\n                var totalCount = 0;\n                if (this.parent.activeViewOptions.group.byGroupID) {\n                    collection = new DataManager(wholeCollection[wholeCollection.length - 1].dataSource)\n                        .executeLocal(new Query().where(wholeCollection[wholeCollection.length - 1].groupIDField, 'equal', data[x][parentCollection[parentCollection.length - (y + 1)].idField]));\n                }\n                else {\n                    collection = wholeCollection[wholeCollection.length - 1].dataSource;\n                }\n                for (var z = 0; z < collection.length; z++) {\n                    totalCount = totalCount + parseInt(collection[z].Count, 0);\n                }\n                totalCount = totalCount + parseInt(data[x].Count, 0);\n                extend(data[x], { Count: totalCount });\n            }\n            wholeCollection = wholeCollection.slice(0, -1);\n        }\n    };\n    ResourceBase.prototype.onTreeIconClick = function (e) {\n        var _this = this;\n        if (this.parent.eventTooltip) {\n            this.parent.eventTooltip.close();\n        }\n        var target = e.target;\n        var hide;\n        var trElement = closest(target, '.' + cls.RESOURCE_PARENT_CLASS)\n            .parentElement;\n        var index = parseInt(trElement.children[0].getAttribute('data-group-index'), 10);\n        var args = {\n            cancel: false, event: e, groupIndex: index,\n            requestType: !target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS) ? 'resourceExpand' : 'resourceCollapse',\n        };\n        this.parent.trigger(events.actionBegin, args, function (actionArgs) {\n            if (!actionArgs.cancel) {\n                if (target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS)) {\n                    classList(target, [cls.RESOURCE_EXPAND_CLASS], [cls.RESOURCE_COLLAPSE_CLASS]);\n                    hide = true;\n                }\n                else {\n                    classList(target, [cls.RESOURCE_COLLAPSE_CLASS], [cls.RESOURCE_EXPAND_CLASS]);\n                    hide = false;\n                }\n                var eventElements = [].slice.call(_this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n                eventElements.forEach(function (node) { return remove(node); });\n                if (_this.parent.virtualScrollModule) {\n                    _this.updateVirtualContent(index, hide);\n                }\n                else {\n                    _this.updateContent(index, hide);\n                }\n                var data = { cssProperties: _this.parent.getCssProperties(), module: 'scroll' };\n                _this.parent.notify(events.scrollUiUpdate, data);\n                args = {\n                    cancel: false, event: e, groupIndex: index,\n                    requestType: target.classList.contains(cls.RESOURCE_COLLAPSE_CLASS) ? 'resourceExpanded' : 'resourceCollapsed',\n                };\n                _this.parent.notify(events.dataReady, {});\n                _this.parent.trigger(events.actionComplete, args);\n            }\n        });\n    };\n    ResourceBase.prototype.updateContent = function (index, hide) {\n        var rowCollection = [];\n        var workCellCollection = [];\n        var headerRowCollection = [];\n        var pNode;\n        var clickedRes = this.lastResourceLevel[index].resourceData;\n        var resRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'tr'));\n        var contentRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_WRAP_CLASS + ' ' + 'tbody tr'));\n        var eventRows = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CONTENT_WRAP_CLASS + ' .' + cls.APPOINTMENT_CONTAINER_CLASS));\n        for (var j = 0; j < clickedRes.Count; j++) {\n            rowCollection.push(resRows[index + j + 1]);\n            workCellCollection.push(contentRows[index + j + 1]);\n            headerRowCollection.push(eventRows[index + j + 1]);\n        }\n        var clonedCollection = this.lastResourceLevel;\n        for (var i = 0; i < rowCollection.length; i++) {\n            var expanded = true;\n            pNode = rowCollection[i].children[0].classList.contains(cls.RESOURCE_PARENT_CLASS);\n            clonedCollection[index].resourceData[clonedCollection[index].resource.expandedField] = !hide;\n            if (hide) {\n                if (pNode) {\n                    var trElem = rowCollection[i].querySelector('.' + cls.RESOURCE_TREE_ICON_CLASS);\n                    if (trElem) {\n                        classList(trElem, [cls.RESOURCE_EXPAND_CLASS], [cls.RESOURCE_COLLAPSE_CLASS]);\n                    }\n                }\n                if (!rowCollection[i].classList.contains(cls.HIDDEN_CLASS)) {\n                    addClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], cls.HIDDEN_CLASS);\n                }\n            }\n            else {\n                if (pNode) {\n                    var rowIndex = rowCollection[i].rowIndex;\n                    if (!clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField]\n                        && !isNullOrUndefined(clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField])) {\n                        rowCollection.splice(i + 1, (parseInt(clonedCollection[rowIndex].resourceData.Count, 0)));\n                        workCellCollection.splice(i + 1, (parseInt(clonedCollection[rowIndex].resourceData.Count, 0)));\n                        headerRowCollection.splice(i + 1, (parseInt(clonedCollection[rowIndex].resourceData.Count, 0)));\n                        expanded = false;\n                    }\n                    if (expanded) {\n                        var trElem = rowCollection[i].querySelector('.' + cls.RESOURCE_TREE_ICON_CLASS);\n                        if (trElem) {\n                            classList(trElem, [cls.RESOURCE_COLLAPSE_CLASS], [cls.RESOURCE_EXPAND_CLASS]);\n                        }\n                    }\n                }\n                if (rowCollection[i].classList.contains(cls.HIDDEN_CLASS)) {\n                    removeClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], cls.HIDDEN_CLASS);\n                }\n            }\n        }\n    };\n    ResourceBase.prototype.updateVirtualContent = function (index, expand) {\n        this.lastResourceLevel[index].resourceData[this.lastResourceLevel[index].resource.expandedField] = !expand;\n        this.setExpandedResources();\n        var resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n        var startIndex = this.expandedResources.indexOf(this.renderedResources[0]);\n        this.renderedResources = this.expandedResources.slice(startIndex, startIndex + resourceCount);\n        if (this.renderedResources.length < resourceCount) {\n            var sIndex = this.expandedResources.length - resourceCount;\n            sIndex = (sIndex > 0) ? sIndex : 0;\n            this.renderedResources = this.expandedResources.slice(sIndex, this.expandedResources.length);\n        }\n        var virtualTrack = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n        this.parent.virtualScrollModule.updateVirtualTrackHeight(virtualTrack);\n        var resTable = this.parent.element.querySelector('.' + cls.RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'table');\n        var contentTable = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS + ' ' + 'table');\n        var eventTable = this.parent.element.querySelector('.' + cls.EVENT_TABLE_CLASS);\n        this.parent.virtualScrollModule.updateContent(resTable, contentTable, eventTable, this.renderedResources);\n        var timeIndicator = this.parent.element.querySelector('.' + cls.CURRENT_TIMELINE_CLASS);\n        if (!isNullOrUndefined(timeIndicator)) {\n            timeIndicator.style.height =\n                this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS).offsetHeight + 'px';\n        }\n    };\n    ResourceBase.prototype.renderResourceHeader = function () {\n        var resourceWrapper = createElement('div', { className: cls.RESOURCE_TOOLBAR_CONTAINER });\n        resourceWrapper.innerHTML = '<div class=\"' + cls.RESOURCE_HEADER_TOOLBAR + '\"><div class=\"' + cls.RESOURCE_MENU + '\">' +\n            '<div class=\"e-icons ' + cls.RESOURCE_MENU_ICON + '\"></div></div><div class=\"' + cls.RESOURCE_LEVEL_TITLE + '\"></div></div>';\n        if (this.parent.currentView === 'MonthAgenda') {\n            var target = this.parent.activeView.getPanel().querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            target.insertBefore(resourceWrapper, target.querySelector('.' + cls.WRAPPER_CONTAINER_CLASS));\n        }\n        else {\n            this.parent.element.insertBefore(resourceWrapper, this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS));\n        }\n        this.renderResourceHeaderText();\n        EventHandler.add(resourceWrapper.querySelector('.' + cls.RESOURCE_MENU_ICON), 'click', this.menuClick, this);\n    };\n    ResourceBase.prototype.renderResourceTree = function () {\n        this.popupOverlay = createElement('div', { className: cls.RESOURCE_TREE_POPUP_OVERLAY });\n        var treeWrapper = createElement('div', { className: cls.RESOURCE_TREE_POPUP + ' e-popup-close' });\n        if (this.parent.currentView === 'MonthAgenda') {\n            var target = this.parent.activeView.getPanel().querySelector('.' + cls.WRAPPER_CONTAINER_CLASS);\n            target.insertBefore(treeWrapper, target.children[0]);\n            target.appendChild(this.popupOverlay);\n        }\n        else {\n            this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS).appendChild(treeWrapper);\n            this.parent.element.querySelector('.' + cls.TABLE_CONTAINER_CLASS).appendChild(this.popupOverlay);\n        }\n        var resourceTree = createElement('div', { className: cls.RESOURCE_TREE });\n        treeWrapper.appendChild(resourceTree);\n        this.treeViewObj = new TreeView({\n            cssClass: this.parent.cssClass,\n            enableRtl: this.parent.enableRtl,\n            fields: {\n                dataSource: [].slice.call(this.generateTreeData()),\n                id: 'resourceId',\n                text: 'resourceName',\n                child: 'resourceChild'\n            },\n            nodeTemplate: this.parent.resourceHeaderTemplate,\n            nodeClicked: this.resourceClick.bind(this)\n        });\n        this.treeViewObj.appendTo(resourceTree);\n        this.treeViewObj.expandAll();\n        this.treePopup = new Popup(treeWrapper, {\n            targetType: 'relative',\n            actionOnScroll: 'none',\n            content: this.treeViewObj.element,\n            enableRtl: this.parent.enableRtl,\n            hideAnimation: { name: 'SlideLeftOut', duration: 500 },\n            showAnimation: { name: 'SlideLeftIn', duration: 500 },\n            viewPortElement: this.parent.element.querySelector('.' + (this.parent.currentView === 'MonthAgenda' ?\n                cls.WRAPPER_CONTAINER_CLASS : cls.TABLE_CONTAINER_CLASS))\n        });\n        this.parent.on(events.documentClick, this.documentClick, this);\n    };\n    ResourceBase.prototype.generateTreeData = function (isTimeLine) {\n        var _this = this;\n        var treeCollection = [];\n        var resTreeColl = [];\n        var groupIndex = 0;\n        this.resourceTreeLevel.forEach(function (resTree, index) {\n            var treeHandler = function (treeLevel, index, levelId) {\n                var resource = _this.resourceCollection[index];\n                var treeArgs;\n                var resObj;\n                if (!isTimeLine) {\n                    treeArgs = {\n                        resourceId: levelId,\n                        resourceName: treeLevel.resourceData[resource.textField],\n                        resource: treeLevel.resource,\n                        resourceData: treeLevel.resourceData\n                    };\n                }\n                else {\n                    resObj = {\n                        type: 'resourceHeader', resource: treeLevel.resource,\n                        resourceData: treeLevel.resourceData, groupIndex: groupIndex,\n                        groupOrder: treeLevel.groupOrder\n                    };\n                    resTreeColl.push(resObj);\n                    groupIndex++;\n                }\n                if (treeLevel.child.length > 0 && !isTimeLine) {\n                    treeArgs.resourceChild = [];\n                }\n                var count = 1;\n                for (var _i = 0, _a = treeLevel.child; _i < _a.length; _i++) {\n                    var tree = _a[_i];\n                    if (!isTimeLine) {\n                        treeArgs.resourceChild.push(treeHandler(tree, index + 1, levelId + '-' + count));\n                    }\n                    else {\n                        treeHandler(tree, index + 1, levelId + '-' + count);\n                    }\n                    count += 1;\n                }\n                if (isTimeLine) {\n                    extend(resObj.resourceData, { Count: count - 1 });\n                }\n                return treeArgs;\n            };\n            if (!isTimeLine) {\n                treeCollection.push(treeHandler(resTree, 0, (index + 1).toString()));\n            }\n            else {\n                treeHandler(resTree, 0, (index + 1).toString());\n            }\n        });\n        if (isTimeLine) {\n            this.lastResourceLevel = resTreeColl;\n            return resTreeColl;\n        }\n        else {\n            return treeCollection;\n        }\n    };\n    ResourceBase.prototype.renderResourceHeaderText = function () {\n        var _this = this;\n        var resource = this.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n        var headerCollection = [];\n        resource.groupOrder.forEach(function (level, index) {\n            var resourceLevel = _this.resourceCollection[index];\n            var resourceText = resourceLevel.dataSource.filter(function (resData) {\n                return resData[resourceLevel.idField] === level;\n            });\n            var resourceName = createElement('div', {\n                className: cls.RESOURCE_NAME,\n                innerHTML: resourceText[0][resourceLevel.textField]\n            });\n            headerCollection.push(resourceName);\n            var levelIcon = createElement('div', { className: 'e-icons e-icon-next' });\n            headerCollection.push(levelIcon);\n        });\n        headerCollection.pop();\n        var target = (this.parent.currentView === 'MonthAgenda') ? this.parent.activeView.getPanel() : this.parent.element;\n        var headerWrapper = target.querySelector('.' + cls.RESOURCE_LEVEL_TITLE);\n        util.removeChildren(headerWrapper);\n        headerCollection.forEach(function (element) { return headerWrapper.appendChild(element); });\n        if (this.lastResourceLevel.length === 1) {\n            addClass([this.parent.element.querySelector('.' + cls.RESOURCE_MENU)], cls.DISABLE_CLASS);\n        }\n    };\n    ResourceBase.prototype.menuClick = function (event) {\n        if (this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP).classList.contains(cls.POPUP_OPEN)) {\n            this.treePopup.hide();\n            removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n        }\n        else {\n            var treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n            removeClass(treeNodes, 'e-active');\n            addClass([treeNodes[this.parent.uiStateValues.groupIndex]], 'e-active');\n            this.treePopup.show();\n            addClass([this.popupOverlay], cls.ENABLE_CLASS);\n        }\n    };\n    ResourceBase.prototype.resourceClick = function (event) {\n        var _this = this;\n        if (!event.node.classList.contains('e-has-child')) {\n            this.treePopup.hide();\n            removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n            var treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n            this.parent.uiStateValues.groupIndex = treeNodes.indexOf(event.node);\n            if (this.parent.isServerRenderer()) {\n                // tslint:disable-next-line:no-any\n                this.parent.interopAdaptor.invokeMethodAsync('OnResourceClick', this.parent.uiStateValues.groupIndex).then(function () {\n                    if (_this.parent.isDestroyed) {\n                        return;\n                    }\n                    _this.renderResourceHeaderText();\n                    _this.parent.activeView.serverRenderLayout();\n                    var processed = _this.parent.eventBase.processData(_this.parent.eventsData);\n                    _this.parent.notify(events.dataReady, { processedData: processed });\n                }).catch(function (e) { return _this.dataManagerFailure(e); });\n            }\n            else {\n                this.parent.renderModule.render(this.parent.currentView, false);\n                var processed = this.parent.eventBase.processData(this.parent.eventsData);\n                this.parent.notify(events.dataReady, { processedData: processed });\n            }\n        }\n        event.event.preventDefault();\n    };\n    ResourceBase.prototype.documentClick = function (args) {\n        if (closest(args.event.target, '.' + cls.RESOURCE_TREE_POPUP)) {\n            return;\n        }\n        var treeWrapper = this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP);\n        if (treeWrapper && treeWrapper.classList.contains(cls.POPUP_OPEN)) {\n            this.treePopup.hide();\n            removeClass([this.popupOverlay], cls.ENABLE_CLASS);\n        }\n    };\n    ResourceBase.prototype.bindResourcesData = function (isSetModel) {\n        var _this = this;\n        this.parent.showSpinner();\n        if (isBlazor()) {\n            // the resourceCollection will be updated in layoutReady method\n            // tslint:disable-next-line:no-any\n            // (this.parent as any).interopAdaptor.invokeMethodAsync('BindResourcesData').then((result: string) => {\n            //     if (this.parent.isDestroyed) { return; }\n            //     this.parent.resourceCollection = DataUtil.parse.parseJson(result);\n            //     this.refreshLayout(isSetModel);\n            // }).catch((e: ReturnType) => this.dataManagerFailure(e));\n            return;\n        }\n        var promises = [];\n        for (var i = 0; i < this.parent.resources.length; i++) {\n            var dataModule = new Data(this.parent.resources[i].dataSource, this.parent.resources[i].query);\n            promises.push(dataModule.getData(dataModule.generateQuery()));\n        }\n        Promise.all(promises).then(function (e) { return _this.dataManagerSuccess(e, isSetModel); })\n            .catch(function (e) { return _this.dataManagerFailure(e); });\n    };\n    ResourceBase.prototype.dataManagerSuccess = function (e, isSetModel) {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.resourceCollection = [];\n        for (var i = 0, length_1 = e.length; i < length_1; i++) {\n            var resource = this.parent.resources[i];\n            var resourceObj = this.getResourceModel(resource, e[i].result);\n            this.parent.resourceCollection.push(resourceObj);\n        }\n        this.refreshLayout(isSetModel);\n    };\n    ResourceBase.prototype.getResourceModel = function (resource, resourceData) {\n        var resourceObj = {\n            field: resource.field,\n            title: resource.title,\n            name: resource.name,\n            allowMultiple: resource.allowMultiple,\n            dataSource: resourceData || resource.dataSource,\n            idField: resource.idField,\n            textField: resource.textField,\n            groupIDField: resource.groupIDField,\n            colorField: resource.colorField,\n            startHourField: resource.startHourField,\n            endHourField: resource.endHourField,\n            workDaysField: resource.workDaysField,\n            expandedField: resource.expandedField,\n            cssClassField: resource.cssClassField\n        };\n        return resourceObj;\n    };\n    ResourceBase.prototype.refreshLayout = function (isSetModel) {\n        this.parent.uiStateValues.groupIndex = 0;\n        this.parent.renderElements(isSetModel);\n    };\n    ResourceBase.prototype.setResourceCollection = function () {\n        var requiredResources = [];\n        this.resourceCollection = [];\n        this.colorIndex = null;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            for (var _i = 0, _a = this.parent.activeViewOptions.group.resources; _i < _a.length; _i++) {\n                var resource = _a[_i];\n                var index_1 = util.findIndexInData(this.parent.resourceCollection, 'name', resource);\n                if (index_1 >= 0) {\n                    requiredResources.push(this.parent.resourceCollection[index_1]);\n                }\n            }\n        }\n        else if (this.parent.resourceCollection.length > 0) {\n            requiredResources = this.parent.resourceCollection;\n        }\n        var index = 0;\n        for (var _b = 0, requiredResources_1 = requiredResources; _b < requiredResources_1.length; _b++) {\n            var resource = requiredResources_1[_b];\n            var resources = this.getResourceModel(resource);\n            if (resource.name === this.parent.eventSettings.resourceColorField) {\n                this.colorIndex = index;\n            }\n            index++;\n            this.resourceCollection.push(resources);\n        }\n        if (isNullOrUndefined(this.colorIndex)) {\n            this.colorIndex = this.resourceCollection.length - 1;\n        }\n    };\n    ResourceBase.prototype.generateResourceLevels = function (innerDates, isTimeLine) {\n        var _this = this;\n        var resources = this.resourceCollection;\n        var resTreeGroup = [];\n        var lastColumnDates = [];\n        var group = function (resources, index, prevResource, prevResourceData, prevOrder) {\n            var resTree = [];\n            var resource = resources[0];\n            if (resource) {\n                var data = void 0;\n                if (prevResourceData && _this.parent.activeViewOptions.group.byGroupID) {\n                    var id = prevResourceData[prevResource.idField];\n                    data = new DataManager(resource.dataSource).executeLocal(new Query().where(resource.groupIDField, 'equal', id));\n                }\n                else {\n                    data = resource.dataSource;\n                }\n                for (var i = 0; i < data.length; i++) {\n                    var groupOrder = [];\n                    if (prevOrder && prevOrder.length > 0) {\n                        groupOrder = groupOrder.concat(prevOrder);\n                    }\n                    groupOrder.push(data[i][resource.idField]);\n                    var items = group(resources.slice(1), index + 1, resource, data[i], groupOrder);\n                    // Here validate child item empty top level resource only\n                    if (index === 0 && items.length === 0 && _this.resourceCollection.length > 1) {\n                        continue;\n                    }\n                    var dateCol = [];\n                    var renderDates = _this.parent.activeView.renderDates;\n                    var resWorkDays = void 0;\n                    if (!_this.parent.activeViewOptions.group.byDate && index + 1 === _this.resourceCollection.length) {\n                        var workDays = data[i][resource.workDaysField];\n                        var resStartHour = data[i][resource.startHourField];\n                        var resEndHour = data[i][resource.endHourField];\n                        if (workDays && workDays.length > 0) {\n                            renderDates = _this.parent.activeView.getRenderDates(workDays);\n                            resWorkDays = workDays;\n                            dateCol = _this.parent.activeView.getDateSlots(renderDates, workDays);\n                        }\n                        else {\n                            resWorkDays = _this.parent.activeViewOptions.workDays;\n                            dateCol = innerDates;\n                        }\n                        var dateSlots = _this.generateCustomHours(dateCol, resStartHour, resEndHour, groupOrder);\n                        lastColumnDates = lastColumnDates.concat(dateSlots);\n                    }\n                    var resCssClass = data[i][resource.cssClassField];\n                    var slotData = {\n                        type: 'resourceHeader', className: ['e-resource-cells'],\n                        resourceLevelIndex: index, groupOrder: groupOrder,\n                        resource: resource, resourceData: data[i],\n                        colSpan: _this.parent.activeViewOptions.group.byDate ? 1 : dateCol.length,\n                        renderDates: renderDates, workDays: resWorkDays, cssClass: resCssClass,\n                        child: items\n                    };\n                    resTree.push(slotData);\n                }\n                if (!resTreeGroup[index]) {\n                    resTreeGroup[index] = [];\n                }\n                resTreeGroup[index].push(resTree);\n                return resTree;\n            }\n            return [];\n        };\n        this.resourceTreeLevel = group(resources, 0);\n        return (isTimeLine) ? [] : this.generateHeaderLevels(resTreeGroup, lastColumnDates, innerDates);\n    };\n    ResourceBase.prototype.generateCustomHours = function (renderDates, startHour, endHour, groupOrder) {\n        var dateSlots = extend([], renderDates, null, true);\n        for (var _i = 0, dateSlots_1 = dateSlots; _i < dateSlots_1.length; _i++) {\n            var dateSlot = dateSlots_1[_i];\n            if (startHour) {\n                dateSlot.startHour = this.parent.getStartEndTime(startHour);\n            }\n            if (endHour) {\n                dateSlot.endHour = this.parent.getStartEndTime(endHour);\n            }\n            if (groupOrder) {\n                dateSlot.groupOrder = groupOrder;\n            }\n        }\n        return dateSlots;\n    };\n    ResourceBase.prototype.generateHeaderLevels = function (resTreeGroup, lastColumnDates, headerDates) {\n        var headerLevels = [];\n        for (var i = resTreeGroup.length - 1; i >= 0; i--) {\n            var temp = 0;\n            for (var _i = 0, _a = resTreeGroup[i]; _i < _a.length; _i++) {\n                var currentLevelChilds = _a[_i];\n                for (var _b = 0, currentLevelChilds_1 = currentLevelChilds; _b < currentLevelChilds_1.length; _b++) {\n                    var currentLevelChild = currentLevelChilds_1[_b];\n                    if (resTreeGroup[i + 1]) {\n                        var nextLevelChilds = resTreeGroup[i + 1][temp];\n                        var colSpan = 0;\n                        for (var _c = 0, nextLevelChilds_1 = nextLevelChilds; _c < nextLevelChilds_1.length; _c++) {\n                            var nextLevelChild = nextLevelChilds_1[_c];\n                            if (!this.parent.activeViewOptions.group.byGroupID || (this.parent.activeViewOptions.group.byGroupID &&\n                                nextLevelChild.resourceData[nextLevelChild.resource.groupIDField] ===\n                                    currentLevelChild.resourceData[currentLevelChild.resource.idField])) {\n                                colSpan += nextLevelChild.colSpan;\n                            }\n                        }\n                        currentLevelChild.colSpan = colSpan;\n                    }\n                    currentLevelChild.groupIndex = temp;\n                    temp++;\n                    headerLevels[currentLevelChild.resourceLevelIndex] = headerLevels[currentLevelChild.resourceLevelIndex] || [];\n                    headerLevels[currentLevelChild.resourceLevelIndex].push(currentLevelChild);\n                }\n            }\n        }\n        this.lastResourceLevel = headerLevels.slice(-1)[0] || [];\n        if (!this.parent.activeViewOptions.group.byDate) {\n            var index = 0;\n            for (var _d = 0, _e = this.lastResourceLevel; _d < _e.length; _d++) {\n                var lastLevelResource = _e[_d];\n                for (var i = 0; i < lastLevelResource.colSpan; i++) {\n                    lastColumnDates[index].groupIndex = lastLevelResource.groupIndex;\n                    index++;\n                }\n            }\n            headerLevels.push(lastColumnDates);\n            return headerLevels;\n        }\n        var dateHeaderLevels = [];\n        var levels = extend([], headerLevels, null, true);\n        var dateColSpan = 0;\n        for (var _f = 0, _g = levels[0]; _f < _g.length; _f++) {\n            var firstRowTd = _g[_f];\n            dateColSpan += firstRowTd.colSpan;\n        }\n        var datesColumn = [];\n        for (var _h = 0, headerDates_1 = headerDates; _h < headerDates_1.length; _h++) {\n            var headerDate = headerDates_1[_h];\n            headerDate.colSpan = dateColSpan;\n            datesColumn.push(headerDate);\n            var resGroup = extend([], levels, null, true);\n            for (var k = 0, length_2 = resGroup.length; k < length_2; k++) {\n                if (k === resGroup.length - 1) {\n                    for (var _j = 0, _k = resGroup[k]; _j < _k.length; _j++) {\n                        var resTd = _k[_j];\n                        resTd.date = headerDate.date;\n                        resTd.workDays = headerDate.workDays;\n                        resTd.startHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.startHourField]) ||\n                            headerDate.startHour;\n                        resTd.endHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.endHourField]) ||\n                            headerDate.endHour;\n                    }\n                }\n                if (!dateHeaderLevels[k]) {\n                    dateHeaderLevels[k] = [];\n                }\n                dateHeaderLevels[k] = dateHeaderLevels[k].concat(resGroup[k]);\n            }\n        }\n        dateHeaderLevels.unshift(datesColumn);\n        return dateHeaderLevels;\n    };\n    ResourceBase.prototype.setResourceValues = function (eventObj, isCrud, groupIndex) {\n        var _this = this;\n        var setValues = function (index, field, value) {\n            if (_this.resourceCollection[index].allowMultiple && (!isCrud || isCrud && _this.parent.activeViewOptions.group.allowGroupEdit)) {\n                eventObj[field] = [value];\n            }\n            else {\n                eventObj[field] = value;\n            }\n        };\n        if (groupIndex === void 0) {\n            groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex :\n                this.parent.activeCellsData.groupIndex;\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !isNullOrUndefined(groupIndex)) {\n            var groupOrder = this.lastResourceLevel[groupIndex].groupOrder;\n            for (var index = 0; index < this.resourceCollection.length; index++) {\n                setValues(index, this.resourceCollection[index].field, groupOrder[index]);\n            }\n        }\n        else if (this.parent.resourceCollection.length > 0) {\n            for (var index = 0; index < this.resourceCollection.length; index++) {\n                var data = this.resourceCollection[index].dataSource[0];\n                if (data) {\n                    setValues(index, this.resourceCollection[index].field, data[this.resourceCollection[index].idField]);\n                }\n            }\n        }\n    };\n    ResourceBase.prototype.getResourceColor = function (eventObj, groupOrder) {\n        var colorFieldIndex = (!isNullOrUndefined(groupOrder) &&\n            this.colorIndex > groupOrder.length - 1) ? groupOrder.length - 1 : this.colorIndex;\n        var resource = this.resourceCollection[colorFieldIndex];\n        if (isNullOrUndefined(groupOrder) && this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n            return undefined;\n        }\n        var id = isNullOrUndefined(groupOrder) ? eventObj[resource.field] : groupOrder[colorFieldIndex];\n        var data = this.filterData(resource.dataSource, resource.idField, 'equal', id);\n        if (data.length > 0) {\n            return data[0][resource.colorField];\n        }\n        return undefined;\n    };\n    ResourceBase.prototype.getCssClass = function (eventObj) {\n        var resource = this.resourceCollection.slice(-1)[0];\n        if (this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n            return undefined;\n        }\n        var data = this.filterData(resource.dataSource, resource.idField, 'equal', eventObj[resource.field]);\n        if (data.length > 0) {\n            return data[0][resource.cssClassField];\n        }\n        return undefined;\n    };\n    ResourceBase.prototype.filterData = function (dataSource, field, operator, value) {\n        return new DataManager(dataSource).executeLocal(new Query().where(field, operator, value));\n    };\n    ResourceBase.prototype.dataManagerFailure = function (e) {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.trigger(events.actionFailure, { error: e }, function () { return _this.parent.hideSpinner(); });\n    };\n    ResourceBase.prototype.getResourceData = function (eventObj, index, groupEditIndex) {\n        if (this.parent.activeViewOptions.group.allowGroupEdit) {\n            var resourceObj = {};\n            for (var _i = 0, groupEditIndex_1 = groupEditIndex; _i < groupEditIndex_1.length; _i++) {\n                var groupIndex = groupEditIndex_1[_i];\n                var resourceLevel = this.lastResourceLevel[groupIndex].groupOrder;\n                for (var level = 0, length_3 = resourceLevel.length; level < length_3; level++) {\n                    var fieldName = this.resourceCollection[level].field;\n                    if (isNullOrUndefined(resourceObj[fieldName])) {\n                        resourceObj[fieldName] = [];\n                    }\n                    resourceObj[fieldName].push(resourceLevel[level]);\n                }\n            }\n            eventObj = extend(eventObj, resourceObj);\n        }\n        else {\n            for (var level = 0, length_4 = this.resourceCollection.length; level < length_4; level++) {\n                eventObj[this.resourceCollection[level].field] = this.lastResourceLevel[index].groupOrder[level];\n            }\n        }\n    };\n    ResourceBase.prototype.addResource = function (resources, name, index) {\n        var resourceCollection = (resources instanceof Array) ? resources : [resources];\n        var _loop_1 = function (resource) {\n            if (resource.name === name) {\n                resourceCollection.forEach(function (addObj, i) {\n                    return new DataManager({ json: resource.dataSource }).insert(addObj, null, null, index + i);\n                });\n                return \"break\";\n            }\n        };\n        for (var _i = 0, _a = this.parent.resourceCollection; _i < _a.length; _i++) {\n            var resource = _a[_i];\n            var state_1 = _loop_1(resource);\n            if (state_1 === \"break\")\n                break;\n        }\n        this.refreshLayout(true);\n    };\n    ResourceBase.prototype.removeResource = function (resourceId, name) {\n        var resourceCollection = (resourceId instanceof Array) ? resourceId : [resourceId];\n        var _loop_2 = function (resource) {\n            if (resource.name === name) {\n                resourceCollection.forEach(function (removeObj) {\n                    return new DataManager({ json: resource.dataSource }).remove(resource.idField, removeObj);\n                });\n                return \"break\";\n            }\n        };\n        for (var _i = 0, _a = this.parent.resourceCollection; _i < _a.length; _i++) {\n            var resource = _a[_i];\n            var state_2 = _loop_2(resource);\n            if (state_2 === \"break\")\n                break;\n        }\n        this.refreshLayout(true);\n    };\n    ResourceBase.prototype.getIndexFromResourceId = function (id, name) {\n        var indexs;\n        if (this.parent.resourceCollection[this.parent.resourceCollection.length - 1].name === name) {\n            indexs = id - 1;\n        }\n        else {\n            var counts = 1;\n            for (var i = this.parent.resourceCollection.length - 1; i >= 0; i--) {\n                if (this.parent.resourceCollection[i].name === name) {\n                    indexs = (id - 1) * (counts);\n                    break;\n                }\n                else {\n                    counts = counts * (this.parent.resourceCollection[i].dataSource).length;\n                }\n            }\n        }\n        return indexs;\n    };\n    ResourceBase.prototype.resourceScroll = function (id, name) {\n        if (this.parent.isAdaptive || ['Agenda', 'MonthAgenda'].indexOf(this.parent.currentView) > -1) {\n            return;\n        }\n        var levelName = name || this.parent.resourceCollection.slice(-1)[0].name;\n        var levelIndex = this.parent.resourceCollection.length - 1;\n        var resource = this.parent.resourceCollection.filter(function (e, index) {\n            if (e.name === levelName) {\n                levelIndex = index;\n                return e;\n            }\n            return null;\n        })[0];\n        var scrollElement = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var index = 0;\n        if (this.parent.activeView.isTimelineView()) {\n            if (!this.parent.activeViewOptions.group.byGroupID) {\n                index = this.getIndexFromResourceId(id, levelName);\n            }\n            else {\n                var resourceData = resource.dataSource.filter(function (e) {\n                    return e[resource.idField] === id;\n                })[0];\n                index = this.lastResourceLevel.map(function (e) { return e.resourceData; }).indexOf(resourceData);\n            }\n            if (this.parent.virtualScrollModule) {\n                var virtual = this.parent.element.querySelector('.' + cls.VIRTUAL_TRACK_CLASS);\n                var averageRowHeight = Math.round(virtual.offsetHeight / this.expandedResources.length);\n                if (this.renderedResources[0].resourceData[this.renderedResources[0].resource.idField] > index) {\n                    scrollElement.scrollTop =\n                        (index * averageRowHeight) + ((this.parent.virtualScrollModule.bufferCount - 1) * averageRowHeight);\n                }\n                else {\n                    scrollElement.scrollTop = (index * averageRowHeight);\n                }\n            }\n            else {\n                var td = this.parent.element.querySelector(\".\" + cls.WORK_CELLS_CLASS + \"[data-group-index=\\\"\" + index + \"\\\"]\");\n                if (td && !td.parentElement.classList.contains(cls.HIDDEN_CLASS)) {\n                    scrollElement.scrollTop = td.offsetTop;\n                }\n            }\n        }\n        else {\n            if (!this.parent.activeViewOptions.group.byGroupID) {\n                index = this.getIndexFromResourceId(id, levelName);\n            }\n            else {\n                index = resource.dataSource.map(function (e) { return e[resource.idField]; }).indexOf(id);\n            }\n            var offsetTarget = this.parent.element.querySelector(\".\" + cls.HEADER_ROW_CLASS + \":nth-child(\" + (levelIndex + 1) + \")\");\n            var offset = [].slice.call(offsetTarget.children).map(function (node) { return node.offsetLeft; });\n            scrollElement.scrollLeft = offset[index];\n        }\n    };\n    ResourceBase.prototype.destroy = function () {\n        this.parent.off(events.documentClick, this.documentClick);\n        if (this.treeViewObj) {\n            this.treeViewObj.destroy();\n            this.treeViewObj = null;\n        }\n        if (this.treePopup) {\n            this.treePopup.destroy();\n            this.treePopup = null;\n            remove(this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP));\n            remove(this.parent.element.querySelector('.' + cls.RESOURCE_TREE_POPUP_OVERLAY));\n        }\n        var resToolBarEle = this.parent.element.querySelector('.' + cls.RESOURCE_TOOLBAR_CONTAINER);\n        if (resToolBarEle) {\n            remove(resToolBarEle);\n        }\n    };\n    return ResourceBase;\n}());\nexport { ResourceBase };\n"]},"metadata":{},"sourceType":"module"}